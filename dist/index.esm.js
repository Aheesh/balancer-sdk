import{defaultAbiCoder as e,Interface as t}from"@ethersproject/abi";import{WeiPerEther as n,Zero as a,MaxUint256 as s,AddressZero as i,MaxInt256 as r}from"@ethersproject/constants";import{BigNumber as o,parseFixed as d,formatFixed as p}from"@ethersproject/bignumber";import{getAddress as u}from"@ethersproject/address";import{hexZeroPad as l,hexValue as c,splitSignature as y}from"@ethersproject/bytes";import{Signer as m}from"@ethersproject/abstract-signer";import{Contract as b}from"@ethersproject/contracts";import{mergeWith as h,cloneDeep as f,set as T,parseInt as I,keyBy as g,sum as w,pickBy as E,zipObject as S,identity as _}from"lodash";import*as O from"@balancer-labs/sor";import{StablePool as A,ZERO as x,WeightedMaths as P,WeightedPool as N,MetaStablePool as k,PhantomStablePool as v,LinearPool as B,SwapTypes as R,PoolFilter as D,SOR as C,parseToPoolsDict as M,getSpotPriceAfterSwapForPath as F}from"@balancer-labs/sor";export{PoolFilter,RouteProposer,SOR,SwapTypes,formatSequence,getTokenAddressesForSwap,parseToPoolsDict,phantomStableBPTForTokensZeroPriceImpact,queryBatchSwapTokensIn,queryBatchSwapTokensOut,stableBPTForTokensZeroPriceImpact,weightedBPTForTokensZeroPriceImpact}from"@balancer-labs/sor";import{Vault__factory as U,LidoRelayer__factory as L}from"@balancer-labs/typechain";import{JsonRpcProvider as q}from"@ethersproject/providers";import{GraphQLClient as $}from"graphql-request";import{parse as G}from"graphql";import W from"axios";import{jsonToGraphQLQuery as V}from"json-to-graphql-query";var H,K,j,X,Z;!function(e){e[e.INIT=0]="INIT",e[e.EXACT_TOKENS_IN_FOR_BPT_OUT=1]="EXACT_TOKENS_IN_FOR_BPT_OUT",e[e.TOKEN_IN_FOR_EXACT_BPT_OUT=2]="TOKEN_IN_FOR_EXACT_BPT_OUT"}(H||(H={})),function(e){e[e.INIT=0]="INIT",e[e.COLLECT_PROTOCOL_FEES=1]="COLLECT_PROTOCOL_FEES"}(K||(K={})),function(e){e[e.EXACT_BPT_IN_FOR_ONE_TOKEN_OUT=0]="EXACT_BPT_IN_FOR_ONE_TOKEN_OUT",e[e.EXACT_BPT_IN_FOR_TOKENS_OUT=1]="EXACT_BPT_IN_FOR_TOKENS_OUT",e[e.BPT_IN_FOR_EXACT_TOKENS_OUT=2]="BPT_IN_FOR_EXACT_TOKENS_OUT"}(j||(j={}));class J{constructor(){}}J.joinInit=t=>e.encode(["uint256","uint256[]"],[H.INIT,t]),J.joinCollectProtocolFees=()=>e.encode(["uint256"],[K.COLLECT_PROTOCOL_FEES]),J.joinExactTokensInForBPTOut=(t,n)=>e.encode(["uint256","uint256[]","uint256"],[H.EXACT_TOKENS_IN_FOR_BPT_OUT,t,n]),J.joinTokenInForExactBPTOut=(t,n)=>e.encode(["uint256","uint256","uint256"],[H.TOKEN_IN_FOR_EXACT_BPT_OUT,t,n]),J.exitExactBPTInForOneTokenOut=(t,n)=>e.encode(["uint256","uint256","uint256"],[j.EXACT_BPT_IN_FOR_ONE_TOKEN_OUT,t,n]),J.exitExactBPTInForTokensOut=t=>e.encode(["uint256","uint256"],[j.EXACT_BPT_IN_FOR_TOKENS_OUT,t]),J.exitBPTInForExactTokensOut=(t,n)=>e.encode(["uint256","uint256[]","uint256"],[j.BPT_IN_FOR_EXACT_TOKENS_OUT,t,n]),function(e){e[e.INIT=0]="INIT",e[e.EXACT_TOKENS_IN_FOR_BPT_OUT=1]="EXACT_TOKENS_IN_FOR_BPT_OUT",e[e.TOKEN_IN_FOR_EXACT_BPT_OUT=2]="TOKEN_IN_FOR_EXACT_BPT_OUT",e[e.ALL_TOKENS_IN_FOR_EXACT_BPT_OUT=3]="ALL_TOKENS_IN_FOR_EXACT_BPT_OUT"}(X||(X={})),function(e){e[e.EXACT_BPT_IN_FOR_ONE_TOKEN_OUT=0]="EXACT_BPT_IN_FOR_ONE_TOKEN_OUT",e[e.EXACT_BPT_IN_FOR_TOKENS_OUT=1]="EXACT_BPT_IN_FOR_TOKENS_OUT",e[e.BPT_IN_FOR_EXACT_TOKENS_OUT=2]="BPT_IN_FOR_EXACT_TOKENS_OUT",e[e.MANAGEMENT_FEE_TOKENS_OUT=3]="MANAGEMENT_FEE_TOKENS_OUT"}(Z||(Z={}));class Y{constructor(){}}Y.joinInit=t=>e.encode(["uint256","uint256[]"],[X.INIT,t]),Y.joinExactTokensInForBPTOut=(t,n)=>e.encode(["uint256","uint256[]","uint256"],[X.EXACT_TOKENS_IN_FOR_BPT_OUT,t,n]),Y.joinTokenInForExactBPTOut=(t,n)=>e.encode(["uint256","uint256","uint256"],[X.TOKEN_IN_FOR_EXACT_BPT_OUT,t,n]),Y.joinAllTokensInForExactBPTOut=t=>e.encode(["uint256","uint256"],[X.ALL_TOKENS_IN_FOR_EXACT_BPT_OUT,t]),Y.exitExactBPTInForOneTokenOut=(t,n)=>e.encode(["uint256","uint256","uint256"],[Z.EXACT_BPT_IN_FOR_ONE_TOKEN_OUT,t,n]),Y.exitExactBPTInForTokensOut=t=>e.encode(["uint256","uint256"],[Z.EXACT_BPT_IN_FOR_TOKENS_OUT,t]),Y.exitBPTInForExactTokensOut=(t,n)=>e.encode(["uint256","uint256[]","uint256"],[Z.BPT_IN_FOR_EXACT_TOKENS_OUT,t,n]);class z{constructor(){}}z.exitForManagementFees=()=>e.encode(["uint256"],[Z.MANAGEMENT_FEE_TOKENS_OUT]);function Q(e){if(100==e.length)return Array(100).fill(n.div(100));const t=e.reduce(((e,t)=>e.add(t)),a);if(t.eq(n))return e;const s=[];let i=a;for(let a=0;a<e.length;a++)a<e.length-1?(s[a]=e[a].mul(n).div(t),i=i.add(s[a])):s[a]=n.sub(i);return s}const ee=e=>{const t=e.reduce(((e,t)=>e.add(t)),a);return t.eq(n)};var te,ne;!function(e){e[e.INIT=0]="INIT",e[e.EXACT_TOKENS_IN_FOR_BPT_OUT=1]="EXACT_TOKENS_IN_FOR_BPT_OUT",e[e.TOKEN_IN_FOR_EXACT_BPT_OUT=2]="TOKEN_IN_FOR_EXACT_BPT_OUT"}(te||(te={})),function(e){e[e.EXACT_BPT_IN_FOR_ONE_TOKEN_OUT=0]="EXACT_BPT_IN_FOR_ONE_TOKEN_OUT",e[e.BPT_IN_FOR_EXACT_TOKENS_OUT=1]="BPT_IN_FOR_EXACT_TOKENS_OUT"}(ne||(ne={}));class ae{constructor(){}}ae.joinInit=t=>e.encode(["uint256","uint256[]"],[te.INIT,t]),ae.joinCollectProtocolFees=()=>e.encode(["uint256"],[K.COLLECT_PROTOCOL_FEES]),ae.joinExactTokensInForBPTOut=(t,n)=>e.encode(["uint256","uint256[]","uint256"],[te.EXACT_TOKENS_IN_FOR_BPT_OUT,t,n]),ae.joinTokenInForExactBPTOut=(t,n)=>e.encode(["uint256","uint256","uint256"],[te.TOKEN_IN_FOR_EXACT_BPT_OUT,t,n]),ae.exitExactBPTInForOneTokenOut=(t,n)=>e.encode(["uint256","uint256","uint256"],[ne.EXACT_BPT_IN_FOR_ONE_TOKEN_OUT,t,n]),ae.exitBPTInForExactTokensOut=(t,n)=>e.encode(["uint256","uint256[]","uint256"],[ne.BPT_IN_FOR_EXACT_TOKENS_OUT,t,n]);var se="production"===process.env.NODE_ENV,ie="Invariant failed";function re(e,t){if(!e){if(se)throw new Error(ie);var n="function"==typeof t?t():t;throw new Error(n?ie+": "+n:ie)}}const oe=e=>({address:de(e),specialization:pe(e),nonce:ue(e)}),de=e=>(re(66===e.length,"Invalid poolId length"),e.slice(0,42)),pe=e=>{re(66===e.length,"Invalid poolId length");const t=parseInt(e[45]);return re(t<3,"Invalid pool specialization"),t},ue=e=>(re(66===e.length,"Invalid poolId length"),o.from(`0x${e.slice(46)}`)),le={"000":"ADD_OVERFLOW","001":"SUB_OVERFLOW","002":"SUB_UNDERFLOW","003":"MUL_OVERFLOW","004":"ZERO_DIVISION","005":"DIV_INTERNAL","006":"X_OUT_OF_BOUNDS","007":"Y_OUT_OF_BOUNDS","008":"PRODUCT_OUT_OF_BOUNDS","009":"INVALID_EXPONENT",100:"OUT_OF_BOUNDS",101:"UNSORTED_ARRAY",102:"UNSORTED_TOKENS",103:"INPUT_LENGTH_MISMATCH",104:"ZERO_TOKEN",200:"MIN_TOKENS",201:"MAX_TOKENS",202:"MAX_SWAP_FEE_PERCENTAGE",203:"MIN_SWAP_FEE_PERCENTAGE",204:"MINIMUM_BPT",205:"CALLER_NOT_VAULT",206:"UNINITIALIZED",207:"BPT_IN_MAX_AMOUNT",208:"BPT_OUT_MIN_AMOUNT",209:"EXPIRED_PERMIT",210:"NOT_TWO_TOKENS",211:"DISABLED",300:"MIN_AMP",301:"MAX_AMP",302:"MIN_WEIGHT",303:"MAX_STABLE_TOKENS",304:"MAX_IN_RATIO",305:"MAX_OUT_RATIO",306:"MIN_BPT_IN_FOR_TOKEN_OUT",307:"MAX_OUT_BPT_FOR_TOKEN_IN",308:"NORMALIZED_WEIGHT_INVARIANT",309:"INVALID_TOKEN",310:"UNHANDLED_JOIN_KIND",311:"ZERO_INVARIANT",312:"ORACLE_INVALID_SECONDS_QUERY",313:"ORACLE_NOT_INITIALIZED",314:"ORACLE_QUERY_TOO_OLD",315:"ORACLE_INVALID_INDEX",316:"ORACLE_BAD_SECS",317:"AMP_END_TIME_TOO_CLOSE",318:"AMP_ONGOING_UPDATE",319:"AMP_RATE_TOO_HIGH",320:"AMP_NO_ONGOING_UPDATE",321:"STABLE_INVARIANT_DIDNT_CONVERGE",322:"STABLE_GET_BALANCE_DIDNT_CONVERGE",323:"RELAYER_NOT_CONTRACT",324:"BASE_POOL_RELAYER_NOT_CALLED",325:"REBALANCING_RELAYER_REENTERED",326:"GRADUAL_UPDATE_TIME_TRAVEL",327:"SWAPS_DISABLED",328:"CALLER_IS_NOT_LBP_OWNER",329:"PRICE_RATE_OVERFLOW",330:"INVALID_JOIN_EXIT_KIND_WHILE_SWAPS_DISABLED",331:"WEIGHT_CHANGE_TOO_FAST",332:"LOWER_GREATER_THAN_UPPER_TARGET",333:"UPPER_TARGET_TOO_HIGH",334:"UNHANDLED_BY_LINEAR_POOL",335:"OUT_OF_TARGET_RANGE",336:"UNHANDLED_EXIT_KIND ",337:"UNAUTHORIZED_EXIT",338:"MAX_MANAGEMENT_SWAP_FEE_PERCENTAGE",339:"UNHANDLED_BY_MANAGED_POOL",340:"UNHANDLED_BY_PHANTOM_POOL",341:"TOKEN_DOES_NOT_HAVE_RATE_PROVIDER",342:"INVALID_INITIALIZATION",343:"OUT_OF_NEW_TARGET_RANGE",344:"UNAUTHORIZED_OPERATION",345:"UNINITIALIZED_POOL_CONTROLLER",400:"REENTRANCY",401:"SENDER_NOT_ALLOWED",402:"PAUSED",403:"PAUSE_WINDOW_EXPIRED",404:"MAX_PAUSE_WINDOW_DURATION",405:"MAX_BUFFER_PERIOD_DURATION",406:"INSUFFICIENT_BALANCE",407:"INSUFFICIENT_ALLOWANCE",408:"ERC20_TRANSFER_FROM_ZERO_ADDRESS",409:"ERC20_TRANSFER_TO_ZERO_ADDRESS",410:"ERC20_MINT_TO_ZERO_ADDRESS",411:"ERC20_BURN_FROM_ZERO_ADDRESS",412:"ERC20_APPROVE_FROM_ZERO_ADDRESS",413:"ERC20_APPROVE_TO_ZERO_ADDRESS",414:"ERC20_TRANSFER_EXCEEDS_ALLOWANCE",415:"ERC20_DECREASED_ALLOWANCE_BELOW_ZERO",416:"ERC20_TRANSFER_EXCEEDS_BALANCE",417:"ERC20_BURN_EXCEEDS_ALLOWANCE",418:"SAFE_ERC20_CALL_FAILED",419:"ADDRESS_INSUFFICIENT_BALANCE",420:"ADDRESS_CANNOT_SEND_VALUE",421:"SAFE_CAST_VALUE_CANT_FIT_INT256",422:"GRANT_SENDER_NOT_ADMIN",423:"REVOKE_SENDER_NOT_ADMIN",424:"RENOUNCE_SENDER_NOT_ALLOWED",425:"BUFFER_PERIOD_EXPIRED",426:"CALLER_IS_NOT_OWNER",427:"NEW_OWNER_IS_ZERO",428:"CODE_DEPLOYMENT_FAILED",429:"CALL_TO_NON_CONTRACT",430:"LOW_LEVEL_CALL_FAILED",431:"NOT_PAUSED",432:"ADDRESS_ALREADY_ALLOWLISTED",433:"ADDRESS_NOT_ALLOWLISTED",434:"ERC20_BURN_EXCEEDS_BALANCE",500:"INVALID_POOL_ID",501:"CALLER_NOT_POOL",502:"SENDER_NOT_ASSET_MANAGER",503:"USER_DOESNT_ALLOW_RELAYER",504:"INVALID_SIGNATURE",505:"EXIT_BELOW_MIN",506:"JOIN_ABOVE_MAX",507:"SWAP_LIMIT",508:"SWAP_DEADLINE",509:"CANNOT_SWAP_SAME_TOKEN",510:"UNKNOWN_AMOUNT_IN_FIRST_SWAP",511:"MALCONSTRUCTED_MULTIHOP_SWAP",512:"INTERNAL_BALANCE_OVERFLOW",513:"INSUFFICIENT_INTERNAL_BALANCE",514:"INVALID_ETH_INTERNAL_BALANCE",515:"INVALID_POST_LOAN_BALANCE",516:"INSUFFICIENT_ETH",517:"UNALLOCATED_ETH",518:"ETH_TRANSFER",519:"CANNOT_USE_ETH_SENTINEL",520:"TOKENS_MISMATCH",521:"TOKEN_NOT_REGISTERED",522:"TOKEN_ALREADY_REGISTERED",523:"TOKENS_ALREADY_SET",524:"TOKENS_LENGTH_MUST_BE_2",525:"NONZERO_TOKEN_BALANCE",526:"BALANCE_TOTAL_OVERFLOW",527:"POOL_NO_TOKENS",528:"INSUFFICIENT_FLASH_LOAN_BALANCE",600:"SWAP_FEE_PERCENTAGE_TOO_HIGH",601:"FLASH_LOAN_FEE_PERCENTAGE_TOO_HIGH",602:"INSUFFICIENT_FLASH_LOAN_FEE_AMOUNT"};class ce{constructor(){}}async function ye(e){if("string"==typeof e)return e;if(m.isSigner(e))return e.getAddress();if(e.address)return e.address;throw new Error("Could not read account address")}var me;ce.isErrorCode=e=>{if(!e.includes("BAL#"))return!1;const t=e.replace("BAL#","");return Object.keys(le).includes(t)},ce.parseErrorCode=e=>{if(!e.includes("BAL#"))throw new Error("Error code not found");const t=e.replace("BAL#",""),n=le[t];if(!n)throw new Error("Error code not found");return n},ce.tryParseErrorCode=e=>{try{return ce.parseErrorCode(e)}catch{return e}},ce.isBalancerError=e=>Object.values(le).includes(e),ce.encodeError=e=>{const t=Object.entries(le).find((([,t])=>t===e));if(!t)throw Error("Error message not found");return`BAL#${t[0]}`},function(e){e.JoinPool="JoinPool",e.ExitPool="ExitPool",e.Swap="Swap",e.BatchSwap="BatchSwap",e.SetRelayerApproval="SetRelayerApproval"}(me||(me={}));class be{constructor(){}}be.encodeCalldataAuthorization=(e,t,n)=>{const a=l(c(t),32).slice(2),{v:s,r:i,s:r}=y(n);return`${e}${a}${l(c(s),32).slice(2)}${i.slice(2)}${r.slice(2)}`},be.signJoinAuthorization=(e,t,n,a,s,i)=>be.signAuthorizationFor(me.JoinPool,e,t,n,a,s,i),be.signExitAuthorization=(e,t,n,a,s,i)=>be.signAuthorizationFor(me.ExitPool,e,t,n,a,s,i),be.signSwapAuthorization=(e,t,n,a,s,i)=>be.signAuthorizationFor(me.Swap,e,t,n,a,s,i),be.signBatchSwapAuthorization=(e,t,n,a,s,i)=>be.signAuthorizationFor(me.BatchSwap,e,t,n,a,s,i),be.signSetRelayerApprovalAuthorization=(e,t,n,a,s,i)=>be.signAuthorizationFor(me.SetRelayerApproval,e,t,n,a,s,i),be.signAuthorizationFor=async(e,t,n,a,i,r=s,o)=>{const{chainId:d}=await t.provider.getNetwork();if(!o){const e=await n.getAddress();o=await t.getNextNonce(e)}const p={name:"Balancer V2 Vault",version:"1",chainId:d,verifyingContract:t.address},u={[e]:[{name:"calldata",type:"bytes"},{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"}]},l={calldata:i,sender:await ye(a),nonce:o.toString(),deadline:r.toString()};return n._signTypedData(p,u,l)};class he{constructor(){}}he.signSetMinterApproval=async(e,t,n,a,i=s,r)=>{const{chainId:d}=await e.provider.getNetwork();if(!r){const t=await a.getAddress();r=await e.getNextNonce(t)}const p={name:"Balancer Minter",version:"1",chainId:d,verifyingContract:e.address},u={minter:await ye(t),approval:n,nonce:r.toString(),deadline:i.toString()},l=await a._signTypedData(p,{SetMinterApproval:[{name:"minter",type:"address"},{name:"approval",type:"bool"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"}]},u);return{...y(l),deadline:o.from(i)}};const fe=async(e,t,n,a,i=s,r)=>{const{chainId:d}=await e.provider.getNetwork(),p=await t.getAddress();r||(r=await e.nonces(p));const u={name:await e.name(),version:"1",chainId:d,verifyingContract:e.address},l={owner:p,spender:await ye(n),value:a,nonce:r,deadline:i},c=await t._signTypedData(u,{Permit:[{name:"owner",type:"address"},{name:"spender",type:"address"},{name:"value",type:"uint256"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"}]},l);return{...y(c),deadline:o.from(i),nonce:o.from(r)}},Te=e=>e[0].map(((t,n)=>e.map((e=>e[n]))));class Ie{constructor(e){this.ETH=i,this.isETH=e=>Ie.isEqual(e,this.ETH),this.isWETH=e=>Ie.isEqual(e,this.WETH),this.translateToERC20=e=>this.isETH(e)?this.WETH:e,this.WETH=u(e)}sortTokens(e,...t){t.forEach((t=>re(e.length===t.length,"array length mismatch")));const n=e.map(this.translateToERC20),a=Te([n,...t]).sort((([e],[t])=>((e,t)=>e.toLowerCase()>t.toLowerCase()?1:-1)(e,t))),[s,...i]=Te(a);return[e.includes(this.ETH)?s.map((e=>this.isWETH(e)?this.ETH:e)):s,...i]}}Ie.isEqual=(e,t)=>u(e)===u(t);var ge=[{inputs:[{internalType:"contract IStaticAToken",name:"_waToken",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"getRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"waToken",outputs:[{internalType:"contract IStaticAToken",name:"",type:"address"}],stateMutability:"view",type:"function"}];class we{static async getRate(e,t){const n=new b(e,ge,t);return(await n.getRate()).toString()}}const Ee=e=>({parsedTokens:e.tokens.map((e=>e.address)),parsedDecimals:e.tokens.map((e=>e.decimals?e.decimals.toString():void 0)),parsedBalances:e.tokens.map((e=>d(e.balance,e.decimals).toString())),parsedWeights:e.tokens.map((e=>e.weight?d(e.weight,18).toString():void 0)),parsedPriceRates:e.tokens.map((e=>e.priceRate?d(e.priceRate,18).toString():void 0)),parsedAmp:e.amp?d(e.amp,3).toString():void 0,parsedTotalShares:d(e.totalShares,18).toString(),parsedSwapFee:d(e.swapFee,18).toString()});function Se(e){const t={};return e.forEach((e=>{e.price&&(t[e.address]=e.price)})),t}const _e=(e,t)=>u(e)===u(t);class Oe{format(e){return e}}class Ae{constructor(){this.operatorMap={gt:"_gt",lt:"_lt",eq:"",in:"_in",not_in:"_not_in",contains:"_contains"}}format(e){const t={};return e.where&&Object.entries(e.where).forEach((([e,n])=>{Object.entries(n).forEach((([n,a])=>{t[`${e}${this.operatorMap[n]}`]=a}))})),{...e,where:t}}}class xe{constructor(e){this.args=e}merge(e){const t=h(this.args,e.args,((e,t)=>{if(Array.isArray(e))return e.concat(t)}));return new xe(t)}format(e){return e.format(this.args)}}var Pe,Ne,ke,ve,Be,Re;function De(e,t,s,i,r,d){const p=new Array(r.length).fill(a);return r.forEach(((a,r)=>{if(e.some((e=>_e(a,e)))){const e=o.from(d).add(n);p[r]=s===Re.SwapExactOut?p[r].add(o.from(i[r]).mul(e).div(n)):p[r].add(i[r])}if(t.some((e=>_e(a,e)))){const e=n.sub(o.from(d));p[r]=s===Re.SwapExactIn?p[r].add(o.from(i[r]).mul(e).div(n)):p[r].add(i[r])}})),p}!function(e){e[e.MAINNET=1]="MAINNET",e[e.ROPSTEN=3]="ROPSTEN",e[e.RINKEBY=4]="RINKEBY",e[e.GOERLI=5]="GOERLI",e[e["GÖRLI"]=5]="GÖRLI",e[e.OPTIMISM=10]="OPTIMISM",e[e.KOVAN=42]="KOVAN",e[e.POLYGON=137]="POLYGON",e[e.ARBITRUM=42161]="ARBITRUM"}(Pe||(Pe={})),function(e){e[e.GeneralPool=0]="GeneralPool",e[e.MinimalSwapInfoPool=1]="MinimalSwapInfoPool",e[e.TwoTokenPool=2]="TwoTokenPool"}(Ne||(Ne={})),function(e){e[e.DepositInternal=0]="DepositInternal",e[e.WithdrawInternal=1]="WithdrawInternal",e[e.TransferInternal=2]="TransferInternal",e[e.TransferExternal=3]="TransferExternal"}(ke||(ke={})),function(e){e[e.Withdraw=0]="Withdraw",e[e.Deposit=1]="Deposit",e[e.Update=2]="Update"}(ve||(ve={})),function(e){e.Weighted="Weighted",e.Investment="Investment",e.Stable="Stable",e.ComposableStable="ComposableStable",e.MetaStable="MetaStable",e.StablePhantom="StablePhantom",e.LiquidityBootstrapping="LiquidityBootstrapping",e.AaveLinear="AaveLinear",e.ERC4626Linear="ERC4626Linear",e.Element="Element",e.Gyro2="Gyro2",e.Gyro3="Gyro3"}(Be||(Be={})),function(e){e[e.SwapExactIn=0]="SwapExactIn",e[e.SwapExactOut=1]="SwapExactOut"}(Re||(Re={}));const Ce=o.from("10000"),Me=(e,t)=>e.mul(t).div(Ce),Fe=(e,t)=>{const n=Me(e,t);return e.sub(n)},Ue=(e,t)=>{const n=Me(e,t);return e.add(n)},Le="0xBA12222222228d8Ba445958a75a0704d566BF2C8",qe={[Pe.MAINNET]:{chainId:Pe.MAINNET,addresses:{contracts:{vault:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",multicall:"0xeefba1e63905ef1d7acba5a8513c70307c1ce441",lidoRelayer:"0xdcdbf71A870cc60C6F9B621E28a7D3Ffd6Dd4965",gaugeController:"0xc128468b7ce63ea702c1f104d55a2566b13d3abd",feeDistributor:"0xD3cf852898b21fc233251427c2DC93d3d604F3BB",protocolFeePercentagesProvider:"0x97207B095e4D5C9a6e4cfbfcd2C3358E03B90c4A"},tokens:{wrappedNativeAsset:"0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",lbpRaisingTokens:["0x6B175474E89094C44Da98b954EedeAC495271d0F","0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48","0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"],stETH:"0xae7ab96520de3a18e5e111b5eaab095312d7fe84",wstETH:"0x7f39c581f595b53c5cb19bd0b3f8da6c935e2ca0",bal:"0xba100000625a3754423978a60c9317c58a424e3d",veBal:"0xC128a9954e6c874eA3d62ce62B468bA073093F25",bbaUsd:"0x7b50775383d3d6f0215a8f290f2c9e2eebbeceb2"}},urls:{subgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-v2",gaugesSubgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-gauges",blockNumberSubgraph:"https://api.thegraph.com/subgraphs/name/blocklytics/ethereum-blocks"},pools:{wETHwstETH:{id:"0x32296969ef14eb0c6d29669c550d4a0449130230000200000000000000000080",address:"0x32296969ef14eb0c6d29669c550d4a0449130230"}}},[Pe.POLYGON]:{chainId:Pe.POLYGON,addresses:{contracts:{vault:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",multicall:"0xa1B2b503959aedD81512C37e9dce48164ec6a94d"},tokens:{wrappedNativeAsset:"0x0d500B1d8E8eF31E21C99d1Db9A6444d3ADf1270"}},urls:{subgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-polygon-v2",gaugesSubgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-gauges-polygon",blockNumberSubgraph:"https://api.thegraph.com/subgraphs/name/ianlapham/polygon-blocks"},pools:{}},[Pe.ARBITRUM]:{chainId:Pe.ARBITRUM,addresses:{contracts:{vault:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",multicall:"0x269ff446d9892c9e19082564df3f5e8741e190a1"},tokens:{wrappedNativeAsset:"0x82aF49447D8a07e3bd95BD0d56f35241523fBab1"}},urls:{subgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-arbitrum-v2",gaugesSubgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-gauges-arbitrum",blockNumberSubgraph:"https://api.thegraph.com/subgraphs/name/ianlapham/arbitrum-one-blocks"},pools:{}},[Pe.KOVAN]:{chainId:Pe.KOVAN,addresses:{contracts:{vault:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",multicall:"0x2cc8688C5f75E365aaEEb4ea8D6a480405A48D2A"},tokens:{wrappedNativeAsset:"0xdFCeA9088c8A88A76FF74892C1457C17dfeef9C1"}},urls:{subgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-kovan-v2",gaugesSubgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-gauges"},pools:{}},[Pe.ROPSTEN]:{chainId:Pe.ROPSTEN,addresses:{contracts:{vault:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",multicall:"0x53c43764255c17bd724f74c4ef150724ac50a3ed"},tokens:{wrappedNativeAsset:"0xdFCeA9088c8A88A76FF74892C1457C17dfeef9C1"}},urls:{subgraph:"",gaugesSubgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-gauges"},pools:{}},[Pe.RINKEBY]:{chainId:Pe.RINKEBY,addresses:{contracts:{vault:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",multicall:"0x42ad527de7d4e9d9d011ac45b31d8551f8fe9821"},tokens:{wrappedNativeAsset:"0xdFCeA9088c8A88A76FF74892C1457C17dfeef9C1"}},urls:{subgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-rinkeby-v2",gaugesSubgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-gauges"},pools:{}},[Pe.GOERLI]:{chainId:Pe.GOERLI,addresses:{contracts:{vault:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",multicall:"0x77dCa2C955b15e9dE4dbBCf1246B4B85b651e50e",gaugeController:"0xBB1CE49b16d55A1f2c6e88102f32144C7334B116"},tokens:{wrappedNativeAsset:"0xdFCeA9088c8A88A76FF74892C1457C17dfeef9C1"}},urls:{subgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-goerli-v2",gaugesSubgraph:"https://api.thegraph.com/subgraphs/name/balancer-labs/balancer-gauges",blockNumberSubgraph:"https://api.thegraph.com/subgraphs/name/blocklytics/goerli-blocks"},pools:{}},[Pe.OPTIMISM]:{chainId:Pe.OPTIMISM,addresses:{contracts:{vault:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",multicall:"0x2dc0e2aa608532da689e89e237df582b783e552c"},tokens:{wrappedNativeAsset:"0x4200000000000000000000000000000000000006"}},urls:{subgraph:"https://api.thegraph.com/subgraphs/name/beethovenxfi/beethovenx-optimism",gaugesSubgraph:""},pools:{}}};var $e;!function(e){e.SWAP_ZERO_RETURN_AMOUNT="SWAP_ZERO_RETURN_AMOUNT",e.UNWRAP_ZERO_AMOUNT="UNWRAP_ZERO_AMOUNT",e.WRAP_ZERO_AMOUNT="WRAP_ZERO_AMOUNT",e.QUERY_BATCH_SWAP="QUERY_BATCH_SWAP",e.POOL_DOESNT_EXIST="POOL_DOESNT_EXIST",e.UNSUPPORTED_POOL_TYPE="UNSUPPORTED_POOL_TYPE",e.UNSUPPORTED_PAIR="UNSUPPORTED_PAIR",e.NO_POOL_DATA="NO_POOL_DATA",e.INPUT_OUT_OF_BOUNDS="INPUT_OUT_OF_BOUNDS",e.INPUT_LENGTH_MISMATCH="INPUT_LENGTH_MISMATCH",e.INPUT_ZERO_NOT_ALLOWED="INPUT_ZERO_NOT_ALLOWED",e.TOKEN_MISMATCH="TOKEN_MISMATCH",e.MISSING_TOKENS="MISSING_TOKENS",e.MISSING_AMP="MISSING_AMP",e.MISSING_DECIMALS="MISSING_DECIMALS",e.MISSING_PRICE_RATE="MISSING_PRICE_RATE",e.MISSING_WEIGHT="MISSING_WEIGHT"}($e||($e={}));class Ge extends Error{constructor(e){super(Ge.getMessage(e)),this.code=e,this.name="BalancerError"}static getMessage(e){switch(e){case $e.SWAP_ZERO_RETURN_AMOUNT:return"queryBatchSwapWithSor returned 0 amount";case $e.UNWRAP_ZERO_AMOUNT:return"swapUnwrapAaveStaticExactIn unwrapped amount < 0";case $e.WRAP_ZERO_AMOUNT:return"swapUnwrapAaveStaticExactOut wrapped amount < 0";case $e.QUERY_BATCH_SWAP:return"queryBatchSwap on chain call error";case $e.POOL_DOESNT_EXIST:return"balancer pool does not exist";case $e.UNSUPPORTED_POOL_TYPE:return"unsupported pool type";case $e.UNSUPPORTED_PAIR:return"unsupported token pair";case $e.NO_POOL_DATA:return"no pool data";case $e.INPUT_OUT_OF_BOUNDS:return"input out of bounds";case $e.INPUT_LENGTH_MISMATCH:return"input length mismatch";case $e.TOKEN_MISMATCH:return"token mismatch";case $e.MISSING_DECIMALS:return"missing decimals";case $e.MISSING_TOKENS:return"missing tokens";case $e.MISSING_AMP:return"missing amp";case $e.MISSING_PRICE_RATE:return"missing price rate";case $e.MISSING_WEIGHT:return"missing weight";case $e.INPUT_ZERO_NOT_ALLOWED:return"zero input not allowed";default:return"Unknown error"}}}class We{constructor(){this.buildExitExactBPTIn=({exiter:e,pool:t,bptIn:n,slippage:a,shouldUnwrapNativeAsset:s,wrappedNativeAsset:r,singleTokenMaxOut:p})=>{if(!n.length||d(n,18).isNegative())throw new Ge($e.INPUT_OUT_OF_BOUNDS);if(p&&p!==i&&!t.tokens.map((e=>e.address)).some((e=>e===p)))throw new Ge($e.TOKEN_MISMATCH);if(!s&&p===i)throw new Error("shouldUnwrapNativeAsset and singleTokenMaxOut should not have conflicting values");if(t.tokens.some((e=>!e.decimals)))throw new Ge($e.MISSING_DECIMALS);if(!t.amp)throw new Ge($e.MISSING_AMP);const{parsedTokens:u,parsedBalances:l,parsedAmp:c,parsedTotalShares:y,parsedSwapFee:m}=Ee(t),b=u.map((e=>e===r?i:e)),h=new Ie(r),[f,T]=h.sortTokens(s?b:u,l);let I,g=Array(u.length).fill("0");if(p){const e=u.indexOf(p),t=O.StableMathBigInt._calcTokenOutGivenExactBptIn(BigInt(c),T.map((e=>BigInt(e))),e,BigInt(n),BigInt(y),BigInt(m)).toString();g[e]=Fe(o.from(t),o.from(a)).toString(),I=J.exitExactBPTInForOneTokenOut(n,e)}else{g=O.StableMathBigInt._calcTokensOutGivenExactBptIn(T.map((e=>BigInt(e))),BigInt(n),BigInt(y)).map((e=>e.toString())).map((e=>Fe(o.from(e),o.from(a)).toString())),I=J.exitExactBPTInForTokensOut(n)}const w="exitPool",E={poolId:t.id,sender:e,recipient:e,exitPoolRequest:{assets:f,minAmountsOut:g,userData:I,toInternalBalance:!1}};return{to:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",functionName:w,attributes:E,data:U.createInterface().encodeFunctionData(w,[E.poolId,E.sender,E.recipient,E.exitPoolRequest]),minAmountsOut:g,maxBPTIn:n}},this.buildExitExactTokensOut=({exiter:e,pool:t,tokensOut:n,amountsOut:a,slippage:s,wrappedNativeAsset:i})=>{if(n.length!=a.length||n.length!=t.tokensList.length)throw new Ge($e.INPUT_LENGTH_MISMATCH);if(t.tokens.some((e=>!e.decimals)))throw new Ge($e.MISSING_DECIMALS);if(!t.amp)throw new Ge($e.MISSING_AMP);const{parsedTokens:r,parsedBalances:d,parsedAmp:p,parsedTotalShares:u,parsedSwapFee:l}=Ee(t),c=new Ie(i),[,y]=c.sortTokens(r,d),[m,b]=c.sortTokens(n,a),h=O.StableMathBigInt._calcBptInGivenExactTokensOut(BigInt(p),y.map((e=>BigInt(e))),b.map((e=>BigInt(e))),BigInt(u),BigInt(l)).toString(),f=Ue(o.from(h),o.from(s)).toString(),T=J.exitBPTInForExactTokensOut(b,f),I="exitPool",g={poolId:t.id,sender:e,recipient:e,exitPoolRequest:{assets:m,minAmountsOut:b,userData:T,toInternalBalance:!1}};return{to:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",functionName:I,attributes:g,data:U.createInterface().encodeFunctionData(I,[g.poolId,g.sender,g.recipient,g.exitPoolRequest]),minAmountsOut:b,maxBPTIn:f}}}}class Ve{constructor(){this.buildJoin=({joiner:e,pool:t,tokensIn:n,amountsIn:a,slippage:s,wrappedNativeAsset:r})=>{if(n.length!=a.length||n.length!=t.tokensList.length)throw new Ge($e.INPUT_LENGTH_MISMATCH);if(t.tokens.some((e=>!e.decimals)))throw new Ge($e.MISSING_DECIMALS);if(!t.amp)throw new Ge($e.MISSING_AMP);const{parsedTokens:d,parsedBalances:p,parsedAmp:u,parsedTotalShares:l,parsedSwapFee:c}=Ee(t),y=new Ie(r),[m,b]=y.sortTokens(n,a),[,h]=y.sortTokens(d,p),f=O.StableMathBigInt._calcBptOutGivenExactTokensIn(BigInt(u),h.map((e=>BigInt(e))),b.map((e=>BigInt(e))),BigInt(l),BigInt(c)).toString(),T=Fe(o.from(f),o.from(s)).toString(),I=J.joinExactTokensInForBPTOut(b,T),g="joinPool",w={poolId:t.id,sender:e,recipient:e,joinPoolRequest:{assets:m,maxAmountsIn:b,userData:I,fromInternalBalance:!1}},E=U.createInterface().encodeFunctionData(g,[w.poolId,w.sender,w.recipient,w.joinPoolRequest]),S=a.filter(((e,t)=>n[t]===i));return{to:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",functionName:g,attributes:w,data:E,value:S[0]?o.from(S[0]):void 0,minBPTOut:T}}}}function He(e,t){const n=new RegExp(`[0-9]+\\.?[0-9]{0,${t}}`),a=e.match(n);let s=e;return a&&(s=a[0]),d(s,t)}function Ke(e,t){return p(e,t).replace(/(.0$)/,"")}class je{calcTotal(e){var t,n;let a=o.from(0),s=o.from(0);for(let n=0;n<e.length;n++){const i=e[n];if(!(null===(t=i.price)||void 0===t?void 0:t.usd))continue;const r=He(i.price.usd.toString(),18),o=He(i.balance,18),d=o.mul(r);s=s.add(d),a=a.add(o)}if(a.gt(0)){const t=s.div(a);for(let i=0;i<e.length;i++){const r=e[i];if(null===(n=r.price)||void 0===n?void 0:n.usd)continue;const o=He(r.balance,18),d=o.mul(t);s=s.add(d),a=a.add(o)}}return p(s,36).toString()}}class Xe{calcPoolSpotPrice(e,t,n){const a=A.fromPool(n),s=a.parsePoolPairData(e,t);return a._spotPriceAfterSwapExactTokenInForTokenOut(s,x).toString()}}const Ze=BigInt(0),Je=BigInt(1),Ye=BigInt("1000000000000000000"),ze=(e,t)=>{if(!e)throw new Error(t)};function Qe(e){const t=BigInt(18)-e;return Ye*BigInt(10)**t}function et(e,t){return tt.mulDownFixed(e,t)}class tt{static add(e,t){const n=e+t;return ze(t>=0&&n>=e||t<0&&n<e,"Errors.ADD_OVERFLOW"),n}static sub(e,t){ze(t<=e,"Errors.SUB_OVERFLOW");return e-t}static max(e,t){return e>=t?e:t}static min(e,t){return e<t?e:t}static mul(e,t){const n=e*t;return ze(e==Ze||n/e==t,"Errors.MUL_OVERFLOW"),n}static div(e,t,n){return n?this.divUp(e,t):this.divDown(e,t)}static divDown(e,t){return ze(t!=Ze,"Errors.ZERO_DIVISION"),e/t}static divUp(e,t){return ze(t!=Ze,"Errors.ZERO_DIVISION"),e==Ze?Ze:Je+(e-Je)/t}static mulUpFixed(e,t){const n=e*t;return ze(e==Ze||n/e==t,"Errors.MUL_OVERFLOW"),n==Ze?Ze:(n-Je)/Ye+Je}static divDownFixed(e,t){if(ze(t!=Ze,"Errors.ZERO_DIVISION"),e==Ze)return Ze;return e*Ye/t}static divUpFixed(e,t){if(ze(t!=Ze,"Errors.ZERO_DIVISION"),e==Ze)return Ze;{const n=e*Ye;return ze(n/e==Ye,"Errors.DIV_INTERNAL"),(n-Je)/t+Je}}static powUpFixed(e,t){const n=nt.pow(e,t),a=this.add(this.mulUpFixed(n,this.MAX_POW_RELATIVE_ERROR),Je);return this.add(n,a)}static complementFixed(e){return e<Ye?Ye-e:Ze}static mulDownFixed(e,t){const n=e*t;return ze(e==Ze||n/e==t,"Errors.MUL_OVERFLOW"),n/Ye}}tt.MAX_POW_RELATIVE_ERROR=BigInt(1e4);class nt{static pow(e,t){if(t===Ze)return this.ONE_18;if(e==Ze)return Ze;ze(e<BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819968"),"Errors.X_OUT_OF_BOUNDS");const n=e;ze(t<this.MILD_EXPONENT_BOUND,"Errors.Y_OUT_OF_BOUNDS");const a=t;let s;if(this.LN_36_LOWER_BOUND<n&&n<this.LN_36_UPPER_BOUND){const e=this._ln_36(n);s=e/this.ONE_18*a+e%this.ONE_18*a/this.ONE_18}else s=this._ln(n)*a;return s/=this.ONE_18,ze(this.MIN_NATURAL_EXPONENT<=s&&s<=this.MAX_NATURAL_EXPONENT,"Errors.PRODUCT_OUT_OF_BOUNDS"),this.exp(s)}static exp(e){if(ze(e>=this.MIN_NATURAL_EXPONENT&&e<=this.MAX_NATURAL_EXPONENT,"Errors.INVALID_EXPONENT"),e<0)return this.ONE_18*this.ONE_18/this.exp(BigInt(-1)*e);let t;e>=this.x0?(e-=this.x0,t=this.a0):e>=this.x1?(e-=this.x1,t=this.a1):t=BigInt(1),e*=BigInt(100);let n=this.ONE_20;e>=this.x2&&(e-=this.x2,n=n*this.a2/this.ONE_20),e>=this.x3&&(e-=this.x3,n=n*this.a3/this.ONE_20),e>=this.x4&&(e-=this.x4,n=n*this.a4/this.ONE_20),e>=this.x5&&(e-=this.x5,n=n*this.a5/this.ONE_20),e>=this.x6&&(e-=this.x6,n=n*this.a6/this.ONE_20),e>=this.x7&&(e-=this.x7,n=n*this.a7/this.ONE_20),e>=this.x8&&(e-=this.x8,n=n*this.a8/this.ONE_20),e>=this.x9&&(e-=this.x9,n=n*this.a9/this.ONE_20);let a,s=this.ONE_20;return a=e,s+=a,a=a*e/this.ONE_20/BigInt(2),s+=a,a=a*e/this.ONE_20/BigInt(3),s+=a,a=a*e/this.ONE_20/BigInt(4),s+=a,a=a*e/this.ONE_20/BigInt(5),s+=a,a=a*e/this.ONE_20/BigInt(6),s+=a,a=a*e/this.ONE_20/BigInt(7),s+=a,a=a*e/this.ONE_20/BigInt(8),s+=a,a=a*e/this.ONE_20/BigInt(9),s+=a,a=a*e/this.ONE_20/BigInt(10),s+=a,a=a*e/this.ONE_20/BigInt(11),s+=a,a=a*e/this.ONE_20/BigInt(12),s+=a,n*s/this.ONE_20*t/BigInt(100)}static _ln_36(e){const t=((e*=this.ONE_18)-this.ONE_36)*this.ONE_36/(e+this.ONE_36),n=t*t/this.ONE_36;let a=t,s=a;return a=a*n/this.ONE_36,s+=a/BigInt(3),a=a*n/this.ONE_36,s+=a/BigInt(5),a=a*n/this.ONE_36,s+=a/BigInt(7),a=a*n/this.ONE_36,s+=a/BigInt(9),a=a*n/this.ONE_36,s+=a/BigInt(11),a=a*n/this.ONE_36,s+=a/BigInt(13),a=a*n/this.ONE_36,s+=a/BigInt(15),s*BigInt(2)}static _ln(e){if(e<this.ONE_18)return BigInt(-1)*this._ln(this.ONE_18*this.ONE_18/e);let t=Ze;e>=this.a0*this.ONE_18&&(e/=this.a0,t+=this.x0),e>=this.a1*this.ONE_18&&(e/=this.a1,t+=this.x1),t*=BigInt(100),(e*=BigInt(100))>=this.a2&&(e=e*this.ONE_20/this.a2,t+=this.x2),e>=this.a3&&(e=e*this.ONE_20/this.a3,t+=this.x3),e>=this.a4&&(e=e*this.ONE_20/this.a4,t+=this.x4),e>=this.a5&&(e=e*this.ONE_20/this.a5,t+=this.x5),e>=this.a6&&(e=e*this.ONE_20/this.a6,t+=this.x6),e>=this.a7&&(e=e*this.ONE_20/this.a7,t+=this.x7),e>=this.a8&&(e=e*this.ONE_20/this.a8,t+=this.x8),e>=this.a9&&(e=e*this.ONE_20/this.a9,t+=this.x9),e>=this.a10&&(e=e*this.ONE_20/this.a10,t+=this.x10),e>=this.a11&&(e=e*this.ONE_20/this.a11,t+=this.x11);const n=(e-this.ONE_20)*this.ONE_20/(e+this.ONE_20),a=n*n/this.ONE_20;let s=n,i=s;return s=s*a/this.ONE_20,i+=s/BigInt(3),s=s*a/this.ONE_20,i+=s/BigInt(5),s=s*a/this.ONE_20,i+=s/BigInt(7),s=s*a/this.ONE_20,i+=s/BigInt(9),s=s*a/this.ONE_20,i+=s/BigInt(11),i*=BigInt(2),(t+i)/BigInt(100)}}function at(e,t){return Ye-tt.divDownFixed(e,t)}nt.ONE_18=BigInt("1000000000000000000"),nt.ONE_20=BigInt("100000000000000000000"),nt.ONE_36=BigInt("1000000000000000000000000000000000000"),nt.MAX_NATURAL_EXPONENT=BigInt("130000000000000000000"),nt.MIN_NATURAL_EXPONENT=BigInt("-41000000000000000000"),nt.LN_36_LOWER_BOUND=BigInt(nt.ONE_18)-BigInt("100000000000000000"),nt.LN_36_UPPER_BOUND=BigInt(nt.ONE_18)+BigInt("100000000000000000"),nt.MILD_EXPONENT_BOUND=BigInt(2)**BigInt(254)/nt.ONE_20,nt.x0=BigInt("128000000000000000000"),nt.a0=BigInt("38877084059945950922200000000000000000000000000000000000"),nt.x1=BigInt("64000000000000000000"),nt.a1=BigInt("6235149080811616882910000000"),nt.x2=BigInt("3200000000000000000000"),nt.a2=BigInt("7896296018268069516100000000000000"),nt.x3=BigInt("1600000000000000000000"),nt.a3=BigInt("888611052050787263676000000"),nt.x4=BigInt("800000000000000000000"),nt.a4=BigInt("298095798704172827474000"),nt.x5=BigInt("400000000000000000000"),nt.a5=BigInt("5459815003314423907810"),nt.x6=BigInt("200000000000000000000"),nt.a6=BigInt("738905609893065022723"),nt.x7=BigInt("100000000000000000000"),nt.a7=BigInt("271828182845904523536"),nt.x8=BigInt("50000000000000000000"),nt.a8=BigInt("164872127070012814685"),nt.x9=BigInt("25000000000000000000"),nt.a9=BigInt("128402541668774148407"),nt.x10=BigInt("12500000000000000000"),nt.a10=BigInt("113314845306682631683"),nt.x11=BigInt("6250000000000000000"),nt.a11=BigInt("106449445891785942956");const st=BigInt(1e3);function it(e,t,n,a){const s=t.length,i=function(e,t,n){let a=Ze;const s=t.length;for(let e=0;e<s;e++)a+=t[e];if(a==Ze)return Ze;let i=Ze,r=a;const o=e*BigInt(s);for(let e=0;e<255;e++){let e=t[0]*BigInt(s);for(let a=1;a<s;a++)e=tt.div(tt.mul(tt.mul(e,t[a]),BigInt(s)),r,n);if(i=r,r=tt.div(tt.mul(tt.mul(BigInt(s),r),r)+tt.div(tt.mul(tt.mul(o,a),e),st,n),tt.mul(BigInt(s+1),r)+tt.div(tt.mul(o-st,e),st,!n),n),r>i){if(r-i<=1)return r}else if(i-r<=1)return r}throw new Error("Errors.STABLE_INVARIANT_DIDNT_CONVERGE")}(e,t,!0);let r=Ze,o=i/BigInt(s);for(let e=0;e<s;e++)e!=a&&(r+=t[e],o=o*i/(BigInt(s)*t[e]));const d=t[a],p=e*BigInt(s),u=p*r,l=BigInt(st)-p,c=BigInt(2)*p*d+u+l*i,y=o*BigInt(s+1)*st-l*d;return tt.divUpFixed(c*n/y,i)}class rt{bptZeroPriceImpact(e,t){if(t.length!==e.tokensList.length)throw new Ge($e.INPUT_LENGTH_MISMATCH);const{parsedBalances:n,parsedDecimals:a,parsedAmp:s,parsedTotalShares:i}=Ee(e),r=a.map((e=>{if(!e)throw new Ge($e.MISSING_DECIMALS);return BigInt(e)}));if(!s)throw new Ge($e.MISSING_PRICE_RATE);const o=BigInt(i),d=r.map((e=>Qe(BigInt(e)))),p=n.map(((e,t)=>et(BigInt(e),d[t])));let u=Ze;for(let e=0;e<p.length;e++){const n=it(BigInt(s),p,o,e),a=Qe(BigInt(r[e]));u+=n*et(t[e],a)/Ye}return u}calcPriceImpact(e,t,n){const a=this.bptZeroPriceImpact(e,t.map((e=>BigInt(e))));return at(BigInt(n),a).toString()}}class ot{constructor(e=new We,t=new Ve,n=new je,a=new Xe,s=new rt){this.exit=e,this.join=t,this.liquidity=n,this.spotPriceCalculator=a,this.priceImpactCalculator=s}}class dt{constructor(){this.buildExitSingleTokenOut=({exiter:e,pool:t,bptIn:n,slippage:a,shouldUnwrapNativeAsset:s,wrappedNativeAsset:r,singleTokenMaxOut:p})=>{if(!n.length||d(n,18).isNegative())throw new Ge($e.INPUT_OUT_OF_BOUNDS);if(p&&p!==i&&!t.tokens.map((e=>e.address)).some((e=>e===p)))throw new Ge($e.TOKEN_MISMATCH);if(!s&&p===i)throw new Error("shouldUnwrapNativeAsset and singleTokenMaxOut should not have conflicting values");if(t.tokens.some((e=>!e.decimals)))throw new Ge($e.MISSING_DECIMALS);if(!t.amp)throw new Ge($e.MISSING_AMP);const{parsedTokens:u,parsedBalances:l,parsedAmp:c,parsedTotalShares:y,parsedSwapFee:m}=Ee(t),b=u.map((e=>e===r?i:e)),h=new Ie(r),[f,T]=h.sortTokens(s?b:u,l),I=Array(u.length).fill("0"),g=u.indexOf(p),w=O.StableMathBigInt._calcTokenOutGivenExactBptIn(BigInt(c),T.map((e=>BigInt(e))),g,BigInt(n),BigInt(y),BigInt(m)).toString();I[g]=Fe(o.from(w),o.from(a)).toString();const E=ae.exitExactBPTInForOneTokenOut(n,g),S="exitPool",_={poolId:t.id,sender:e,recipient:e,exitPoolRequest:{assets:f,minAmountsOut:I,userData:E,toInternalBalance:!1}};return{to:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",functionName:S,attributes:_,data:U.createInterface().encodeFunctionData(S,[_.poolId,_.sender,_.recipient,_.exitPoolRequest]),minAmountsOut:I,maxBPTIn:n}},this.buildExitExactTokensOut=({exiter:e,pool:t,tokensOut:n,amountsOut:a,slippage:s,wrappedNativeAsset:i})=>{if(n.length!=a.length||n.length!=t.tokensList.length)throw new Ge($e.INPUT_LENGTH_MISMATCH);if(t.tokens.some((e=>!e.decimals)))throw new Ge($e.MISSING_DECIMALS);if(!t.amp)throw new Ge($e.MISSING_AMP);const{parsedTokens:r,parsedBalances:d,parsedAmp:p,parsedTotalShares:u,parsedSwapFee:l}=Ee(t),c=new Ie(i),[,y]=c.sortTokens(r,d),[m,b]=c.sortTokens(n,a),h=O.StableMathBigInt._calcBptInGivenExactTokensOut(BigInt(p),y.map((e=>BigInt(e))),b.map((e=>BigInt(e))),BigInt(u),BigInt(l)).toString(),f=Ue(o.from(h),o.from(s)).toString(),T=ae.exitBPTInForExactTokensOut(b,f),I="exitPool",g={poolId:t.id,sender:e,recipient:e,exitPoolRequest:{assets:m,minAmountsOut:b,userData:T,toInternalBalance:!1}};return{to:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",functionName:I,attributes:g,data:U.createInterface().encodeFunctionData(I,[g.poolId,g.sender,g.recipient,g.exitPoolRequest]),minAmountsOut:b,maxBPTIn:f}}}}class pt{constructor(e=new dt,t=new Ve,n=new je,a=new Xe,s=new rt){this.exit=e,this.join=t,this.liquidity=n,this.spotPriceCalculator=a,this.priceImpactCalculator=s}}class ut{constructor(){this.buildExitExactBPTIn=({exiter:e,pool:t,bptIn:n,slippage:a,shouldUnwrapNativeAsset:s,wrappedNativeAsset:r,singleTokenMaxOut:p})=>{if(!n.length||d(n,18).isNegative())throw new Ge($e.INPUT_OUT_OF_BOUNDS);if(p&&p!==i&&!t.tokens.map((e=>e.address)).some((e=>e===p)))throw new Ge($e.TOKEN_MISMATCH);if(!s&&p===i)throw new Error("shouldUnwrapNativeAsset and singleTokenMaxOut should not have conflicting values");const{parsedTokens:u,parsedBalances:l,parsedWeights:c,parsedTotalShares:y,parsedSwapFee:m}=Ee(t),b=u.map((e=>e===r?i:e)),h=new Ie(r),[f,T,I]=h.sortTokens(s?b:u,l,c);let g,w=Array(f.length).fill("0");if(p){const e=f.indexOf(p),t=O.WeightedMaths._calcTokenOutGivenExactBptIn(BigInt(T[e]),BigInt(I[e]),BigInt(n),BigInt(y),BigInt(m)).toString();w[e]=Fe(o.from(t),o.from(a)).toString(),g=Y.exitExactBPTInForOneTokenOut(n,e)}else{w=O.WeightedMaths._calcTokensOutGivenExactBptIn(T.map((e=>BigInt(e))),BigInt(n),BigInt(y)).map((e=>e.toString())).map((e=>Fe(o.from(e),o.from(a)).toString())),g=Y.exitExactBPTInForTokensOut(n)}const E="exitPool",S={poolId:t.id,sender:e,recipient:e,exitPoolRequest:{assets:f,minAmountsOut:w,userData:g,toInternalBalance:!1}};return{to:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",functionName:E,attributes:S,data:U.createInterface().encodeFunctionData(E,[S.poolId,S.sender,S.recipient,S.exitPoolRequest]),minAmountsOut:w,maxBPTIn:n}},this.buildExitExactTokensOut=({exiter:e,pool:t,tokensOut:n,amountsOut:a,slippage:s,wrappedNativeAsset:i})=>{if(n.length!=a.length||n.length!=t.tokensList.length)throw new Ge($e.INPUT_LENGTH_MISMATCH);const{parsedTokens:r,parsedBalances:d,parsedWeights:p,parsedTotalShares:u,parsedSwapFee:l}=Ee(t),c=new Ie(i),[,y,m]=c.sortTokens(r,d,p),[b,h]=c.sortTokens(n,a),f=O.WeightedMaths._calcBptInGivenExactTokensOut(y.map((e=>BigInt(e))),m.map((e=>BigInt(e))),h.map((e=>BigInt(e))),BigInt(u),BigInt(l)).toString(),T=Ue(o.from(f),o.from(s)).toString(),I=Y.exitBPTInForExactTokensOut(h,T),g="exitPool",w={poolId:t.id,sender:e,recipient:e,exitPoolRequest:{assets:b,minAmountsOut:h,userData:I,toInternalBalance:!1}};return{to:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",functionName:g,attributes:w,data:U.createInterface().encodeFunctionData(g,[w.poolId,w.sender,w.recipient,w.exitPoolRequest]),minAmountsOut:h,maxBPTIn:T}}}}class lt{constructor(){this.buildJoin=({joiner:e,pool:t,tokensIn:n,amountsIn:a,slippage:s,wrappedNativeAsset:r})=>{if(n.length!=a.length||n.length!=t.tokensList.length)throw new Ge($e.INPUT_LENGTH_MISMATCH);if(t.tokens.some((e=>!e.decimals)))throw new Ge($e.MISSING_DECIMALS);if(t.tokens.some((e=>!e.weight)))throw new Ge($e.MISSING_WEIGHT);const{parsedTokens:d,parsedBalances:p,parsedWeights:u,parsedTotalShares:l,parsedSwapFee:c}=Ee(t),y=new Ie(r),[m,b]=y.sortTokens(n,a),[,h,f]=y.sortTokens(d,p,u),T=P._calcBptOutGivenExactTokensIn(h.map((e=>BigInt(e))),f.map((e=>BigInt(e))),b.map((e=>BigInt(e))),BigInt(l),BigInt(c)).toString(),I=Fe(o.from(T),o.from(s)).toString(),g=Y.joinExactTokensInForBPTOut(b,I),w="joinPool",E={poolId:t.id,sender:e,recipient:e,joinPoolRequest:{assets:m,maxAmountsIn:b,userData:g,fromInternalBalance:!1}},S=U.createInterface().encodeFunctionData(w,[E.poolId,E.sender,E.recipient,E.joinPoolRequest]),_=a.filter(((e,t)=>n[t]===i));return{to:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",functionName:w,attributes:E,data:S,value:_[0]?o.from(_[0]):void 0,minBPTOut:I}}}}class ct{calcTotal(e){var t;let n=o.from(0),a=o.from(0);for(let s=0;s<e.length;s++){const i=e[s];if(!(null===(t=i.price)||void 0===t?void 0:t.usd))continue;const r=He(i.price.usd.toString(),18),o=He(i.balance,18),d=He(i.weight||"0",18),p=o.mul(r);a=a.add(p),n=n.add(d)}const s=e.reduce(((e,t)=>e.add(He(t.weight||"0",18))),o.from(0));if(n.gt(0)){return Ke(a.mul(s).div(n),36)}return"0"}}class yt{calcPoolSpotPrice(e,t,n){const a=N.fromPool(n),s=a.parsePoolPairData(e,t);return a._spotPriceAfterSwapExactTokenInForTokenOut(s,x).toString()}}class mt{bptZeroPriceImpact(e,t){if(t.length!==e.tokensList.length)throw new Ge($e.INPUT_LENGTH_MISMATCH);const{parsedBalances:n,parsedDecimals:a,parsedTotalShares:s,parsedWeights:i}=Ee(e),r=BigInt(s),o=f(e.tokensList);let d=Ze;for(let e=0;e<o.length;e++){const s=a[e];let o,p;if(!s)throw new Ge($e.MISSING_DECIMALS);o=Qe(BigInt(s)),p=et(BigInt(n[e]),o);const u=i[e];let l;if(!u)throw new Ge($e.MISSING_WEIGHT);l=BigInt(u);d+=l*r/p*et(t[e],o)/Ye}return d}calcPriceImpact(e,t,n){const a=this.bptZeroPriceImpact(e,t.map((e=>BigInt(e))));return at(BigInt(n),a).toString()}}class bt{constructor(e=new ut,t=new lt,n=new ct,a=new yt,s=new mt){this.exit=e,this.join=t,this.liquidity=n,this.spotPriceCalculator=a,this.priceImpactCalculator=s}}class ht{constructor(){this.buildExitExactBPTIn=({exiter:e,pool:t,bptIn:n,slippage:a,shouldUnwrapNativeAsset:s,wrappedNativeAsset:r,singleTokenMaxOut:p})=>{if(!n.length||d(n,18).isNegative())throw new Ge($e.INPUT_OUT_OF_BOUNDS);if(p&&p!==i&&!t.tokens.map((e=>e.address)).some((e=>e===p)))throw new Ge($e.TOKEN_MISMATCH);if(!s&&p===i)throw new Error("shouldUnwrapNativeAsset and singleTokenMaxOut should not have conflicting values");if(t.tokens.some((e=>!e.decimals)))throw new Ge($e.MISSING_DECIMALS);if(!t.amp)throw new Ge($e.MISSING_AMP);if(t.tokens.some((e=>!e.priceRate)))throw new Ge($e.MISSING_PRICE_RATE);const{parsedTokens:u,parsedBalances:l,parsedAmp:c,parsedPriceRates:y,parsedTotalShares:m,parsedSwapFee:b}=Ee(t),h=u.map((e=>e===r?i:e)),f=new Ie(r),[T,I,g]=f.sortTokens(s?h:u,l,y),w=I.map(((e,t)=>o.from(e).mul(o.from(g[t])).div(d("1",18)).toString()));let E,S=Array(u.length).fill("0");if(p){const e=T.indexOf(p),t=O.StableMathBigInt._calcTokenOutGivenExactBptIn(BigInt(c),w.map((e=>BigInt(e))),e,BigInt(n),BigInt(m),BigInt(b)).toString(),s=o.from(t).div(o.from(g[e])).mul(d("1",18)).toString();S[e]=Fe(o.from(s),o.from(a)).toString(),E=J.exitExactBPTInForOneTokenOut(n,e)}else{S=O.StableMathBigInt._calcTokensOutGivenExactBptIn(w.map((e=>BigInt(e))),BigInt(n),BigInt(m)).map((e=>e.toString())).map(((e,t)=>o.from(e).div(o.from(g[t])).mul(d("1",18)).toString())).map((e=>Fe(o.from(e),o.from(a)).toString())),E=J.exitExactBPTInForTokensOut(n)}const _="exitPool",A={poolId:t.id,sender:e,recipient:e,exitPoolRequest:{assets:T,minAmountsOut:S,userData:E,toInternalBalance:!1}};return{to:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",functionName:_,attributes:A,data:U.createInterface().encodeFunctionData(_,[A.poolId,A.sender,A.recipient,A.exitPoolRequest]),minAmountsOut:S,maxBPTIn:n}},this.buildExitExactTokensOut=({exiter:e,pool:t,tokensOut:n,amountsOut:a,slippage:s,wrappedNativeAsset:i})=>{if(n.length!=a.length||n.length!=t.tokensList.length)throw new Ge($e.INPUT_LENGTH_MISMATCH);if(t.tokens.some((e=>!e.decimals)))throw new Ge($e.MISSING_DECIMALS);if(!t.amp)throw new Ge($e.MISSING_AMP);if(t.tokens.some((e=>!e.priceRate)))throw new Ge($e.MISSING_PRICE_RATE);const{parsedTokens:r,parsedBalances:p,parsedPriceRates:u,parsedAmp:l,parsedTotalShares:c,parsedSwapFee:y}=Ee(t),m=new Ie(i),[,b,h]=m.sortTokens(r,p,u),[f,T]=m.sortTokens(n,a),I=T.map(((e,t)=>o.from(e).mul(o.from(h[t])).div(d("1",18)).toString())),g=b.map(((e,t)=>o.from(e).mul(o.from(h[t])).div(d("1",18)).toString())),w=O.StableMathBigInt._calcBptInGivenExactTokensOut(BigInt(l),g.map((e=>BigInt(e))),I.map((e=>BigInt(e))),BigInt(c),BigInt(y)).toString(),E=Ue(o.from(w),o.from(s)).toString(),S=J.exitBPTInForExactTokensOut(T,E),_=T.map(((e,t)=>e===I[t]?e:o.from(e).sub(1).toString())),A="exitPool",x={poolId:t.id,sender:e,recipient:e,exitPoolRequest:{assets:f,minAmountsOut:_,userData:S,toInternalBalance:!1}};return{to:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",functionName:A,attributes:x,data:U.createInterface().encodeFunctionData(A,[x.poolId,x.sender,x.recipient,x.exitPoolRequest]),minAmountsOut:_,maxBPTIn:E}}}}class ft{constructor(){this.buildJoin=({joiner:e,pool:t,tokensIn:n,amountsIn:a,slippage:s,wrappedNativeAsset:r})=>{if(n.length!=a.length||n.length!=t.tokensList.length)throw new Ge($e.INPUT_LENGTH_MISMATCH);if(t.tokens.some((e=>!e.decimals)))throw new Ge($e.MISSING_DECIMALS);if(!t.amp)throw new Ge($e.MISSING_AMP);if(t.tokens.some((e=>!e.priceRate)))throw new Ge($e.MISSING_PRICE_RATE);const{parsedTokens:p,parsedBalances:u,parsedPriceRates:l,parsedAmp:c,parsedTotalShares:y,parsedSwapFee:m}=Ee(t),b=new Ie(r),[h,f]=b.sortTokens(n,a),[,T,I]=b.sortTokens(p,u,l),g=f.map(((e,t)=>o.from(e).mul(o.from(I[t])).div(d("1",18)).toString())),w=T.map(((e,t)=>o.from(e).mul(o.from(I[t])).div(d("1",18)).toString())),E=O.StableMathBigInt._calcBptOutGivenExactTokensIn(BigInt(c),w.map((e=>BigInt(e))),g.map((e=>BigInt(e))),BigInt(y),BigInt(m)).toString(),S=Fe(o.from(E),o.from(s)).toString(),_=J.joinExactTokensInForBPTOut(f,S),A="joinPool",x={poolId:t.id,sender:e,recipient:e,joinPoolRequest:{assets:h,maxAmountsIn:f,userData:_,fromInternalBalance:!1}},P=U.createInterface().encodeFunctionData(A,[x.poolId,x.sender,x.recipient,x.joinPoolRequest]),N=a.filter(((e,t)=>n[t]===i));return{to:"0xBA12222222228d8Ba445958a75a0704d566BF2C8",functionName:A,attributes:x,data:P,value:N[0]?o.from(N[0]):void 0,minBPTOut:S}}}}class Tt{calcTotal(e){var t,n;let s=a,i=a;for(let n=0;n<e.length;n++){const a=e[n];if(!(null===(t=a.price)||void 0===t?void 0:t.usd))continue;const r=He(a.price.usd.toString(),18),o=He(a.balance,18),d=o.mul(r);i=i.add(d),s=s.add(o)}if(s.gt(0)){const t=i.div(s);for(let a=0;a<e.length;a++){const r=e[a];if(null===(n=r.price)||void 0===n?void 0:n.usd)continue;const o=He(r.balance,18),d=o.mul(t);i=i.add(d),s=s.add(o)}}return p(i,36).toString()}}class It{calcPoolSpotPrice(e,t,n){const a=k.fromPool(n),s=a.parsePoolPairData(e,t);return a._spotPriceAfterSwapExactTokenInForTokenOut(s,x).toString()}}class gt{bptZeroPriceImpact(e,t){if(t.length!==e.tokensList.length)throw new Ge($e.INPUT_LENGTH_MISMATCH);const{parsedBalances:n,parsedDecimals:a,parsedPriceRates:s,parsedAmp:i,parsedTotalShares:r}=Ee(e),o=BigInt(r),d=a.map((e=>{if(!e)throw new Ge($e.MISSING_DECIMALS);return BigInt(e)})),p=s.map((e=>{if(!e)throw new Ge($e.MISSING_PRICE_RATE);return BigInt(e)}));if(!i)throw new Ge($e.MISSING_PRICE_RATE);const u=d.map((e=>Qe(BigInt(e)))),l=n.map(((e,t)=>et(BigInt(e),u[t]))),c=l.map(((e,t)=>tt.mulDownFixed(e,p[t])));let y=Ze;for(let n=0;n<l.length;n++){const a=it(BigInt(i),c,o,n)*p[n]/Ye,s=Qe(BigInt(e.tokens[n].decimals));y+=a*et(t[n],s)/Ye}return y}calcPriceImpact(e,t,n){const a=this.bptZeroPriceImpact(e,t.map((e=>BigInt(e))));return at(BigInt(n),a).toString()}}class wt{constructor(e=new ht,t=new ft,n=new Tt,a=new It,s=new gt){this.exit=e,this.join=t,this.liquidity=n,this.spotPriceCalculator=a,this.priceImpactCalculator=s}}class Et{constructor(){this.buildExitExactBPTIn=({exiter:e,pool:t,bptIn:n,slippage:a,shouldUnwrapNativeAsset:s,wrappedNativeAsset:i,singleTokenMaxOut:r})=>{throw new Error("To be implemented")},this.buildExitExactTokensOut=({exiter:e,pool:t,tokensOut:n,amountsOut:a,slippage:s,wrappedNativeAsset:i})=>{throw new Error("To be implemented")}}}class St{constructor(){this.buildJoin=({joiner:e,pool:t,tokensIn:n,amountsIn:a,slippage:s,wrappedNativeAsset:i})=>{throw new Error("To be implemented")}}}class _t{calcTotal(e){if(e.length>0)throw new Error("Not Implemented - StablePhantom liquidity should all come from sub-pools.");return"0"}}class Ot{calcPoolSpotPrice(e,t,n){const a=v.fromPool(n),s=a.parsePoolPairData(e,t);return a._spotPriceAfterSwapExactTokenInForTokenOut(s,x).toString()}}class At{bptZeroPriceImpact(e,t){if(t.length!==e.tokensList.length-1)throw new Ge($e.INPUT_LENGTH_MISMATCH);const n=f(e.tokensList),a=n.findIndex((t=>t==e.address)),{parsedBalances:s,parsedDecimals:i,parsedPriceRates:r,parsedAmp:o,parsedTotalShares:d}=Ee(e),p=i.map((e=>{if(!e)throw new Ge($e.MISSING_DECIMALS);return BigInt(e)})),u=r.map((e=>{if(!e)throw new Ge($e.MISSING_PRICE_RATE);return BigInt(e)}));if(!o)throw new Ge($e.MISSING_PRICE_RATE);const l=BigInt(d);n.splice(a,1);const c=p.map((e=>Qe(BigInt(e)))),y=s.map(((e,t)=>et(BigInt(e),c[t])));if(t.length!==n.length)throw new Ge($e.INPUT_LENGTH_MISMATCH);y.splice(a,1);const m=y.map(((e,t)=>tt.mulDownFixed(e,u[t])));let b=Ze;for(let e=0;e<n.length;e++){const n=it(BigInt(o),m,l,e)*u[e]/Ye,a=Qe(BigInt(p[e]));b+=n*et(t[e],a)/Ye}return b}calcPriceImpact(e,t,n){const a=this.bptZeroPriceImpact(e,t.map((e=>BigInt(e))));return at(BigInt(n),a).toString()}}class xt{constructor(e=new Et,t=new St,n=new _t,a=new Ot,s=new At){this.exit=e,this.join=t,this.liquidity=n,this.spotPriceCalculator=a,this.priceImpactCalculator=s}}class Pt{constructor(){this.buildExitExactBPTIn=({exiter:e,pool:t,bptIn:n,slippage:a,shouldUnwrapNativeAsset:s,wrappedNativeAsset:i,singleTokenMaxOut:r})=>{throw new Error("To be implemented")},this.buildExitExactTokensOut=({exiter:e,pool:t,tokensOut:n,amountsOut:a,slippage:s,wrappedNativeAsset:i})=>{throw new Error("To be implemented")}}}class Nt{constructor(){this.buildJoin=({joiner:e,pool:t,tokensIn:n,amountsIn:a,slippage:s,wrappedNativeAsset:i})=>{throw new Error("To be implemented")}}}const kt=He("1",18);class vt{calcTotal(e){var t,n;let s=a,i=a;for(let n=0;n<e.length;n++){const a=e[n];if(!(null===(t=a.price)||void 0===t?void 0:t.usd))continue;const r=He(a.price.usd.toString(),18),o=He(a.balance,18),d=o.mul(r);i=i.add(d),s=s.add(o)}if(s.gt(0)){const t=i.div(s);for(let a=0;a<e.length;a++){const r=e[a];if(null===(n=r.price)||void 0===n?void 0:n.usd)continue;const o=He(r.priceRate||"1",18),d=He(r.balance,18).mul(o).div(kt),p=d.mul(t);i=i.add(p),s=s.add(d)}}return Ke(i,36)}}class Bt{calcPoolSpotPrice(e,t,n){const a=B.fromPool(n),s=a.parsePoolPairData(e,t);return a._spotPriceAfterSwapExactTokenInForTokenOut(s,x).toString()}}class Rt{bptZeroPriceImpact(e,t){throw new Error("Linear Pool bptZeroPriceImpact Not Implented")}calcPriceImpact(e,t,n){throw new Error("Linear Pool Price Impact Not Implented")}}class Dt{constructor(e=new Pt,t=new Nt,n=new vt,a=new Bt,s=new Rt){this.exit=e,this.join=t,this.liquidity=n,this.spotPriceCalculator=a,this.priceImpactCalculator=s}}class Ct{constructor(e,t=new bt,n=new ot,a=new pt,s=new wt,i=new xt,r=new Dt){this.weighted=t,this.stable=n,this.composableStable=a,this.metaStable=s,this.stablePhantom=i,this.linear=r}static from(e){switch(e){case"Weighted":case"Investment":case"LiquidityBootstrapping":return new bt;case"Stable":return new ot;case"ComposableStable":return new pt;case"MetaStable":return new wt;case"StablePhantom":return new xt;case"AaveLinear":case"ERC4626Linear":return new Dt;default:throw new Ge($e.UNSUPPORTED_POOL_TYPE)}}}class Mt{constructor(e,t){this.pools=e,this.tokenPrices=t}async getLiquidity(e){const t=e.tokens.filter((t=>t.address!==e.address)),n=await Promise.all(t.map((async e=>{const t=await this.pools.findBy("address",e.address);if(!t)return;const n=He(await this.getLiquidity(t),18),a=He(t.totalShares,18),s=He(e.balance,18),i=n.mul(s).div(a);return{address:t.address,liquidity:i.toString()}}))),a=n.reduce(((e,t)=>t?e.add(t.liquidity):o.from(0)),o.from(0)),s=t.filter((e=>!n.find((t=>(null==t?void 0:t.address)===e.address)))),i=await Promise.all(s.map((async e=>{const t=await this.tokenPrices.find(e.address);return{address:e.address,decimals:e.decimals,priceRate:e.priceRate,price:t,balance:e.balance,weight:e.weight}}))),r=He(Ct.from(e.poolType).liquidity.calcTotal(i),18);return Ke(a.add(r),18)}}async function Ft(e,t,n,a){const s={sender:i,recipient:i,fromInternalBalance:!1,toInternalBalance:!1};try{return(await e.callStatic.queryBatchSwap(t,n,a,s)).map((e=>e.toString()))}catch(e){throw`queryBatchSwap call error: ${e}`}}async function Ut(e,t,n){n.fetchPools.fetchPools&&await e.fetchPools();const s=[],i=[];for(let t=0;t<n.tokensIn.length;t++){const r=await Lt(n.tokensIn[t],n.tokensOut[t],n.swapType,n.amounts[t].toString(),e);if(!r.returnAmount.gt(a))throw new Ge($e.SWAP_ZERO_RETURN_AMOUNT);s.push(r.swaps),i.push(r.tokenAddresses)}const r=function(e,t){const n=[...new Set(e.flat())];t.forEach(((t,a)=>{t.forEach((t=>{t.assetInIndex=n.indexOf(e[a][t.assetInIndex]),t.assetOutIndex=n.indexOf(e[a][t.assetOutIndex])}))}));return{swaps:t.flat(),assets:n}}(i,s),o=n.swapType===Re.SwapExactIn?n.tokensOut:n.tokensIn,d=Array(o.length).fill("0");let p=Array(r.assets.length).fill("0");try{p=await Ft(t,n.swapType,r.swaps,r.assets),p.length>0&&o.forEach(((e,t)=>{var n;return d[t]=null!==(n=p[r.assets.indexOf(e.toLowerCase())].toString())&&void 0!==n?n:a.toString()}))}catch(e){throw new Ge($e.QUERY_BATCH_SWAP)}return{returnAmounts:d,swaps:r.swaps,assets:r.assets,deltas:p.map((e=>e.toString()))}}async function Lt(e,t,n,a,s){const i=n===Re.SwapExactIn?R.SwapExactIn:R.SwapExactOut;return await s.getSwaps(e.toLowerCase(),t.toLowerCase(),i,a)}var qt=function(){return qt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var s in t=arguments[n])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},qt.apply(this,arguments)},$t=new Map,Gt=new Map,Wt=!0,Vt=!1;function Ht(e){return e.replace(/[\s,]+/g," ").trim()}function Kt(e){var t=new Set,n=[];return e.definitions.forEach((function(e){if("FragmentDefinition"===e.kind){var a=e.name.value,s=Ht((r=e.loc).source.body.substring(r.start,r.end)),i=Gt.get(a);i&&!i.has(s)?Wt&&console.warn("Warning: fragment with name "+a+" already exists.\ngraphql-tag enforces all fragment names across your application to be unique; read more about\nthis in the docs: http://dev.apollodata.com/core/fragments.html#unique-names"):i||Gt.set(a,i=new Set),i.add(s),t.has(s)||(t.add(s),n.push(e))}else n.push(e);var r})),qt(qt({},e),{definitions:n})}function jt(e){var t=Ht(e);if(!$t.has(t)){var n=G(e,{experimentalFragmentVariables:Vt,allowLegacyFragmentVariables:Vt});if(!n||"Document"!==n.kind)throw new Error("Not a valid GraphQL document.");$t.set(t,function(e){var t=new Set(e.definitions);t.forEach((function(e){e.loc&&delete e.loc,Object.keys(e).forEach((function(n){var a=e[n];a&&"object"==typeof a&&t.add(a)}))}));var n=e.loc;return n&&(delete n.startToken,delete n.endToken),e}(Kt(n)))}return $t.get(t)}function Xt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];"string"==typeof e&&(e=[e]);var a=e[0];return t.forEach((function(t,n){t&&"Document"===t.kind?a+=t.loc.source.body:a+=t,a+=e[n+1]})),jt(a)}var Zt,Jt=Xt,Yt=function(){$t.clear(),Gt.clear()},zt=function(){Wt=!1},Qt=function(){Vt=!0},en=function(){Vt=!1};(Zt=Xt||(Xt={})).gql=Jt,Zt.resetCaches=Yt,Zt.disableFragmentWarnings=zt,Zt.enableExperimentalFragmentVariables=Qt,Zt.disableExperimentalFragmentVariables=en,Xt.default=Xt;var tn,nn,an,sn,rn,on,dn,pn,un,ln,cn,yn,mn,bn,hn,fn,Tn,In,gn,wn,En,Sn,_n,On,An,xn=Xt;!function(e){e.EndAmp="endAmp",e.EndTimestamp="endTimestamp",e.Id="id",e.PoolId="poolId",e.ScheduledTimestamp="scheduledTimestamp",e.StartAmp="startAmp",e.StartTimestamp="startTimestamp"}(tn||(tn={})),function(e){e.Id="id",e.PoolCount="poolCount",e.Timestamp="timestamp",e.TotalLiquidity="totalLiquidity",e.TotalSwapCount="totalSwapCount",e.TotalSwapFee="totalSwapFee",e.TotalSwapVolume="totalSwapVolume",e.Vault="vault"}(nn||(nn={})),function(e){e.Id="id",e.PoolCount="poolCount",e.Pools="pools",e.TotalLiquidity="totalLiquidity",e.TotalSwapCount="totalSwapCount",e.TotalSwapFee="totalSwapFee",e.TotalSwapVolume="totalSwapVolume"}(an||(an={})),function(e){e.EndTimestamp="endTimestamp",e.EndWeights="endWeights",e.Id="id",e.PoolId="poolId",e.ScheduledTimestamp="scheduledTimestamp",e.StartTimestamp="startTimestamp",e.StartWeights="startWeights"}(sn||(sn={})),function(e){e.Exit="Exit",e.Join="Join"}(rn||(rn={})),function(e){e.Amounts="amounts",e.Id="id",e.Pool="pool",e.Sender="sender",e.Timestamp="timestamp",e.Tx="tx",e.Type="type",e.User="user"}(on||(on={})),function(e){e.Asset="asset",e.Block="block",e.Id="id",e.PoolId="poolId",e.Price="price",e.PricingAsset="pricingAsset"}(dn||(dn={})),function(e){e.CashDelta="cashDelta",e.Id="id",e.ManagedDelta="managedDelta",e.PoolTokenId="poolTokenId",e.Timestamp="timestamp",e.Type="type"}(pn||(pn={})),function(e){e.Deposit="Deposit",e.Update="Update",e.Withdraw="Withdraw"}(un||(un={})),function(e){e.Asc="asc",e.Desc="desc"}(ln||(ln={})),function(e){e.Block="block",e.Id="id",e.PoolId="poolId",e.PoolLiquidity="poolLiquidity",e.PoolShareValue="poolShareValue",e.PoolTotalShares="poolTotalShares",e.PricingAsset="pricingAsset"}(cn||(cn={})),function(e){e.Balance="balance",e.Id="id",e.PoolId="poolId",e.UserAddress="userAddress"}(yn||(yn={})),function(e){e.Amounts="amounts",e.HoldersCount="holdersCount",e.Id="id",e.Liquidity="liquidity",e.Pool="pool",e.SwapFees="swapFees",e.SwapVolume="swapVolume",e.SwapsCount="swapsCount",e.Timestamp="timestamp",e.TotalShares="totalShares"}(mn||(mn={})),function(e){e.Address="address",e.AssetManager="assetManager",e.Balance="balance",e.CashBalance="cashBalance",e.Decimals="decimals",e.Id="id",e.ManagedBalance="managedBalance",e.Managements="managements",e.Name="name",e.PoolId="poolId",e.PriceRate="priceRate",e.Symbol="symbol",e.Token="token",e.Weight="weight"}(bn||(bn={})),function(e){e.Address="address",e.Amp="amp",e.BaseToken="baseToken",e.CreateTime="createTime",e.ExpiryTime="expiryTime",e.Factory="factory",e.HistoricalValues="historicalValues",e.HoldersCount="holdersCount",e.Id="id",e.LowerTarget="lowerTarget",e.MainIndex="mainIndex",e.ManagementFee="managementFee",e.Name="name",e.OracleEnabled="oracleEnabled",e.Owner="owner",e.PoolType="poolType",e.PriceRateProviders="priceRateProviders",e.PrincipalToken="principalToken",e.Root3Alpha="root3Alpha",e.Shares="shares",e.Snapshots="snapshots",e.SqrtAlpha="sqrtAlpha",e.SqrtBeta="sqrtBeta",e.StrategyType="strategyType",e.SwapEnabled="swapEnabled",e.SwapFee="swapFee",e.Swaps="swaps",e.SwapsCount="swapsCount",e.Symbol="symbol",e.Tokens="tokens",e.TokensList="tokensList",e.TotalLiquidity="totalLiquidity",e.TotalShares="totalShares",e.TotalSwapFee="totalSwapFee",e.TotalSwapVolume="totalSwapVolume",e.TotalWeight="totalWeight",e.Tx="tx",e.UnitSeconds="unitSeconds",e.UpperTarget="upperTarget",e.VaultId="vaultID",e.WeightUpdates="weightUpdates",e.WrappedIndex="wrappedIndex"}(hn||(hn={})),function(e){e.Address="address",e.CacheDuration="cacheDuration",e.CacheExpiry="cacheExpiry",e.Id="id",e.LastCached="lastCached",e.PoolId="poolId",e.Rate="rate",e.Token="token"}(fn||(fn={})),function(e){e.Caller="caller",e.Id="id",e.PoolId="poolId",e.Timestamp="timestamp",e.TokenAmountIn="tokenAmountIn",e.TokenAmountOut="tokenAmountOut",e.TokenIn="tokenIn",e.TokenInSym="tokenInSym",e.TokenOut="tokenOut",e.TokenOutSym="tokenOutSym",e.Tx="tx",e.UserAddress="userAddress",e.ValueUsd="valueUSD"}(Tn||(Tn={})),function(e){e.Amount="amount",e.Asset="asset",e.Block="block",e.Id="id",e.PoolId="poolId",e.Price="price",e.PricingAsset="pricingAsset",e.Timestamp="timestamp"}(In||(In={})),function(e){e.Id="id",e.Timestamp="timestamp",e.Token="token",e.TotalBalanceNotional="totalBalanceNotional",e.TotalBalanceUsd="totalBalanceUSD",e.TotalSwapCount="totalSwapCount",e.TotalVolumeNotional="totalVolumeNotional",e.TotalVolumeUsd="totalVolumeUSD"}(gn||(gn={})),function(e){e.Address="address",e.Decimals="decimals",e.Id="id",e.LatestPrice="latestPrice",e.LatestUsdPrice="latestUSDPrice",e.Name="name",e.Pool="pool",e.Symbol="symbol",e.TotalBalanceNotional="totalBalanceNotional",e.TotalBalanceUsd="totalBalanceUSD",e.TotalSwapCount="totalSwapCount",e.TotalVolumeNotional="totalVolumeNotional",e.TotalVolumeUsd="totalVolumeUSD"}(wn||(wn={})),function(e){e.Id="id",e.Pair="pair",e.Timestamp="timestamp",e.TotalSwapFee="totalSwapFee",e.TotalSwapVolume="totalSwapVolume"}(En||(En={})),function(e){e.Id="id",e.Token0="token0",e.Token1="token1",e.TotalSwapFee="totalSwapFee",e.TotalSwapVolume="totalSwapVolume"}(Sn||(Sn={})),function(e){e.Balance="balance",e.Id="id",e.Token="token",e.UserAddress="userAddress"}(_n||(_n={})),function(e){e.Id="id",e.SharesOwned="sharesOwned",e.Swaps="swaps",e.UserInternalBalances="userInternalBalances"}(On||(On={})),function(e){e.Allow="allow",e.Deny="deny"}(An||(An={}));const Pn=xn`
    fragment SubgraphPoolToken on PoolToken {
  id
  symbol
  name
  decimals
  address
  balance
  managedBalance
  weight
  priceRate
  token {
    pool {
      poolType
    }
  }
}
    `,Nn=xn`
    fragment SubgraphPool on Pool {
  id
  address
  poolType
  factory
  strategyType
  symbol
  name
  swapEnabled
  swapFee
  owner
  totalWeight
  totalSwapVolume
  totalSwapFee
  totalLiquidity
  totalShares
  tokens(first: 100) {
    ...SubgraphPoolToken
  }
  swapsCount
  holdersCount
  tokensList
  amp
  expiryTime
  unitSeconds
  createTime
  principalToken
  baseToken
  wrappedIndex
  mainIndex
  lowerTarget
  upperTarget
  sqrtAlpha
  sqrtBeta
  root3Alpha
}
    ${Pn}`,kn=xn`
    fragment SubgraphPoolWithoutLinear on Pool {
  id
  address
  poolType
  symbol
  name
  swapFee
  totalWeight
  totalSwapVolume
  totalSwapFee
  totalLiquidity
  totalShares
  tokens(first: 1000) {
    ...SubgraphPoolToken
  }
  swapsCount
  holdersCount
  tokensList
  totalWeight
  amp
  expiryTime
  unitSeconds
  principalToken
  baseToken
  swapEnabled
}
    ${Pn}`,vn=xn`
    fragment SubgraphPoolSnapshot on PoolSnapshot {
  id
  pool {
    id
  }
  totalShares
  swapVolume
  swapFees
  timestamp
}
    `,Bn=xn`
    fragment SubgraphJoinExit on JoinExit {
  amounts
  id
  sender
  timestamp
  tx
  type
  user {
    id
  }
  pool {
    id
    tokensList
  }
}
    `,Rn=xn`
    fragment SubgraphBalancer on Balancer {
  id
  totalLiquidity
  totalSwapVolume
  totalSwapFee
  totalSwapCount
  poolCount
}
    `,Dn=xn`
    fragment SubgraphTokenPrice on TokenPrice {
  id
  poolId {
    id
  }
  asset
  amount
  pricingAsset
  price
  block
  timestamp
}
    `,Cn=xn`
    fragment SubgraphTokenLatestPrice on LatestPrice {
  id
  asset
  price
  poolId {
    id
  }
  pricingAsset
}
    `,Mn=xn`
    fragment SubgraphUser on User {
  id
  sharesOwned(first: 1000) {
    balance
    poolId {
      id
    }
  }
}
    `,Fn=xn`
    query Pools($skip: Int, $first: Int, $orderBy: Pool_orderBy, $orderDirection: OrderDirection, $where: Pool_filter, $block: Block_height) {
  pools(
    skip: $skip
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphPool
  }
}
    ${Nn}`,Un=xn`
    query AllPools($skip: Int, $first: Int, $orderBy: Pool_orderBy, $orderDirection: OrderDirection, $where: Pool_filter, $block: Block_height) {
  pool0: pools(
    first: 1000
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphPool
  }
  pool1000: pools(
    first: 1000
    skip: 1000
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphPool
  }
  pool2000: pools(
    first: 1000
    skip: 2000
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphPool
  }
}
    ${Nn}`,Ln=xn`
    query Pool($id: ID!, $block: Block_height) {
  pool(id: $id, block: $block) {
    ...SubgraphPool
  }
}
    ${Nn}`,qn=xn`
    query PoolsWithoutLinear($skip: Int, $first: Int, $orderBy: Pool_orderBy, $orderDirection: OrderDirection, $where: Pool_filter, $block: Block_height) {
  pools(
    skip: $skip
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphPoolWithoutLinear
  }
}
    ${kn}`,$n=xn`
    query PoolWithoutLinear($id: ID!, $block: Block_height) {
  pool(id: $id, block: $block) {
    ...SubgraphPoolWithoutLinear
  }
}
    ${kn}`,Gn=xn`
    query PoolHistoricalLiquidities($skip: Int, $first: Int, $orderBy: PoolHistoricalLiquidity_orderBy, $orderDirection: OrderDirection, $where: PoolHistoricalLiquidity_filter, $block: Block_height) {
  poolHistoricalLiquidities(
    skip: $skip
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    id
    poolId {
      id
    }
    poolTotalShares
    poolLiquidity
    poolShareValue
    pricingAsset
    block
  }
}
    `,Wn=xn`
    query PoolSnapshots($skip: Int, $first: Int, $orderBy: PoolSnapshot_orderBy, $orderDirection: OrderDirection, $where: PoolSnapshot_filter, $block: Block_height) {
  poolSnapshots(
    skip: $skip
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphPoolSnapshot
  }
}
    ${vn}`,Vn=xn`
    query JoinExits($skip: Int, $first: Int, $orderBy: JoinExit_orderBy, $orderDirection: OrderDirection, $where: JoinExit_filter, $block: Block_height) {
  joinExits(
    skip: $skip
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphJoinExit
  }
}
    ${Bn}`,Hn=xn`
    query Balancers($skip: Int, $first: Int, $orderBy: Balancer_orderBy, $orderDirection: OrderDirection, $where: Balancer_filter, $block: Block_height) {
  balancers(
    skip: $skip
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphBalancer
  }
}
    ${Rn}`,Kn=xn`
    query TokenPrices($skip: Int, $first: Int, $orderBy: TokenPrice_orderBy, $orderDirection: OrderDirection, $where: TokenPrice_filter, $block: Block_height) {
  tokenPrices(
    skip: $skip
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphTokenPrice
  }
}
    ${Dn}`,jn=xn`
    query TokenLatestPrices($skip: Int, $first: Int, $orderBy: LatestPrice_orderBy, $orderDirection: OrderDirection, $where: LatestPrice_filter, $block: Block_height) {
  latestPrices(
    skip: $skip
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphTokenLatestPrice
  }
}
    ${Cn}`,Xn=xn`
    query TokenLatestPrice($id: ID!) {
  latestPrice(id: $id) {
    ...SubgraphTokenLatestPrice
  }
}
    ${Cn}`,Zn=xn`
    query User($id: ID!, $block: Block_height) {
  user(id: $id, block: $block) {
    ...SubgraphUser
  }
}
    ${Mn}`,Jn=xn`
    query Users($skip: Int, $first: Int, $orderBy: User_orderBy, $orderDirection: OrderDirection, $where: User_filter, $block: Block_height) {
  users(
    skip: $skip
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphUser
  }
}
    ${Mn}`,Yn=(e,t,n)=>e();function zn(e,t=Yn){return{Pools:(n,a)=>t((t=>e.request(Fn,n,{...a,...t})),"Pools","query"),AllPools:(n,a)=>t((t=>e.request(Un,n,{...a,...t})),"AllPools","query"),Pool:(n,a)=>t((t=>e.request(Ln,n,{...a,...t})),"Pool","query"),PoolsWithoutLinear:(n,a)=>t((t=>e.request(qn,n,{...a,...t})),"PoolsWithoutLinear","query"),PoolWithoutLinear:(n,a)=>t((t=>e.request($n,n,{...a,...t})),"PoolWithoutLinear","query"),PoolHistoricalLiquidities:(n,a)=>t((t=>e.request(Gn,n,{...a,...t})),"PoolHistoricalLiquidities","query"),PoolSnapshots:(n,a)=>t((t=>e.request(Wn,n,{...a,...t})),"PoolSnapshots","query"),JoinExits:(n,a)=>t((t=>e.request(Vn,n,{...a,...t})),"JoinExits","query"),Balancers:(n,a)=>t((t=>e.request(Hn,n,{...a,...t})),"Balancers","query"),TokenPrices:(n,a)=>t((t=>e.request(Kn,n,{...a,...t})),"TokenPrices","query"),TokenLatestPrices:(n,a)=>t((t=>e.request(jn,n,{...a,...t})),"TokenLatestPrices","query"),TokenLatestPrice:(n,a)=>t((t=>e.request(Xn,n,{...a,...t})),"TokenLatestPrice","query"),User:(n,a)=>t((t=>e.request(Zn,n,{...a,...t})),"User","query"),Users:(n,a)=>t((t=>e.request(Jn,n,{...a,...t})),"Users","query")}}var Qn,ea,ta,na,aa,sa,ia,ra,oa,da,pa,ua,la,ca,ya;!function(e){e.Arbitrum="Arbitrum",e.Optimism="Optimism",e.Polygon="Polygon"}(Qn||(Qn={})),function(e){e.Gauges="gauges",e.Id="id",e.NumGauges="numGauges"}(ea||(ea={})),function(e){e.Balance="balance",e.Gauge="gauge",e.Id="id",e.User="user"}(ta||(ta={})),function(e){e.Id="id",e.Name="name"}(na||(na={})),function(e){e.Gauge="gauge",e.Id="id",e.Timestamp="timestamp",e.User="user",e.Weight="weight"}(aa||(aa={})),function(e){e.AddedTimestamp="addedTimestamp",e.Address="address",e.Id="id",e.LiquidityGauge="liquidityGauge",e.RootGauge="rootGauge",e.Type="type"}(sa||(sa={})),function(e){e.Factory="factory",e.Gauge="gauge",e.Id="id",e.IsKilled="isKilled",e.IsPreferentialGauge="isPreferentialGauge",e.Pool="pool",e.PoolAddress="poolAddress",e.PoolId="poolId",e.RelativeWeightCap="relativeWeightCap",e.Shares="shares",e.Streamer="streamer",e.Symbol="symbol",e.Tokens="tokens",e.TotalSupply="totalSupply"}(ia||(ia={})),function(e){e.Asc="asc",e.Desc="desc"}(ra||(ra={})),function(e){e.Address="address",e.Gauges="gauges",e.GaugesList="gaugesList",e.Id="id",e.PoolId="poolId",e.PreferentialGauge="preferentialGauge"}(oa||(oa={})),function(e){e.Decimals="decimals",e.Gauge="gauge",e.Id="id",e.Symbol="symbol",e.TotalDeposited="totalDeposited"}(da||(da={})),function(e){e.Chain="chain",e.Factory="factory",e.Gauge="gauge",e.Id="id",e.IsKilled="isKilled",e.Recipient="recipient",e.RelativeWeightCap="relativeWeightCap"}(pa||(pa={})),function(e){e.GaugeShares="gaugeShares",e.GaugeVotes="gaugeVotes",e.Id="id",e.VotingLocks="votingLocks"}(ua||(ua={})),function(e){e.Id="id",e.LockedBalance="lockedBalance",e.UnlockTime="unlockTime",e.UpdatedAt="updatedAt",e.User="user",e.VotingEscrowId="votingEscrowID"}(la||(la={})),function(e){e.Id="id",e.Locks="locks",e.StakedSupply="stakedSupply"}(ca||(ca={})),function(e){e.Allow="allow",e.Deny="deny"}(ya||(ya={}));const ma=xn`
    fragment SubgraphLiquidityGauge on LiquidityGauge {
  id
  symbol
  poolAddress
  poolId
  streamer
  factory {
    id
    numGauges
  }
  totalSupply
  tokens {
    id
    symbol
    decimals
    totalDeposited
  }
}
    `,ba=xn`
    fragment SubgraphPoolWithPreferentialGauge on Pool {
  id
  poolId
  preferentialGauge {
    ...SubgraphLiquidityGauge
  }
}
    ${ma}`,ha=xn`
    query LiquidityGauges($skip: Int, $first: Int, $orderBy: LiquidityGauge_orderBy, $orderDirection: OrderDirection, $where: LiquidityGauge_filter, $block: Block_height) {
  liquidityGauges(
    skip: $skip
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphLiquidityGauge
  }
}
    ${ma}`,fa=xn`
    query Pools($skip: Int, $first: Int, $orderBy: Pool_orderBy, $orderDirection: OrderDirection, $where: Pool_filter, $block: Block_height) {
  pools(
    skip: $skip
    first: $first
    orderBy: $orderBy
    orderDirection: $orderDirection
    where: $where
    block: $block
  ) {
    ...SubgraphPoolWithPreferentialGauge
  }
}
    ${ba}`,Ta=(e,t,n)=>e();function Ia(e){return zn(new $(e))}function ga(e){return function(e,t=Ta){return{LiquidityGauges:(n,a)=>t((t=>e.request(ha,n,{...a,...t})),"LiquidityGauges","query"),Pools:(n,a)=>t((t=>e.request(fa,n,{...a,...t})),"Pools","query")}}(new $(e))}const wa=["function aggregate(tuple[](address target, bytes callData) memory calls) public view returns (uint256 blockNumber, bytes[] memory returnData)"],Ea=(e,t)=>new b(e,wa,t);class Sa{constructor(e,n,a,s={}){this.options={},this.calls=[],this.paths=[],this.multiAddress=e,this.provider=n,this.interface=new t(a),this.options=s}call(e,t,n,a){return this.calls.push([t,n,a]),this.paths.push(e),this}async execute(e={}){const t=e;return(await this.executeMulticall()).forEach(((e,n)=>T(t,this.paths[n],e.length>1?e:e[0]))),this.calls=[],this.paths=[],t}async executeMulticall(){const e=Ea(this.multiAddress,this.provider),[,t]=await e.aggregate(this.calls.map((([e,t,n])=>[e,this.interface.encodeFunctionData(t,n)])),this.options);return t.map(((e,t)=>this.interface.decodeFunctionResult(this.calls[t][1],e)))}}var _a=[{inputs:[{internalType:"contract IVault",name:"vault",type:"address"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"symbol",type:"string"},{internalType:"contract IERC20[]",name:"tokens",type:"address[]"},{internalType:"uint256[]",name:"normalizedWeights",type:"uint256[]"},{internalType:"uint256",name:"swapFeePercentage",type:"uint256"},{internalType:"uint256",name:"pauseWindowDuration",type:"uint256"},{internalType:"uint256",name:"bufferPeriodDuration",type:"uint256"},{internalType:"address",name:"owner",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bool",name:"paused",type:"bool"}],name:"PausedStateChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"swapFeePercentage",type:"uint256"}],name:"SwapFeePercentageChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"decreaseApproval",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"getActionId",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAuthorizer",outputs:[{internalType:"contract IAuthorizer",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getInvariant",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getLastInvariant",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getNormalizedWeights",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPausedState",outputs:[{internalType:"bool",name:"paused",type:"bool"},{internalType:"uint256",name:"pauseWindowEndTime",type:"uint256"},{internalType:"uint256",name:"bufferPeriodEndTime",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolId",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getSwapFeePercentage",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getVault",outputs:[{internalType:"contract IVault",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"increaseApproval",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"onExitPool",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"onJoinPool",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"enum IVault.SwapKind",name:"kind",type:"uint8"},{internalType:"contract IERC20",name:"tokenIn",type:"address"},{internalType:"contract IERC20",name:"tokenOut",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"bytes",name:"userData",type:"bytes"}],internalType:"struct IPoolSwapStructs.SwapRequest",name:"request",type:"tuple"},{internalType:"uint256",name:"balanceTokenIn",type:"uint256"},{internalType:"uint256",name:"balanceTokenOut",type:"uint256"}],name:"onSwap",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"queryExit",outputs:[{internalType:"uint256",name:"bptIn",type:"uint256"},{internalType:"uint256[]",name:"amountsOut",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"queryJoin",outputs:[{internalType:"uint256",name:"bptOut",type:"uint256"},{internalType:"uint256[]",name:"amountsIn",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bool",name:"paused",type:"bool"}],name:"setPaused",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"swapFeePercentage",type:"uint256"}],name:"setSwapFeePercentage",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}],Oa=[{inputs:[{internalType:"contract IVault",name:"vault",type:"address"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"symbol",type:"string"},{internalType:"contract IERC20[]",name:"tokens",type:"address[]"},{internalType:"uint256",name:"amplificationParameter",type:"uint256"},{internalType:"uint256",name:"swapFeePercentage",type:"uint256"},{internalType:"uint256",name:"pauseWindowDuration",type:"uint256"},{internalType:"uint256",name:"bufferPeriodDuration",type:"uint256"},{internalType:"address",name:"owner",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"startValue",type:"uint256"},{indexed:!1,internalType:"uint256",name:"endValue",type:"uint256"},{indexed:!1,internalType:"uint256",name:"startTime",type:"uint256"},{indexed:!1,internalType:"uint256",name:"endTime",type:"uint256"}],name:"AmpUpdateStarted",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"currentValue",type:"uint256"}],name:"AmpUpdateStopped",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bool",name:"paused",type:"bool"}],name:"PausedStateChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"swapFeePercentage",type:"uint256"}],name:"SwapFeePercentageChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"getActionId",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAmplificationParameter",outputs:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bool",name:"isUpdating",type:"bool"},{internalType:"uint256",name:"precision",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAuthorizer",outputs:[{internalType:"contract IAuthorizer",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPausedState",outputs:[{internalType:"bool",name:"paused",type:"bool"},{internalType:"uint256",name:"pauseWindowEndTime",type:"uint256"},{internalType:"uint256",name:"bufferPeriodEndTime",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolId",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getSwapFeePercentage",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getVault",outputs:[{internalType:"contract IVault",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"onExitPool",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"onJoinPool",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"enum IVault.SwapKind",name:"kind",type:"uint8"},{internalType:"contract IERC20",name:"tokenIn",type:"address"},{internalType:"contract IERC20",name:"tokenOut",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"bytes",name:"userData",type:"bytes"}],internalType:"struct IPoolSwapStructs.SwapRequest",name:"swapRequest",type:"tuple"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"indexIn",type:"uint256"},{internalType:"uint256",name:"indexOut",type:"uint256"}],name:"onSwap",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"enum IVault.SwapKind",name:"kind",type:"uint8"},{internalType:"contract IERC20",name:"tokenIn",type:"address"},{internalType:"contract IERC20",name:"tokenOut",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"bytes",name:"userData",type:"bytes"}],internalType:"struct IPoolSwapStructs.SwapRequest",name:"request",type:"tuple"},{internalType:"uint256",name:"balanceTokenIn",type:"uint256"},{internalType:"uint256",name:"balanceTokenOut",type:"uint256"}],name:"onSwap",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"queryExit",outputs:[{internalType:"uint256",name:"bptIn",type:"uint256"},{internalType:"uint256[]",name:"amountsOut",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"queryJoin",outputs:[{internalType:"uint256",name:"bptOut",type:"uint256"},{internalType:"uint256[]",name:"amountsIn",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"bytes",name:"poolConfig",type:"bytes"}],name:"setAssetManagerPoolConfig",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"paused",type:"bool"}],name:"setPaused",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"swapFeePercentage",type:"uint256"}],name:"setSwapFeePercentage",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"rawEndValue",type:"uint256"},{internalType:"uint256",name:"endTime",type:"uint256"}],name:"startAmplificationParameterUpdate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"stopAmplificationParameterUpdate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}],Aa=[{inputs:[{internalType:"contract IERC20",name:"_underlying",type:"address"},{internalType:"contract IERC20",name:"_bond",type:"address"},{internalType:"uint256",name:"_expiration",type:"uint256"},{internalType:"uint256",name:"_unitSeconds",type:"uint256"},{internalType:"contract IVault",name:"vault",type:"address"},{internalType:"uint256",name:"_percentFee",type:"uint256"},{internalType:"uint256",name:"_percentFeeGov",type:"uint256"},{internalType:"address",name:"_governance",type:"address"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"symbol",type:"string"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"collectedBase",type:"uint256"},{indexed:!1,internalType:"uint256",name:"collectedBond",type:"uint256"},{indexed:!1,internalType:"uint256",name:"remainingBase",type:"uint256"},{indexed:!1,internalType:"uint256",name:"remainingBond",type:"uint256"}],name:"FeeCollection",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"FEE_BOUND",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"bond",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"bondDecimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"decreaseApproval",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"expiration",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"feesBond",outputs:[{internalType:"uint128",name:"",type:"uint128"}],stateMutability:"view",type:"function"},{inputs:[],name:"feesUnderlying",outputs:[{internalType:"uint128",name:"",type:"uint128"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolId",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"getVault",outputs:[{internalType:"contract IVault",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"governance",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"increaseApproval",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"currentBalances",type:"uint256[]"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"protocolSwapFee",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"onExitPool",outputs:[{internalType:"uint256[]",name:"amountsOut",type:"uint256[]"},{internalType:"uint256[]",name:"dueProtocolFeeAmounts",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"currentBalances",type:"uint256[]"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"protocolSwapFee",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"onJoinPool",outputs:[{internalType:"uint256[]",name:"amountsIn",type:"uint256[]"},{internalType:"uint256[]",name:"dueProtocolFeeAmounts",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"enum IVault.SwapKind",name:"kind",type:"uint8"},{internalType:"contract IERC20",name:"tokenIn",type:"address"},{internalType:"contract IERC20",name:"tokenOut",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"bytes",name:"userData",type:"bytes"}],internalType:"struct IPoolSwapStructs.SwapRequest",name:"swapRequest",type:"tuple"},{internalType:"uint256",name:"currentBalanceTokenIn",type:"uint256"},{internalType:"uint256",name:"currentBalanceTokenOut",type:"uint256"}],name:"onSwap",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"percentFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"percentFeeGov",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"amountX",type:"uint256"},{internalType:"uint256",name:"reserveX",type:"uint256"},{internalType:"uint256",name:"reserveY",type:"uint256"},{internalType:"bool",name:"out",type:"bool"}],name:"solveTradeInvariant",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"underlying",outputs:[{internalType:"contract IERC20",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"underlyingDecimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"unitSeconds",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],xa=[{inputs:[{internalType:"contract IVault",name:"vault",type:"address"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"symbol",type:"string"},{internalType:"contract IERC20",name:"mainToken",type:"address"},{internalType:"contract IERC20",name:"wrappedToken",type:"address"},{internalType:"uint256",name:"upperTarget",type:"uint256"},{internalType:"uint256",name:"swapFeePercentage",type:"uint256"},{internalType:"uint256",name:"pauseWindowDuration",type:"uint256"},{internalType:"uint256",name:"bufferPeriodDuration",type:"uint256"},{internalType:"address",name:"owner",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bool",name:"paused",type:"bool"}],name:"PausedStateChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"swapFeePercentage",type:"uint256"}],name:"SwapFeePercentageChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"contract IERC20",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"lowerTarget",type:"uint256"},{indexed:!1,internalType:"uint256",name:"upperTarget",type:"uint256"}],name:"TargetsSet",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"getActionId",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAuthorizer",outputs:[{internalType:"contract IAuthorizer",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getBptIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMainIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMainToken",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPausedState",outputs:[{internalType:"bool",name:"paused",type:"bool"},{internalType:"uint256",name:"pauseWindowEndTime",type:"uint256"},{internalType:"uint256",name:"bufferPeriodEndTime",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolId",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getScalingFactors",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getSwapFeePercentage",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTargets",outputs:[{internalType:"uint256",name:"lowerTarget",type:"uint256"},{internalType:"uint256",name:"upperTarget",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getVault",outputs:[{internalType:"contract IVault",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getVirtualSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWrappedIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWrappedToken",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getWrappedTokenRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"onExitPool",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"onJoinPool",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"enum IVault.SwapKind",name:"kind",type:"uint8"},{internalType:"contract IERC20",name:"tokenIn",type:"address"},{internalType:"contract IERC20",name:"tokenOut",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"bytes",name:"userData",type:"bytes"}],internalType:"struct IPoolSwapStructs.SwapRequest",name:"request",type:"tuple"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"indexIn",type:"uint256"},{internalType:"uint256",name:"indexOut",type:"uint256"}],name:"onSwap",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"queryExit",outputs:[{internalType:"uint256",name:"bptIn",type:"uint256"},{internalType:"uint256[]",name:"amountsOut",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"queryJoin",outputs:[{internalType:"uint256",name:"bptOut",type:"uint256"},{internalType:"uint256[]",name:"amountsIn",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"bytes",name:"poolConfig",type:"bytes"}],name:"setAssetManagerPoolConfig",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"paused",type:"bool"}],name:"setPaused",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"swapFeePercentage",type:"uint256"}],name:"setSwapFeePercentage",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"newLowerTarget",type:"uint256"},{internalType:"uint256",name:"newUpperTarget",type:"uint256"}],name:"setTargets",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}],Pa=[{inputs:[{components:[{internalType:"contract IVault",name:"vault",type:"address"},{internalType:"contract IProtocolFeePercentagesProvider",name:"protocolFeeProvider",type:"address"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"symbol",type:"string"},{internalType:"contract IERC20[]",name:"tokens",type:"address[]"},{internalType:"contract IRateProvider[]",name:"rateProviders",type:"address[]"},{internalType:"uint256[]",name:"tokenRateCacheDurations",type:"uint256[]"},{internalType:"bool[]",name:"exemptFromYieldProtocolFeeFlags",type:"bool[]"},{internalType:"uint256",name:"amplificationParameter",type:"uint256"},{internalType:"uint256",name:"swapFeePercentage",type:"uint256"},{internalType:"uint256",name:"pauseWindowDuration",type:"uint256"},{internalType:"uint256",name:"bufferPeriodDuration",type:"uint256"},{internalType:"address",name:"owner",type:"address"}],internalType:"struct ComposableStablePool.NewPoolParams",name:"params",type:"tuple"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"startValue",type:"uint256"},{indexed:!1,internalType:"uint256",name:"endValue",type:"uint256"},{indexed:!1,internalType:"uint256",name:"startTime",type:"uint256"},{indexed:!1,internalType:"uint256",name:"endTime",type:"uint256"}],name:"AmpUpdateStarted",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"currentValue",type:"uint256"}],name:"AmpUpdateStopped",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bool",name:"paused",type:"bool"}],name:"PausedStateChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"feeType",type:"uint256"},{indexed:!1,internalType:"uint256",name:"protocolFeePercentage",type:"uint256"}],name:"ProtocolFeePercentageCacheUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bool",name:"enabled",type:"bool"}],name:"RecoveryModeStateChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"swapFeePercentage",type:"uint256"}],name:"SwapFeePercentageChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenIndex",type:"uint256"},{indexed:!1,internalType:"uint256",name:"rate",type:"uint256"}],name:"TokenRateCacheUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint256",name:"tokenIndex",type:"uint256"},{indexed:!0,internalType:"contract IRateProvider",name:"provider",type:"address"},{indexed:!1,internalType:"uint256",name:"cacheDuration",type:"uint256"}],name:"TokenRateProviderSet",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"DELEGATE_PROTOCOL_SWAP_FEES_SENTINEL",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"disableRecoveryMode",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"enableRecoveryMode",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"getActionId",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"getActualSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAmplificationParameter",outputs:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bool",name:"isUpdating",type:"bool"},{internalType:"uint256",name:"precision",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getAuthorizer",outputs:[{internalType:"contract IAuthorizer",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getBptIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getDomainSeparator",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"getLastJoinExitData",outputs:[{internalType:"uint256",name:"lastJoinExitAmplification",type:"uint256"},{internalType:"uint256",name:"lastPostJoinExitInvariant",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getMinimumBpt",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"getNextNonce",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPausedState",outputs:[{internalType:"bool",name:"paused",type:"bool"},{internalType:"uint256",name:"pauseWindowEndTime",type:"uint256"},{internalType:"uint256",name:"bufferPeriodEndTime",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getPoolId",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"feeType",type:"uint256"}],name:"getProtocolFeePercentageCache",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getProtocolFeesCollector",outputs:[{internalType:"contract IProtocolFeesCollector",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getProtocolSwapFeeDelegation",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getRateProviders",outputs:[{internalType:"contract IRateProvider[]",name:"",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getScalingFactors",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getSwapFeePercentage",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"}],name:"getTokenRate",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"}],name:"getTokenRateCache",outputs:[{internalType:"uint256",name:"rate",type:"uint256"},{internalType:"uint256",name:"oldRate",type:"uint256"},{internalType:"uint256",name:"duration",type:"uint256"},{internalType:"uint256",name:"expires",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getVault",outputs:[{internalType:"contract IVault",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"inRecoveryMode",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"}],name:"isTokenExemptFromYieldProtocolFee",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"onExitPool",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"onJoinPool",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"enum IVault.SwapKind",name:"kind",type:"uint8"},{internalType:"contract IERC20",name:"tokenIn",type:"address"},{internalType:"contract IERC20",name:"tokenOut",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"bytes",name:"userData",type:"bytes"}],internalType:"struct IPoolSwapStructs.SwapRequest",name:"swapRequest",type:"tuple"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"indexIn",type:"uint256"},{internalType:"uint256",name:"indexOut",type:"uint256"}],name:"onSwap",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"pause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"queryExit",outputs:[{internalType:"uint256",name:"bptIn",type:"uint256"},{internalType:"uint256[]",name:"amountsOut",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256[]",name:"balances",type:"uint256[]"},{internalType:"uint256",name:"lastChangeBlock",type:"uint256"},{internalType:"uint256",name:"protocolSwapFeePercentage",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],name:"queryJoin",outputs:[{internalType:"uint256",name:"bptOut",type:"uint256"},{internalType:"uint256[]",name:"amountsIn",type:"uint256[]"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"bytes",name:"poolConfig",type:"bytes"}],name:"setAssetManagerPoolConfig",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"swapFeePercentage",type:"uint256"}],name:"setSwapFeePercentage",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"duration",type:"uint256"}],name:"setTokenRateCacheDuration",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"rawEndValue",type:"uint256"},{internalType:"uint256",name:"endTime",type:"uint256"}],name:"startAmplificationParameterUpdate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"stopAmplificationParameterUpdate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unpause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"updateProtocolFeePercentageCache",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"}],name:"updateTokenRateCache",outputs:[],stateMutability:"nonpayable",type:"function"}];const Na=[Pe.MAINNET,Pe.POLYGON,Pe.ROPSTEN,Pe.RINKEBY,Pe.GOERLI,Pe.KOVAN];class ka{constructor(e,t,n,a){this.client=e,this.provider=t,this.network=n,this.sorConfig=a}async getPools(){const e=function(e){return e.map((e=>({...e,poolType:e.poolType||"",tokens:(e.tokens||[]).map((e=>({...e,weight:e.weight||null}))),totalWeight:e.totalWeight||void 0,amp:e.amp||void 0,expiryTime:e.expiryTime?I(e.expiryTime):void 0,unitSeconds:e.unitSeconds?I(e.unitSeconds):void 0,principalToken:e.principalToken||void 0,baseToken:e.baseToken||void 0})))}(this.supportsLinearPools?await this.getLinearPools():await this.getNonLinearPools());return!1===this.sorConfig.fetchOnChainBalances?e:async function(e,t,n,a){if(0===e.length)return e;const s=Object.values(Object.fromEntries([...U.abi,...ge,..._a,...Oa,...Aa,...xa,...Pa].map((e=>[e.name,e])))),i=new Sa(t,a,s),r=Object.values(D),o=[];e.forEach((e=>{r.includes(e.poolType)?(o.push(e),i.call(`${e.id}.poolTokens`,n,"getPoolTokens",[e.id]),i.call(`${e.id}.totalSupply`,e.address,"totalSupply"),(e.poolType.includes("Linear")||"StablePhantom"===e.poolType)&&i.call(`${e.id}.virtualSupply`,e.address,"getVirtualSupply"),"ComposableStable"===e.poolType&&i.call(`${e.id}.actualSupply`,e.address,"getActualSupply"),"Weighted"===e.poolType||"LiquidityBootstrapping"===e.poolType||"Investment"===e.poolType?(i.call(`${e.id}.weights`,e.address,"getNormalizedWeights"),i.call(`${e.id}.swapFee`,e.address,"getSwapFeePercentage")):"Stable"===e.poolType||"MetaStable"===e.poolType||"StablePhantom"===e.poolType||"ComposableStable"===e.poolType?(i.call(`${e.id}.amp`,e.address,"getAmplificationParameter"),i.call(`${e.id}.swapFee`,e.address,"getSwapFeePercentage")):"Element"===e.poolType?i.call(`${e.id}.swapFee`,e.address,"percentFee"):e.poolType.toString().includes("Linear")?(i.call(`${e.id}.swapFee`,e.address,"getSwapFeePercentage"),i.call(`${e.id}.targets`,e.address,"getTargets"),i.call(`${e.id}.rate`,e.address,"getWrappedTokenRate")):e.poolType.toString().includes("Gyro")&&i.call(`${e.id}.swapFee`,e.address,"getSwapFeePercentage")):console.error(`Unknown pool type: ${e.poolType} ${e.id}`)}));let d={};try{d=await i.execute()}catch(e){throw"Issue with multicall execution."}const u=[];return Object.entries(d).forEach((([e,t],n)=>{try{const{poolTokens:a,swapFee:s,weights:i,totalSupply:r,virtualSupply:d,actualSupply:l}=t;if("Stable"===o[n].poolType||"MetaStable"===o[n].poolType||"StablePhantom"===o[n].poolType||"ComposableStable"===o[n].poolType){if(!t.amp)return void console.error(`Stable Pool Missing Amp: ${e}`);o[n].amp=p(t.amp[0],3)}if(o[n].poolType.includes("Linear")){if(!t.targets)return void console.error(`Linear Pool Missing Targets: ${e}`);o[n].lowerTarget=p(t.targets[0],18),o[n].upperTarget=p(t.targets[1],18);const a=o[n].wrappedIndex;if(void 0===a||void 0===t.rate)return void console.error(`Linear Pool Missing WrappedIndex or PriceRate: ${e}`);o[n].tokens[a].priceRate=p(t.rate,18)}if(o[n].swapFee=p(s,18),a.tokens.forEach(((t,s)=>{const r=o[n].tokens.find((e=>_e(e.address,t)));if(!r)throw`Pool Missing Expected Token: ${e} ${t}`;r.balance=p(a.balances[s],r.decimals),i&&(r.weight=p(i[s],18))})),o[n].poolType.includes("Linear")||"StablePhantom"===o[n].poolType){if(void 0===d)return void console.error(`Pool with pre-minted BPT missing Virtual Supply: ${e}`);o[n].totalShares=p(d,18)}else if("ComposableStable"===o[n].poolType){if(void 0===l)return void console.error(`ComposableStable missing Actual Supply: ${e}`);o[n].totalShares=p(l,18)}else o[n].totalShares=p(r,18);u.push(o[n])}catch(e){throw`Issue with pool onchain data: ${e}`}})),u}(e,this.network.addresses.contracts.multicall,this.network.addresses.contracts.vault,this.provider)}get supportsLinearPools(){return Na.includes(this.network.chainId)}async getLinearPools(){const{pool0:e,pool1000:t,pool2000:n}=await this.client.AllPools({where:{swapEnabled:!0,totalShares_gt:"0"},orderBy:hn.TotalLiquidity,orderDirection:ln.Desc});return[...e,...t,...n]}async getNonLinearPools(){const{pools:e}=await this.client.PoolsWithoutLinear({where:{swapEnabled:!0,totalShares_gt:"0"},orderBy:hn.TotalLiquidity,orderDirection:ln.Desc,first:1e3});return e}}class va{constructor(e){this.chainId=e}async getNativeAssetPriceInToken(e){const t=await this.getTokenPriceInNativeAsset(e);return""+1/parseFloat(t)}async getTokenPriceInNativeAsset(e){const t=`https://api.coingecko.com/api/v3/simple/token_price/${this.platformId}?contract_addresses=${e}&vs_currencies=${this.nativeAssetId}`,{data:n}=await W.get(t,{headers:{Accept:"application/json","Content-Type":"application/json"}});if(void 0===n[e.toLowerCase()][this.nativeAssetId])throw Error("No price returned from Coingecko");return n[e.toLowerCase()][this.nativeAssetId]}get platformId(){switch(this.chainId){case 1:case 42:return"ethereum";case 137:return"polygon-pos";case 42161:return"arbitrum-one"}return"2"}get nativeAssetId(){switch(this.chainId){case 1:case 42:case 42161:return"eth";case 137:return""}return""}}class Ba{constructor(e,t){this.client=e,this.weth=t.toLowerCase()}async getNativeAssetPriceInToken(e){const t=await this.getLatestPriceInEthFromSubgraph(e);if(!t)throw Error("No price found in the subgraph");return""+1/t}async getLatestPriceInEthFromSubgraph(e){e=e.toLowerCase();const{latestPrices:t}=await this.client.TokenLatestPrices({where:{asset_in:[e,this.weth]}}),n=g(t,"id");if(n[`${e}-${this.weth}`])return parseFloat(n[`${e}-${this.weth}`].price);const a=t.filter((t=>t.asset===e));for(const e of a){const t=n[`${e.pricingAsset}-${this.weth}`];if(t)return parseFloat(e.price)*parseFloat(t.price)}return null}}function Ra(e){var t,n;if("number"==typeof e.network){const n=qe[e.network];return{...n,urls:{...n.urls,subgraph:null!==(t=e.customSubgraphUrl)&&void 0!==t?t:n.urls.subgraph}}}return{...e.network,urls:{...e.network.urls,subgraph:null!==(n=e.customSubgraphUrl)&&void 0!==n?n:e.network.urls.subgraph}}}class Da extends C{constructor(e){const t=Ra(e),n=Da.getSorConfig(e),a=Da.getSorNetworkConfig(t),s=new q(e.rpcUrl,e.network),i=Ia(t.urls.subgraph);super(s,a,Da.getPoolDataService(t,n,s,i),Da.getTokenPriceService(t,n,i))}static getSorConfig(e){return{tokenPriceService:"coingecko",poolDataService:"subgraph",fetchOnChainBalances:!0,...e.sor}}static getSorNetworkConfig(e){var t;return{...e,vault:e.addresses.contracts.vault,weth:e.addresses.tokens.wrappedNativeAsset,lbpRaisingTokens:null===(t=e.addresses.tokens)||void 0===t?void 0:t.lbpRaisingTokens,wETHwstETH:e.pools.wETHwstETH}}static getPoolDataService(e,t,n,a){return"object"==typeof t.poolDataService?t.poolDataService:new ka(a,n,e,t)}static getTokenPriceService(e,t,n){return"object"==typeof t.tokenPriceService?t.tokenPriceService:("subgraph"===t.tokenPriceService&&new Ba(n,e.addresses.tokens.wrappedNativeAsset),new va(e.chainId))}}function Ca(e){if(e.poolIds.length>2)throw new Error("Simple flash swap only supports a maximum of two pools");if(e.assets.length>2)throw new Error("Simple flash swap only supports a maximum of to two assets (tokens)")}function Ma(e,t){return[{poolId:e[0],assetInIndex:0,assetOutIndex:1,amount:t,userData:"0x"},{poolId:e[1],assetInIndex:1,assetOutIndex:0,amount:"0",userData:"0x"}]}function Fa(e){return-1*Number(e)}function Ua(e){return w(e)}var La=[{inputs:[{internalType:"contract IVault",name:"vault",type:"address"},{internalType:"contract IERC20",name:"wstETH",type:"address"},{internalType:"contract IBalancerMinter",name:"minter",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approveVault",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"enum IVault.SwapKind",name:"kind",type:"uint8"},{components:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"uint256",name:"assetInIndex",type:"uint256"},{internalType:"uint256",name:"assetOutIndex",type:"uint256"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],internalType:"struct IVault.BatchSwapStep[]",name:"swaps",type:"tuple[]"},{internalType:"contract IAsset[]",name:"assets",type:"address[]"},{components:[{internalType:"address",name:"sender",type:"address"},{internalType:"bool",name:"fromInternalBalance",type:"bool"},{internalType:"address payable",name:"recipient",type:"address"},{internalType:"bool",name:"toInternalBalance",type:"bool"}],internalType:"struct IVault.FundManagement",name:"funds",type:"tuple"},{internalType:"int256[]",name:"limits",type:"int256[]"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint256",name:"value",type:"uint256"},{components:[{internalType:"uint256",name:"index",type:"uint256"},{internalType:"uint256",name:"key",type:"uint256"}],internalType:"struct VaultActions.OutputReference[]",name:"outputReferences",type:"tuple[]"}],name:"batchSwap",outputs:[{internalType:"int256[]",name:"",type:"int256[]"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"enum VaultActions.PoolKind",name:"kind",type:"uint8"},{internalType:"address",name:"sender",type:"address"},{internalType:"address payable",name:"recipient",type:"address"},{components:[{internalType:"contract IAsset[]",name:"assets",type:"address[]"},{internalType:"uint256[]",name:"minAmountsOut",type:"uint256[]"},{internalType:"bytes",name:"userData",type:"bytes"},{internalType:"bool",name:"toInternalBalance",type:"bool"}],internalType:"struct IVault.ExitPoolRequest",name:"request",type:"tuple"},{components:[{internalType:"uint256",name:"index",type:"uint256"},{internalType:"uint256",name:"key",type:"uint256"}],internalType:"struct VaultActions.OutputReference[]",name:"outputReferences",type:"tuple[]"}],name:"exitPool",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IStakingLiquidityGauge[]",name:"gauges",type:"address[]"}],name:"gaugeClaimRewards",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IStakingLiquidityGauge",name:"gauge",type:"address"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"gaugeDeposit",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address[]",name:"gauges",type:"address[]"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"gaugeMint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bool",name:"approval",type:"bool"},{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"gaugeSetMinterApproval",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IStakingLiquidityGauge",name:"gauge",type:"address"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"gaugeWithdraw",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"getEntrypoint",outputs:[{internalType:"contract IBalancerRelayer",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getVault",outputs:[{internalType:"contract IVault",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"enum VaultActions.PoolKind",name:"kind",type:"uint8"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{components:[{internalType:"contract IAsset[]",name:"assets",type:"address[]"},{internalType:"uint256[]",name:"maxAmountsIn",type:"uint256[]"},{internalType:"bytes",name:"userData",type:"bytes"},{internalType:"bool",name:"fromInternalBalance",type:"bool"}],internalType:"struct IVault.JoinPoolRequest",name:"request",type:"tuple"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"joinPool",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"enum IVault.UserBalanceOpKind",name:"kind",type:"uint8"},{internalType:"contract IAsset",name:"asset",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"sender",type:"address"},{internalType:"address payable",name:"recipient",type:"address"}],internalType:"struct IVault.UserBalanceOp[]",name:"ops",type:"tuple[]"},{internalType:"uint256",name:"value",type:"uint256"}],name:"manageUserBalance",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"relayer",type:"address"},{internalType:"bool",name:"approved",type:"bool"},{internalType:"bytes",name:"authorisation",type:"bytes"}],name:"setRelayerApproval",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"stakeETH",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"stakeETHAndWrap",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"poolId",type:"bytes32"},{internalType:"enum IVault.SwapKind",name:"kind",type:"uint8"},{internalType:"contract IAsset",name:"assetIn",type:"address"},{internalType:"contract IAsset",name:"assetOut",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes",name:"userData",type:"bytes"}],internalType:"struct IVault.SingleSwap",name:"singleSwap",type:"tuple"},{components:[{internalType:"address",name:"sender",type:"address"},{internalType:"bool",name:"fromInternalBalance",type:"bool"},{internalType:"address payable",name:"recipient",type:"address"},{internalType:"bool",name:"toInternalBalance",type:"bool"}],internalType:"struct IVault.FundManagement",name:"funds",type:"tuple"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"swap",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IStaticATokenLM",name:"staticToken",type:"address"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bool",name:"toUnderlying",type:"bool"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"unwrapAaveStaticToken",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IERC4626",name:"wrappedToken",type:"address"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"unwrapERC4626",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IUnbuttonToken",name:"wrapperToken",type:"address"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"unwrapUnbuttonToken",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"unwrapWstETH",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IERC20Permit",name:"token",type:"address"},{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"vaultPermit",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IERC20PermitDAI",name:"token",type:"address"},{internalType:"address",name:"holder",type:"address"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"expiry",type:"uint256"},{internalType:"bool",name:"allowed",type:"bool"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"vaultPermitDAI",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IStaticATokenLM",name:"staticToken",type:"address"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bool",name:"fromUnderlying",type:"bool"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"wrapAaveDynamicToken",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IERC4626",name:"wrappedToken",type:"address"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"wrapERC4626",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"wrapStETH",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IUnbuttonToken",name:"wrapperToken",type:"address"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"uAmount",type:"uint256"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"wrapUnbuttonToken",outputs:[],stateMutability:"payable",type:"function"}];const qa={"0xae7ab96520de3a18e5e111b5eaab095312d7fe84":"0x7f39c581f595b53c5cb19bd0b3f8da6c935e2ca0","0xd46ba6d942050d489dbd938a2c909a5d5039a161":"0xedb171c18ce90b633db442f2a6f72874093b49ef","0x1e6bb68acec8fefbd87d192be09bb274170a0548":"0xF03387d8d0FF326ab586A58E0ab4121d106147DF"};function $a(e){let t=e;return qa.hasOwnProperty(e)&&(t=qa[e]),t}var Ga;function Wa(e,t,n){const{tokens:a,contracts:s}=(e=>qe[e].addresses)(n);let i={id:Ga.vault,address:s.vault};return a.stETH&&s.lidoRelayer&&[e,t].includes(a.stETH)&&(i={id:Ga.lido,address:s.lidoRelayer}),i}function Va(e){let t=U.abi;e.id===Ga.lido&&(t=La);return t.filter((e=>e.name&&["swap","batchSwap"].includes(e.name)))}function Ha(e){return{amount:e,max:t=>e.mul(1e3+t).div(1e3),min:t=>e.mul(1e3-t).div(1e3)}}function Ka(e,t){const n=t===Re.SwapExactIn?e.swapAmount:e.returnAmount,a=t===Re.SwapExactIn?e.returnAmount:e.swapAmount,s=t===Re.SwapExactIn?e.swapAmountForSwaps||e.swapAmount:e.returnAmountFromSwaps||e.returnAmount,i=t===Re.SwapExactIn?e.returnAmountFromSwaps||e.returnAmount:e.swapAmountForSwaps||e.swapAmount,r=$a(e.tokenIn),o=$a(e.tokenOut);return{...e,amountIn:n,amountOut:a,amountInForLimits:Ha(s),amountOutForLimits:Ha(i),tokenInForSwaps:r,tokenOutFromSwaps:o}}!function(e){e[e.vault=1]="vault",e[e.lido=2]="lido"}(Ga||(Ga={}));class ja{constructor(e,t,n){this.kind=t,this.chainId=n,this.functionName="swap",this.swapInfo=Ka(e,t),this.relayer=Wa(this.swapInfo.tokenIn,this.swapInfo.tokenOut,this.chainId)}setFunds(e,t){this.funds={sender:e,recipient:t||e,fromInternalBalance:!1,toInternalBalance:!1}}setDeadline(e){this.deadline=e.toString()}get amount(){return this.kind===Re.SwapExactOut?this.swapInfo.amountOutForLimits.amount:this.swapInfo.amountInForLimits.amount}setLimits(e){this.limit=this.kind===Re.SwapExactIn?this.swapInfo.amountOutForLimits.min(e).toString():this.swapInfo.amountInForLimits.max(e).toString()}get singleSwap(){return{poolId:this.swapInfo.swaps[0].poolId,kind:this.kind,assetIn:this.swapInfo.tokenInForSwaps,assetOut:this.swapInfo.tokenOutFromSwaps,amount:this.amount.toString(),userData:"0x"}}attributes(){var e;if(!this.funds||!this.limit||!this.deadline)throw new Error("Uninitialized arguments");let t={request:this.singleSwap,funds:this.funds,limit:this.limit,deadline:this.deadline};const n=this.fragment();return n[0].inputs&&(null===(e=n[0].inputs)||void 0===e?void 0:e.length)>4&&(t={...t,value:"0",outputReference:"0"}),t}data(){return new t(this.fragment()).encodeFunctionData("swap",Object.values(this.attributes()))}value(e){let t=o.from(0);return this.swapInfo.tokenIn===i&&(t=this.kind===Re.SwapExactIn?this.swapInfo.amountIn:this.swapInfo.amountInForLimits.max(e)),t}to(){return this.relayer.address}fragment(){return Va(this.relayer).filter((e=>e.name===this.functionName))}}class Xa{constructor(e,t,n){this.kind=t,this.chainId=n,this.functionName="batchSwap",this.swapInfo=Ka(e,t),this.relayer=Wa(this.swapInfo.tokenIn,this.swapInfo.tokenOut,this.chainId)}setFunds(e,t){this.funds={sender:e,recipient:t||e,fromInternalBalance:!1,toInternalBalance:!1}}setDeadline(e){this.deadline=e}minAmountOut(e){return this.kind===Re.SwapExactIn?this.swapInfo.amountOutForLimits.min(e):this.swapInfo.amountOutForLimits.amount}maxAmountIn(e){return this.kind===Re.SwapExactOut?this.swapInfo.amountInForLimits.max(e):this.swapInfo.amountInForLimits.amount}setLimits(e){this.limits=this.swapInfo.tokenAddresses.map((t=>{let n=o.from(0);return t===this.swapInfo.tokenInForSwaps&&(n=this.maxAmountIn(e)),t===this.swapInfo.tokenOutFromSwaps&&(n=this.minAmountOut(e).mul(-1)),n})).map((e=>e.toString().split(".")[0]))}attributes(){var e;if(!this.funds||!this.limits||!this.deadline)throw new Error("Uninitialized arguments");let t={kind:this.kind,swaps:this.swapInfo.swaps,assets:this.swapInfo.tokenAddresses,funds:this.funds,limits:this.limits,deadline:this.deadline};const n=this.fragment();return n[0].inputs&&(null===(e=n[0].inputs)||void 0===e?void 0:e.length)>6&&(t={...t,value:"0",outputReferences:[]}),t}data(){return new t(this.fragment()).encodeFunctionData("batchSwap",Object.values(this.attributes()))}value(e){let t=o.from(0);return this.swapInfo.tokenIn===i&&(t=this.maxAmountIn(e)),t}to(){return this.relayer.address}fragment(){return Va(this.relayer).filter((e=>e.name===this.functionName))}}class Za{constructor(e){e instanceof C?(this.sor=e,this.chainId=this.sor.provider._network.chainId):(this.sor=new Da(e),this.chainId=e.network),this.vaultContract=U.connect(Le,this.sor.provider)}static getLimitsForSlippage(e,t,n,a,s,i){return De(e,t,n,a,s,i).map((e=>e.toString()))}async findRouteGivenIn({tokenIn:e,tokenOut:t,amount:n,gasPrice:a,maxPools:s=4}){return this.sor.getSwaps(e,t,R.SwapExactIn,n,{gasPrice:a,maxPools:s})}async findRouteGivenOut({tokenIn:e,tokenOut:t,amount:n,gasPrice:a,maxPools:s}){return this.sor.getSwaps(e,t,R.SwapExactOut,n,{gasPrice:a,maxPools:s})}buildSwap({userAddress:e,recipient:t,swapInfo:n,kind:a,deadline:s,maxSlippage:i}){if(!this.chainId)throw"Missing network configuration";const r=n.swaps.length>1?new Xa(n,a,this.chainId):new ja(n,a,this.chainId);r.setFunds(e,t),r.setDeadline(s),r.setLimits(i);const o=r.to(),{functionName:d}=r;return{to:o,functionName:d,attributes:r.attributes(),data:r.data(),value:r.value(i)}}static encodeBatchSwap(e){return U.createInterface().encodeFunctionData("batchSwap",[e.kind,e.swaps,e.assets,e.funds,e.limits,e.deadline])}static encodeSimpleFlashSwap(e){return this.encodeBatchSwap(function({poolIds:e,assets:t,flashLoanAmount:n,walletAddress:a}){Ca({poolIds:e,assets:t});const s=Ma(e,n),i={sender:a,fromInternalBalance:!1,recipient:a,toInternalBalance:!1};return{kind:Re.SwapExactIn,swaps:s,assets:t,funds:i,limits:["0","0"],deadline:"999999999999999999"}}(e))}async fetchPools(){return this.sor.fetchPools()}getPools(){return this.sor.getPools()}async queryBatchSwap(e){return await Ft(this.vaultContract,e.kind,e.swaps,e.assets)}async queryBatchSwapWithSor(e){return await Ut(this.sor,this.vaultContract,e)}async querySimpleFlashSwap(e){return await async function(e){Ca(e);const[t,n]=e.assets;try{const a=await Ft(e.vaultContract,Re.SwapExactIn,Ma(e.poolIds,e.flashLoanAmount),e.assets),s={[t]:Fa(a[0]).toString(),[n]:Fa(a[1]).toString()};return{profits:s,isProfitable:Ua([s[t],s[n]])>0}}catch(e){throw`Failed to querySimpleFlashSwap: ${e}`}}({...e,vaultContract:this.vaultContract})}async getSorSwap(e){return await Lt(e.tokenIn,e.tokenOut,e.swapType,e.amount,this.sor)}}var Ja=[{inputs:[{internalType:"contract IERC20",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approveVault",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getVault",outputs:[{internalType:"contract IVault",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IStaticATokenLM",name:"staticToken",type:"address"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bool",name:"toUnderlying",type:"bool"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"unwrapAaveStaticToken",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"contract IStaticATokenLM",name:"staticToken",type:"address"},{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bool",name:"fromUnderlying",type:"bool"},{internalType:"uint256",name:"outputReference",type:"uint256"}],name:"wrapAaveDynamicToken",outputs:[],stateMutability:"payable",type:"function"}];const Ya=new t(La);class za{constructor(e){this.swaps=e instanceof Za?e:new Za(e)}static encodeApproveVault(e,t){return Ya.encodeFunctionData("approveVault",[e,t])}static encodeSetRelayerApproval(e,t,n){return Ya.encodeFunctionData("setRelayerApproval",[e,t,n])}static encodeGaugeWithdraw(e,t,n,a){return Ya.encodeFunctionData("gaugeWithdraw",[e,t,n,a])}static encodeGaugeDeposit(e,t,n,a){return Ya.encodeFunctionData("gaugeDeposit",[e,t,n,a])}static encodeBatchSwap(e){return Ya.encodeFunctionData("batchSwap",[e.swapType,e.swaps,e.assets,e.funds,e.limits,e.deadline,e.value,e.outputReferences])}static encodeExitPool(e){return Ya.encodeFunctionData("exitPool",[e.poolId,e.poolKind,e.sender,e.recipient,e.exitPoolRequest,e.outputReferences])}static encodeUnwrapAaveStaticToken(e){return new t(Ja).encodeFunctionData("unwrapAaveStaticToken",[e.staticToken,e.sender,e.recipient,e.amount,e.toUnderlying,e.outputReferences])}static toChainedReference(e){const t=`0x${za.CHAINED_REFERENCE_PREFIX}${"0".repeat(64-za.CHAINED_REFERENCE_PREFIX.length)}`;return o.from(t).add(e)}static constructExitCall(e){const{assets:t,minAmountsOut:n,userData:a,toInternalBalance:s,poolId:i,poolKind:r,sender:o,recipient:d,outputReferences:p}=e,u={poolId:i,poolKind:r,sender:o,recipient:d,outputReferences:p,exitPoolRequest:{assets:t,minAmountsOut:n,userData:a,toInternalBalance:s}};return za.encodeExitPool(u)}async fetchPools(){return this.swaps.fetchPools()}getPools(){return this.swaps.getPools()}async exitPoolAndBatchSwap(e){const t=n.sub(o.from(e.slippage)),a=e.expectedAmountsOut.map((e=>o.from(e).mul(t).div(n).toString())),i=[];e.exitTokens.forEach(((e,t)=>{const n=za.toChainedReference(t);i.push({index:t,key:n})}));const r=za.constructExitCall({assets:e.exitTokens,minAmountsOut:a,userData:e.userData,toInternalBalance:!0,poolId:e.poolId,poolKind:0,sender:e.exiter,recipient:e.exiter,outputReferences:i,exitPoolRequest:{}}),d=await this.swaps.queryBatchSwapWithSor({tokensIn:e.exitTokens,tokensOut:e.finalTokensOut,swapType:Re.SwapExactIn,amounts:a,fetchPools:e.fetchPools});if(d.returnAmounts.includes("0"))throw new Ge($e.SWAP_ZERO_RETURN_AMOUNT);d.swaps.forEach((t=>{const n=d.assets[t.assetInIndex],a=e.exitTokens.indexOf(n);-1!==a&&(t.amount=i[a].key.toString())}));const p=n.add(e.slippage);e.exitTokens.forEach(((t,a)=>{const s=d.assets.map((e=>e.toLowerCase())).indexOf(t.toLowerCase());-1!==s&&(d.deltas[s]=o.from(e.expectedAmountsOut[a]).mul(p).div(n).toString())}));const u=Za.getLimitsForSlippage(e.exitTokens,e.finalTokensOut,Re.SwapExactIn,d.deltas,d.assets,"0"),l={sender:e.exiter,recipient:e.swapRecipient,fromInternalBalance:!0,toInternalBalance:!1};return{function:"multicall",params:[r,za.encodeBatchSwap({swapType:Re.SwapExactIn,swaps:d.swaps,assets:d.assets,funds:l,limits:u.map((e=>e.toString())),deadline:s,value:"0",outputReferences:[]})],outputs:{amountsOut:d.returnAmounts}}}async swapUnwrapAaveStaticExactIn(e,t,s,i,r,d,p={fetchPools:!0,fetchOnChain:!1}){const u=await this.swaps.queryBatchSwapWithSor({tokensIn:e,tokensOut:t,swapType:Re.SwapExactIn,amounts:s,fetchPools:p});if(u.returnAmounts.includes("0"))throw new Ge($e.SWAP_ZERO_RETURN_AMOUNT);const l=Za.getLimitsForSlippage(e,t,Re.SwapExactIn,u.deltas,u.assets,d);return{function:"multicall",params:this.encodeSwapUnwrap(t,Re.SwapExactIn,u.swaps,u.assets,r,l),outputs:{amountsOut:u.returnAmounts.map(((e,t)=>{const s=o.from(e).abs().mul(i[t]).div(n);if(!s.gt(a))throw new Ge($e.UNWRAP_ZERO_AMOUNT);return s.toString()}))}}}async swapUnwrapAaveStaticExactOut(e,t,s,i,r,d,p={fetchPools:!0,fetchOnChain:!1}){const u=s.map(((e,t)=>{const s=o.from(e).mul(n).div(i[t]);if(!s.gt(a))throw new Ge($e.WRAP_ZERO_AMOUNT);return s.toString()})),l=await this.swaps.queryBatchSwapWithSor({tokensIn:e,tokensOut:t,swapType:Re.SwapExactOut,amounts:u,fetchPools:p});if(l.returnAmounts.includes("0"))throw new Ge($e.SWAP_ZERO_RETURN_AMOUNT);const c=Za.getLimitsForSlippage(e,t,Re.SwapExactOut,l.deltas,l.assets,d);return{function:"multicall",params:this.encodeSwapUnwrap(t,Re.SwapExactOut,l.swaps,l.assets,r,c),outputs:{amountsIn:l.returnAmounts.map((e=>e.toString()))}}}encodeSwapUnwrap(e,t,n,a,i,r){const o=[],d=[];e.forEach(((e,t)=>{const n=a.findIndex((t=>t.toLowerCase()===e.toLowerCase()));if(-1===n)return;const s=za.toChainedReference(t);o.push({index:n,key:s});const r=za.encodeUnwrapAaveStaticToken({staticToken:e,sender:i.recipient,recipient:i.sender,amount:s,toUnderlying:!0,outputReferences:0});d.push(r)}));return[za.encodeBatchSwap({swapType:t,swaps:n,assets:a,funds:i,limits:r.map((e=>e.toString())),deadline:s,value:"0",outputReferences:o}),...d]}}za.CHAINED_REFERENCE_PREFIX="ba10";class Qa{constructor(e){this.url=Ra(e).urls.subgraph,this.client=this.initClient()}initClient(){return zn(new $(this.url))}}class es{constructor(e,t){this.swaps=t||new Za(e)}async fetchPools(){return this.swaps.fetchPools()}getPools(){return this.swaps.getPools()}async getSpotPrice(e,t,n=[]){0===n.length&&(await this.fetchPools(),n=this.getPools());const a=M(n,0),s=this.swaps.sor.routeProposer.getCandidatePathsFromDict(e,t,0,a,4);if(0===s.length)throw new Ge($e.UNSUPPORTED_PAIR);return F(s[0],0,x).toString()}}var ts=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{payable:!0,stateMutability:"payable",type:"fallback"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"}];class ns{constructor(e,t){this.contractAddresses="number"==typeof e?qe[e].addresses.contracts:e,this.vault=U.connect(this.contractAddresses.vault,t),this.contractAddresses.lidoRelayer&&(this.lidoRelayer=L.connect(this.contractAddresses.lidoRelayer,t)),this.multicall=Ea(this.contractAddresses.multicall,t)}get contracts(){return{vault:this.vault,lidoRelayer:this.lidoRelayer,multicall:this.multicall,ERC20:this.getErc20}}getErc20(e,t){return((e,t)=>new b(e,ts,t))(e,t)}}const as={1:{relayer:"0x886A3Ec7bcC508B8795990B60Fa21f85F9dB7948",staBal3:{id:"0x06df3b2bbb68adc8b0e302443692037ed9f91b42000000000000000000000063",address:"0x06df3b2bbb68adc8b0e302443692037ed9f91b42",gauge:"0x34f33cdaed8ba0e1ceece80e5f4a73bcf234cfac",assetOrder:["DAI","USDC","USDT"]},bbausd1:{id:"0x7b50775383d3d6f0215a8f290f2c9e2eebbeceb20000000000000000000000fe",address:"0x7b50775383d3d6f0215a8f290f2c9e2eebbeceb2",gauge:"0x68d019f64a7aa97e2d4e7363aee42251d08124fb",assetOrder:["bb-a-USDT","bb-a-DAI","bb-a-USDC"]},bbausd2:{id:"0xa13a9247ea42d743238089903570127dda72fe4400000000000000000000035d",address:"0xa13a9247ea42d743238089903570127dda72fe44",gauge:"0xa6325e799d266632d347e41265a69af111b05403"},linearUsdc1:{id:"0x9210f1204b5a24742eba12f710636d76240df3d00000000000000000000000fc",address:"0x9210F1204b5a24742Eba12f710636D76240dF3d0"},linearDai1:{id:"0x804cdb9116a10bb78768d3252355a1b18067bf8f0000000000000000000000fb",address:"0x804CdB9116a10bB78768D3252355a1b18067bF8f"},linearUsdt1:{id:"0x2bbf681cc4eb09218bee85ea2a5d3d13fa40fc0c0000000000000000000000fd",address:"0x2BBf681cC4eb09218BEe85EA2a5d3D13Fa40fC0C"},linearUsdc2:{id:"0x82698AECC9E28E9BB27608BD52CF57F704BD1B83000000000000000000000336",address:"0x82698aeCc9E28e9Bb27608Bd52cF57f704BD1B83"},linearDai2:{id:"0xAE37D54AE477268B9997D4161B96B8200755935C000000000000000000000337",address:"0xae37D54Ae477268B9997d4161B96b8200755935c"},linearUsdt2:{id:"0x2F4EB100552EF93840D5ADC30560E5513DFFFACB000000000000000000000334",address:"0x2F4eb100552ef93840d5aDC30560E5513DFfFACb"},maiusd:{id:"",address:"",gauge:"",assetOrder:["USDT","miMATIC","DAI","USDC"]},maibbausd:{id:"",address:"",gauge:"",assetOrder:["bb-a-USD","miMATIC"]},DAI:"0x6b175474e89094c44da98b954eedeac495271d0f",USDC:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",USDT:"0xdAC17F958D2ee523a2206206994597C13D831ec7",waDAI:"0x02d60b84491589974263d922d9cc7a3152618ef6",waUSDC:"0xd093fa4fb80d09bb30817fdcd442d4d02ed3e5de",waUSDT:"0xf8fd466f12e236f4c96f7cce6c79eadb819abf58",miMATIC:""},5:{relayer:"0x7b9B6f094DC2Bd1c12024b0D9CC63d6993Be1888",staBal3:{id:"0xdcdd4a3d36dec8d57594e89763d069a7e9b223e2000000000000000000000062",address:"0xdcdd4a3d36dec8d57594e89763d069a7e9b223e2",gauge:"0xfd364cda96bb7db06b65706182c448a73f0a5f9a",assetOrder:["USDT","DAI","USDC"]},staBal3_2:{id:"0xff9d677474d4344379924e10b68c8fea67e03294000000000000000000000072",address:"0xff9d677474d4344379924e10b68c8fea67e03294",gauge:"0x4e4ebf2aa90e41174d716a5168895357762d68af",assetOrder:["USDT","DAI","USDC"]},staBal3_3:{id:"0x3bfc8a0509f1a68aefd446f6c19bf37b3c75a8fc0000000000000000000000a5",address:"0x3bfc8a0509f1a68aefd446f6c19bf37b3c75a8fc",gauge:"0x7776e1008d7c20ab54aa57a7c44fc7de602de29a",assetOrder:["USDT","DAI","USDC"]},bbausd1:{id:"0x13acd41c585d7ebb4a9460f7c8f50be60dc080cd00000000000000000000005f",address:"0x13acd41c585d7ebb4a9460f7c8f50be60dc080cd",gauge:"0xa2d0ea81a47d68598922cd54c59249ff58c2a3ff",assetOrder:["bb-a-USDC","bb-a-DAI","bb-a-USDT"]},bbausd2:{id:"0x13acd41c585d7ebb4a9460f7c8f50be60dc080cd00000000000000000000005f",address:"0x13acd41c585d7ebb4a9460f7c8f50be60dc080cd",gauge:"0xa2d0ea81a47d68598922cd54c59249ff58c2a3ff"},linearUsdc1:{id:"0x0595d1df64279ddb51f1bdc405fe2d0b4cc8668100000000000000000000005c",address:"0x0595d1df64279ddb51f1bdc405fe2d0b4cc86681"},linearDai1:{id:"0x5cea6a84ed13590ed14903925fa1a73c36297d9900000000000000000000005d",address:"0x5cea6a84ed13590ed14903925fa1a73c36297d99"},linearUsdt1:{id:"0xefd681a82970ac5d980b9b2d40499735e7bf3f1f00000000000000000000005e",address:"0xefd681a82970ac5d980b9b2d40499735e7bf3f1f"},linearUsdc2:{id:"0x0595d1df64279ddb51f1bdc405fe2d0b4cc8668100000000000000000000005c",address:"0x0595d1df64279ddb51f1bdc405fe2d0b4cc86681"},linearDai2:{id:"0x5cea6a84ed13590ed14903925fa1a73c36297d9900000000000000000000005d",address:"0x5cea6a84ed13590ed14903925fa1a73c36297d99"},linearUsdt2:{id:"0xefd681a82970ac5d980b9b2d40499735e7bf3f1f00000000000000000000005e",address:"0xefd681a82970ac5d980b9b2d40499735e7bf3f1f"},maiusd:{id:"0x6a8f9ab364b85725973d2a33cb9aae2dac43b5e30000000000000000000000a6",address:"0x6a8f9ab364b85725973d2a33cb9aae2dac43b5e3",gauge:"0x58141bdcecb7fbae006964f4131cf6f65c948357",assetOrder:["USDT","miMATIC","DAI","USDC"]},maibbausd:{id:"0xb04b03b78cf79788a1931545bd2744161029648f0000000000000000000000a8",address:"0xb04b03b78cf79788a1931545bd2744161029648f",gauge:"0xdc3f6fc8898830e53c777543fe252b14f22680d4",assetOrder:["bb-a-USD","miMATIC","MAI BSP"]},USDT:"0x1f1f156e0317167c11aa412e3d1435ea29dc3cce",DAI:"0x8c9e6c40d3402480ace624730524facc5482798c",USDC:"0xe0c9275e44ea80ef17579d33c55136b7da269aeb",waDAI:"0x89534a24450081aa267c79b07411e9617d984052",waUSDC:"0x811151066392fd641fe74a9b55a712670572d161",waUSDT:"0x4cb1892fddf14f772b2e39e299f44b2e5da90d04",miMATIC:"0x398106564948feeb1fedea0709ae7d969d62a391"},137:{relayer:"0xcf6a66E32dCa0e26AcC3426b851FD8aCbF12Dac7",staBal3:{id:"",address:"",gauge:"",assetOrder:["USDT","DAI","USDC"]},bbausd1:{id:"",address:"",gauge:"",assetOrder:["bb-a-USDC","bb-a-DAI","bb-a-USDT"]},bbausd2:{id:"0x48e6b98ef6329f8f0a30ebb8c7c960330d64808500000000000000000000075b",address:"0x48e6b98ef6329f8f0a30ebb8c7c960330d648085",gauge:""},linearUsdc1:{id:"",address:""},linearDai1:{id:"",address:""},linearUsdt1:{id:"",address:""},linearUsdc2:{id:"0xf93579002dbe8046c43fefe86ec78b1112247bb8000000000000000000000759",address:"0xf93579002dbe8046c43fefe86ec78b1112247bb8"},linearDai2:{id:"0x178e029173417b1f9c8bc16dcec6f697bc323746000000000000000000000758",address:"0x178e029173417b1f9c8bc16dcec6f697bc323746"},linearUsdt2:{id:"0xff4ce5aaab5a627bf82f4a571ab1ce94aa365ea600000000000000000000075a",address:"0xff4ce5aaab5a627bf82f4a571ab1ce94aa365ea6"},maiusd:{id:"0x06df3b2bbb68adc8b0e302443692037ed9f91b42000000000000000000000012",address:"0x06df3b2bbb68adc8b0e302443692037ed9f91b42",gauge:"0x72843281394e68de5d55bcf7072bb9b2ebc24150",assetOrder:["USDC","DAI","miMATIC","USDT"]},maibbausd:{id:"0xb54b2125b711cd183edd3dd09433439d5396165200000000000000000000075e",address:"0xb54b2125b711cd183edd3dd09433439d53961652",gauge:"0x9a105ef22a59484aa2731c357049f6a13d0891f5",assetOrder:["bb-a-USD","miMATIC"]},USDT:"0xc2132d05d31c914a87c6611c10748aeb04b58e8f",DAI:"0x8f3cf7ad23cd3cadbd9735aff958023239c6a063",USDC:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",waDAI:"0xEE029120c72b0607344f35B17cdD90025e647B00",waUSDC:"0x221836a597948Dce8F3568E044fF123108aCc42A",waUSDT:"0x19C60a251e525fa88Cd6f3768416a8024e98fC19",miMATIC:"0xa3fa99a148fa48d14ed51d610c367c61876997f1"}};var ss=[{inputs:[{internalType:"contract IVault",name:"vault",type:"address"},{internalType:"address",name:"libraryAddress",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"getLibrary",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getVault",outputs:[{internalType:"contract IVault",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes[]",name:"data",type:"bytes[]"}],name:"multicall",outputs:[{internalType:"bytes[]",name:"results",type:"bytes[]"}],stateMutability:"payable",type:"function"},{stateMutability:"payable",type:"receive"}];const is=new t(ss),rs=za.toChainedReference("21"),os=za.toChainedReference("22"),ds=za.toChainedReference("23"),ps=za.toChainedReference("24");class us{constructor(e){this.addresses=as[e]}calldata(e,t,n,a,s){if(o.from(t).lte(0))throw new Ge($e.INPUT_ZERO_NOT_ALLOWED);const i=this.addresses.relayer;let r=[];s&&(r=[this.buildSetRelayerApproval(s)]),r=a?[...r,this.buildWithdraw(e,t),this.buildExit(i,t),this.buildSwap(n,i),this.buildDeposit(e)]:[...r,this.buildExit(e,t),this.buildSwap(n,e)];return{to:i,data:is.encodeFunctionData("multicall",[r])}}buildExit(e,t){const{assetOrder:n}=this.addresses.staBal3,a=n.map((e=>this.addresses[e])),s=J.exitExactBPTInForTokensOut(t),i=[{index:n.indexOf("DAI"),key:rs},{index:n.indexOf("USDC"),key:os},{index:n.indexOf("USDT"),key:ds}];return za.constructExitCall({assets:a,minAmountsOut:["0","0","0"],userData:s,toInternalBalance:!0,poolId:this.addresses.staBal3.id,poolKind:0,sender:e,recipient:this.addresses.relayer,outputReferences:i,exitPoolRequest:{}})}buildSwap(e,t){const n=[this.addresses.bbausd2.address,this.addresses.DAI,this.addresses.linearDai2.address,this.addresses.USDC,this.addresses.linearUsdc2.address,this.addresses.USDT,this.addresses.linearUsdt2.address],a=[{index:0,key:ps}],s=[{poolId:this.addresses.linearDai2.id,assetInIndex:1,assetOutIndex:2,amount:rs.toString(),userData:"0x"},{poolId:this.addresses.bbausd2.id,assetInIndex:2,assetOutIndex:0,amount:"0",userData:"0x"},{poolId:this.addresses.linearUsdc2.id,assetInIndex:3,assetOutIndex:4,amount:os.toString(),userData:"0x"},{poolId:this.addresses.bbausd2.id,assetInIndex:4,assetOutIndex:0,amount:"0",userData:"0x"},{poolId:this.addresses.linearUsdt2.id,assetInIndex:5,assetOutIndex:6,amount:ds.toString(),userData:"0x"},{poolId:this.addresses.bbausd2.id,assetInIndex:6,assetOutIndex:0,amount:"0",userData:"0x"}],i=[o.from(e).mul(-1).toString(),r.toString(),"0",r.toString(),"0",r.toString(),"0"],d={sender:this.addresses.relayer,recipient:t,fromInternalBalance:!0,toInternalBalance:!1};return za.encodeBatchSwap({swapType:Re.SwapExactIn,swaps:s,assets:n,funds:d,limits:i,deadline:o.from(Math.ceil(Date.now()/1e3)+3600),value:"0",outputReferences:a})}buildWithdraw(e,t){return za.encodeGaugeWithdraw(this.addresses.staBal3.gauge,e,this.addresses.relayer,t)}buildDeposit(e){return za.encodeGaugeDeposit(this.addresses.bbausd2.gauge,this.addresses.relayer,e,ps.toString())}buildSetRelayerApproval(e){return za.encodeSetRelayerApproval(this.addresses.relayer,!0,e)}}const ls=new t(ss),cs=za.toChainedReference("24");class ys{constructor(e){this.addresses=as[e]}calldata(e,t,n,a,s,i){if(o.from(t).lte(0))throw new Ge($e.INPUT_ZERO_NOT_ALLOWED);const r=this.addresses.relayer;let d=[];i&&(d=[this.buildSetRelayerApproval(i)]),d=a?[...d,this.buildWithdraw(e,t),this.buildSwap(t,n,r,r,s),this.buildDeposit(e)]:[...d,this.buildSwap(t,n,e,e,s)];const p=ls.encodeFunctionData("multicall",[d]);return{to:this.addresses.relayer,data:p}}buildSwap(e,t,n,s,i){const r=[this.addresses.bbausd2.address,this.addresses.waDAI,this.addresses.linearDai1.address,this.addresses.linearDai2.address,this.addresses.waUSDC,this.addresses.linearUsdc1.address,this.addresses.linearUsdc2.address,this.addresses.waUSDT,this.addresses.linearUsdt1.address,this.addresses.linearUsdt2.address,this.addresses.bbausd1.address],d=[{index:0,key:cs}],p=i.reduce(((e,t)=>e.add(o.from(t))),a),{assetOrder:u}=this.addresses.bbausd1,l=o.from(e).mul(i[u.indexOf("bb-a-USDC")]).div(p).toString(),c=o.from(e).mul(i[u.indexOf("bb-a-DAI")]).div(p).toString(),y=o.from(e).sub(l).sub(c).toString(),m=[{poolId:this.addresses.bbausd1.id,assetInIndex:10,assetOutIndex:2,amount:c,userData:"0x"},{poolId:this.addresses.linearDai1.id,assetInIndex:2,assetOutIndex:1,amount:"0",userData:"0x"},{poolId:this.addresses.linearDai2.id,assetInIndex:1,assetOutIndex:3,amount:"0",userData:"0x"},{poolId:this.addresses.bbausd2.id,assetInIndex:3,assetOutIndex:0,amount:"0",userData:"0x"},{poolId:this.addresses.bbausd1.id,assetInIndex:10,assetOutIndex:5,amount:l,userData:"0x"},{poolId:this.addresses.linearUsdc1.id,assetInIndex:5,assetOutIndex:4,amount:"0",userData:"0x"},{poolId:this.addresses.linearUsdc2.id,assetInIndex:4,assetOutIndex:6,amount:"0",userData:"0x"},{poolId:this.addresses.bbausd2.id,assetInIndex:6,assetOutIndex:0,amount:"0",userData:"0x"},{poolId:this.addresses.bbausd1.id,assetInIndex:10,assetOutIndex:8,amount:y,userData:"0x"},{poolId:this.addresses.linearUsdt1.id,assetInIndex:8,assetOutIndex:7,amount:"0",userData:"0x"},{poolId:this.addresses.linearUsdt2.id,assetInIndex:7,assetOutIndex:9,amount:"0",userData:"0x"},{poolId:this.addresses.bbausd2.id,assetInIndex:9,assetOutIndex:0,amount:"0",userData:"0x"}],b=[o.from(t).mul(-1).toString(),"0","0","0","0","0","0","0","0","0",e],h={sender:n,recipient:s,fromInternalBalance:!1,toInternalBalance:!1};return za.encodeBatchSwap({swapType:Re.SwapExactIn,swaps:m,assets:r,funds:h,limits:b,deadline:o.from(Math.ceil(Date.now()/1e3)+3600),value:"0",outputReferences:d})}buildWithdraw(e,t){return za.encodeGaugeWithdraw(this.addresses.bbausd1.gauge,e,this.addresses.relayer,t)}buildDeposit(e){return za.encodeGaugeDeposit(this.addresses.bbausd2.gauge,this.addresses.relayer,e,cs.toString())}buildSetRelayerApproval(e){return za.encodeSetRelayerApproval(this.addresses.relayer,!0,e)}}const ms=new t(ss),bs=za.toChainedReference("0"),hs=[];class fs{constructor(e){this.addresses=as[e]}calldata(e,t,n,a,s,i,r,o){if(i&&(null==t.gauge||null==n.gauge))throw new Error("Staked flow migration requires gauge addresses to be provided");const d=this.addresses.relayer;let p=[];o&&(p=[this.buildSetRelayerApproval(o)]),p=i?[...p,this.buildWithdraw(e,a,t.gauge),this.buildExit(t.id,d,a,r),this.buildSwap(s,d,n.id,n.address,r),this.buildDeposit(e,n.gauge)]:[...p,this.buildExit(t.id,e,a,r),this.buildSwap(s,e,n.id,n.address,r)];const u=ms.encodeFunctionData("multicall",[p]);return{to:this.addresses.relayer,data:u}}buildExit(e,t,n,a){const s=J.exitExactBPTInForTokensOut(n),i=[];for(let e=0;e<a.length;e++)i[e]={index:e,key:za.toChainedReference(`${e+1}`)},hs.push(i[e].key);const r=Array(a.length).fill("0");return za.constructExitCall({assets:a,minAmountsOut:r,userData:s,toInternalBalance:!0,poolId:e,poolKind:0,sender:t,recipient:this.addresses.relayer,outputReferences:i,exitPoolRequest:{}})}buildSwap(e,t,n,a,s){const i=[a,...s],d=[{index:0,key:bs}],p=[];for(let e=0;e<s.length;e++)p.push({poolId:n,assetInIndex:e+1,assetOutIndex:0,amount:hs[e].toString(),userData:"0x"});const u=[o.from(e).mul(-1).toString()];for(let e=0;e<s.length;e++)u.push(r.toString());const l={sender:this.addresses.relayer,recipient:t,fromInternalBalance:!0,toInternalBalance:!1};return za.encodeBatchSwap({swapType:Re.SwapExactIn,swaps:p,assets:i,funds:l,limits:u,deadline:o.from(Math.ceil(Date.now()/1e3)+3600),value:"0",outputReferences:d})}buildWithdraw(e,t,n){return za.encodeGaugeWithdraw(n,e,this.addresses.relayer,t)}buildDeposit(e,t){return za.encodeGaugeDeposit(t,this.addresses.relayer,e,bs.toString())}buildSetRelayerApproval(e){return za.encodeSetRelayerApproval(this.addresses.relayer,!0,e)}}const Ts=new t(ss),Is=za.toChainedReference("20"),gs=za.toChainedReference("21"),ws=za.toChainedReference("22"),Es=za.toChainedReference("23"),Ss=za.toChainedReference("24");class _s{constructor(e){this.addresses=as[e]}calldata(e,t,n,a,s){if(o.from(t).lte(0))throw new Ge($e.INPUT_ZERO_NOT_ALLOWED);const i=this.addresses.relayer;let r=[];s&&(r=[this.buildSetRelayerApproval(s)]),r=a?[...r,this.buildWithdraw(e,t),this.buildExit(i,t),this.buildSwap(i,n),this.buildDeposit(e)]:[...r,this.buildExit(e,t),this.buildSwap(e,n)];return{to:i,data:Ts.encodeFunctionData("multicall",[r])}}buildExit(e,t){const{assetOrder:n}=this.addresses.maiusd,a=n.map((e=>this.addresses[e])),s=J.exitExactBPTInForTokensOut(t),i=[{index:n.indexOf("miMATIC"),key:Is},{index:n.indexOf("DAI"),key:gs},{index:n.indexOf("USDC"),key:ws},{index:n.indexOf("USDT"),key:Es}],r=Array(a.length).fill("0");return za.constructExitCall({assets:a,minAmountsOut:r,userData:s,toInternalBalance:!0,poolId:this.addresses.maiusd.id,poolKind:0,sender:e,recipient:this.addresses.relayer,outputReferences:i,exitPoolRequest:{}})}buildSwap(e,t){const n=[this.addresses.bbausd2.address,this.addresses.DAI,this.addresses.linearDai2.address,this.addresses.USDC,this.addresses.linearUsdc2.address,this.addresses.USDT,this.addresses.linearUsdt2.address,this.addresses.miMATIC,this.addresses.maibbausd.address],a=[{index:8,key:Ss}],s=[{poolId:this.addresses.linearDai2.id,assetInIndex:1,assetOutIndex:2,amount:gs.toString(),userData:"0x"},{poolId:this.addresses.bbausd2.id,assetInIndex:2,assetOutIndex:0,amount:"0",userData:"0x"},{poolId:this.addresses.maibbausd.id,assetInIndex:0,assetOutIndex:8,amount:"0",userData:"0x"},{poolId:this.addresses.linearUsdc2.id,assetInIndex:3,assetOutIndex:4,amount:ws.toString(),userData:"0x"},{poolId:this.addresses.bbausd2.id,assetInIndex:4,assetOutIndex:0,amount:"0",userData:"0x"},{poolId:this.addresses.maibbausd.id,assetInIndex:0,assetOutIndex:8,amount:"0",userData:"0x"},{poolId:this.addresses.linearUsdt2.id,assetInIndex:5,assetOutIndex:6,amount:Es.toString(),userData:"0x"},{poolId:this.addresses.bbausd2.id,assetInIndex:6,assetOutIndex:0,amount:"0",userData:"0x"},{poolId:this.addresses.maibbausd.id,assetInIndex:0,assetOutIndex:8,amount:"0",userData:"0x"},{poolId:this.addresses.maibbausd.id,assetInIndex:7,assetOutIndex:8,amount:Is.toString(),userData:"0x"}],i=["0",r.toString(),"0",r.toString(),"0",r.toString(),"0",r.toString(),o.from(t).mul(-1).toString()],d={sender:this.addresses.relayer,recipient:e,fromInternalBalance:!0,toInternalBalance:!1};return za.encodeBatchSwap({swapType:Re.SwapExactIn,swaps:s,assets:n,funds:d,limits:i,deadline:o.from(Math.ceil(Date.now()/1e3)+3600),value:"0",outputReferences:a})}buildWithdraw(e,t){return za.encodeGaugeWithdraw(this.addresses.maiusd.gauge,e,this.addresses.relayer,t)}buildDeposit(e){return za.encodeGaugeDeposit(this.addresses.maibbausd.gauge,this.addresses.relayer,e,Ss.toString())}buildSetRelayerApproval(e){return za.encodeSetRelayerApproval(this.addresses.relayer,!0,e)}}class Os{constructor(e){this.network=e}stabal3(t,n,a,s,i){const r=new us(this.network).calldata(t,n,a,s,i);return{to:r.to,data:r.data,decode:(t,n)=>{let a=n?2:1;i&&(a+=1);const s=e.decode(["bytes[]"],t);return e.decode(["int256[]"],s[0][a])[0][0].abs().toString()}}}bbaUsd(t,n,a,s,i,r){const o=new ys(this.network).calldata(t,n,a,s,i,r);return{to:o.to,data:o.data,decode:(t,n)=>{let a=n?1:0;r&&(a+=1);const s=e.decode(["bytes[]"],t);return e.decode(["int256[]"],s[0][a])[0][0].abs().toString()}}}stables(t,n,a,s,i,r,o,d){const p=new fs(this.network).calldata(t,n,a,s,i,r,o,d);return{to:p.to,data:p.data,decode:(t,n)=>{let a=n?2:1;d&&(a+=1);const s=e.decode(["bytes[]"],t);return e.decode(["int256[]"],s[0][a])[0][0].abs().toString()}}}maiusd(t,n,a,s,i){const r=new _s(this.network).calldata(t,n,a,s,i);return{to:r.to,data:r.data,decode:(t,n)=>{let a=n?2:1;i&&(a+=1);const s=e.decode(["bytes[]"],t);return e.decode(["int256[]"],s[0][a])[0][8].abs().toString()}}}}class As{constructor(e){this.network=e,this.migrations=new Os(e)}}let xs=!1,Ps=!1;const Ns={debug:1,default:2,info:2,warning:3,error:4,off:5};let ks=Ns.default,vs=null;const Bs=function(){try{const e=[];if(["NFD","NFC","NFKD","NFKC"].forEach((t=>{try{if("test"!=="test".normalize(t))throw new Error("bad normalize")}catch(n){e.push(t)}})),e.length)throw new Error("missing "+e.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(e){return e.message}return null}();var Rs,Ds;!function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR",e.OFF="OFF"}(Rs||(Rs={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.NOT_IMPLEMENTED="NOT_IMPLEMENTED",e.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.TIMEOUT="TIMEOUT",e.BUFFER_OVERRUN="BUFFER_OVERRUN",e.NUMERIC_FAULT="NUMERIC_FAULT",e.MISSING_NEW="MISSING_NEW",e.INVALID_ARGUMENT="INVALID_ARGUMENT",e.MISSING_ARGUMENT="MISSING_ARGUMENT",e.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",e.CALL_EXCEPTION="CALL_EXCEPTION",e.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",e.NONCE_EXPIRED="NONCE_EXPIRED",e.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",e.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",e.TRANSACTION_REPLACED="TRANSACTION_REPLACED",e.ACTION_REJECTED="ACTION_REJECTED"}(Ds||(Ds={}));const Cs="0123456789abcdef";class Ms{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){const n=e.toLowerCase();null==Ns[n]&&this.throwArgumentError("invalid log level name","logLevel",e),ks>Ns[n]||console.log.apply(console,t)}debug(...e){this._log(Ms.levels.DEBUG,e)}info(...e){this._log(Ms.levels.INFO,e)}warn(...e){this._log(Ms.levels.WARNING,e)}makeError(e,t,n){if(Ps)return this.makeError("censored error",t,{});t||(t=Ms.errors.UNKNOWN_ERROR),n||(n={});const a=[];Object.keys(n).forEach((e=>{const t=n[e];try{if(t instanceof Uint8Array){let n="";for(let e=0;e<t.length;e++)n+=Cs[t[e]>>4],n+=Cs[15&t[e]];a.push(e+"=Uint8Array(0x"+n+")")}else a.push(e+"="+JSON.stringify(t))}catch(t){a.push(e+"="+JSON.stringify(n[e].toString()))}})),a.push(`code=${t}`),a.push(`version=${this.version}`);const s=e;let i="";switch(t){case Ds.NUMERIC_FAULT:{i="NUMERIC_FAULT";const t=e;switch(t){case"overflow":case"underflow":case"division-by-zero":i+="-"+t;break;case"negative-power":case"negative-width":i+="-unsupported";break;case"unbound-bitwise-result":i+="-unbound-result"}break}case Ds.CALL_EXCEPTION:case Ds.INSUFFICIENT_FUNDS:case Ds.MISSING_NEW:case Ds.NONCE_EXPIRED:case Ds.REPLACEMENT_UNDERPRICED:case Ds.TRANSACTION_REPLACED:case Ds.UNPREDICTABLE_GAS_LIMIT:i=t}i&&(e+=" [ See: https://links.ethers.org/v5-errors-"+i+" ]"),a.length&&(e+=" ("+a.join(", ")+")");const r=new Error(e);return r.reason=s,r.code=t,Object.keys(n).forEach((function(e){r[e]=n[e]})),r}throwError(e,t,n){throw this.makeError(e,t,n)}throwArgumentError(e,t,n){return this.throwError(e,Ms.errors.INVALID_ARGUMENT,{argument:t,value:n})}assert(e,t,n,a){e||this.throwError(t,n,a)}assertArgument(e,t,n,a){e||this.throwArgumentError(t,n,a)}checkNormalize(e){Bs&&this.throwError("platform missing String.prototype.normalize",Ms.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Bs})}checkSafeUint53(e,t){"number"==typeof e&&(null==t&&(t="value not safe"),(e<0||e>=9007199254740991)&&this.throwError(t,Ms.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,Ms.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,n){n=n?": "+n:"",e<t&&this.throwError("missing argument"+n,Ms.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+n,Ms.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){e!==Object&&null!=e||this.throwError("missing new",Ms.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",Ms.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):e!==Object&&null!=e||this.throwError("missing new",Ms.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return vs||(vs=new Ms("logger/5.7.0")),vs}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",Ms.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),xs){if(!e)return;this.globalLogger().throwError("error censorship permanent",Ms.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Ps=!!e,xs=!!t}static setLogLevel(e){const t=Ns[e.toLowerCase()];null!=t?ks=t:Ms.globalLogger().warn("invalid log level - "+e)}static from(e){return new Ms(e)}}Ms.errors=Ds,Ms.levels=Rs;new Ms("units/5.7.0");const Fs=["wei","kwei","mwei","gwei","szabo","finney","ether"];function Us(e,t){if("string"==typeof t){const e=Fs.indexOf(t);-1!==e&&(t=3*e)}return p(e,null!=t?t:18)}const Ls=e=>365*(145e3*1.189207115002721**-e/7),qs=(e,t)=>{if(e<1648465251)throw"start timestamp before emission schedule deployment";if(t<e)throw"cannot finish before starting";let n=0;const a=Math.floor((e-1648465251)/31536e3),s=Math.floor((t-1648465251)/31536e3);for(let e=a;e<=s;e++)n+=Ls(e);const i=1648465251+31536e3*(a+1)-e,r=t-(1648465251+31536e3*s);return n-=Ls(a)*(31536e3-i)/31536e3,n-=Ls(s)*(31536e3-r)/31536e3,n};var $s=Object.freeze({__proto__:null,INITIAL_RATE:145e3,START_EPOCH_TIME:1648465251,weekly:(e=Math.round((new Date).getTime()/1e3))=>145e3*1.189207115002721**-Math.floor((e-1648465251)/31536e3),total:Ls,between:qs});class Gs{constructor(e,t){this.repository=e,this.tokenPrices=t}async data(e=Date.now()){const t=await this.repository.multicallData(e),n=await this.tokenPrices.find(t.balAddress);if(!n||!n.usd)throw"No BAL USD price found";return{lastWeekBalRevenue:t.balAmount*parseFloat(n.usd),lastWeekBBAUsdRevenue:t.bbAUsdAmount*t.bbAUsdPrice,veBalSupply:t.veBalSupply}}}class Ws{constructor(e){this.yesterdaysPools=e}async last24h(e){let t;return this.yesterdaysPools&&(t=await this.yesterdaysPools.find(e.id)),e.totalSwapFee?t&&t.totalSwapFee?parseFloat(e.totalSwapFee)-parseFloat(t.totalSwapFee):parseFloat(e.totalSwapFee):0}}class Vs{constructor(e,t,n,a,s,i,r,o,d){this.pools=e,this.tokenPrices=t,this.tokenMeta=n,this.tokenYields=a,this.feeCollector=s,this.yesterdaysPools=i,this.liquidityGauges=r,this.feeDistributor=o,this.protocolFees=d}async swapFees(e){const t=await this.last24hFees(e),n=await this.totalLiquidity(e);if(!t||!n)return 0;const a=t*(1-await this.protocolSwapFeePercentage())/parseFloat(n)*1e4;return Math.round(365*a)}async tokenAprs(e){if(!e.tokens)return{total:0,breakdown:{}};const t=await this.totalLiquidity(e),n=e.tokens.filter((t=>t.address!==e.address)),a=n.map((async t=>{let n=0;const a=await this.tokenYields.find(t.address);if(a)if("MetaStable"===e.poolType)n=a*(1-await this.protocolSwapFeePercentage());else if("ComposableStable"===e.poolType){n=a*(1-(await this.protocolFeesPercentage()).yieldFee)}else n=a;else{const e=await this.pools.findBy("address",t.address);if(e){n=await this.swapFees(e)+(await this.tokenAprs(e)).total}}return n})),s=n.map((async e=>{var n,a;if(e.weight)return parseFloat(e.weight);{let s=(null===(n=e.price)||void 0===n?void 0:n.usd)||(null===(a=await this.tokenPrices.find(e.address))||void 0===a?void 0:a.usd);if(!s){const t=await this.pools.findBy("address",e.address);if(!t)throw`No price for ${e.address}`;s=(await this.bptPrice(t)).toString()}return parseFloat(e.balance)*parseFloat(s)/parseFloat(t)}})),i=await Promise.all(a.map((async(e,t)=>{const[n,a]=await Promise.all([e,s[t]]);return Math.round(n*a)}))),r=i.reduce(((e,t)=>e+t),0);return{total:r,breakdown:E(S(n.map((e=>e.address)),i),_)}}async stakingApr(e,t=1){if(!this.liquidityGauges||1!=e.chainId)return 0;const n=await this.liquidityGauges.findBy("poolId",e.id);if(!n)return 0;const[a,s]=await Promise.all([this.tokenPrices.find("0xba100000625a3754423978a60c9317c58a424e3d"),this.bptPrice(e)]),i=parseFloat((null==a?void 0:a.usd)||"0"),r=Math.round((new Date).getTime()/1e3),o=qs(r,r+31536e3)*n.relativeWeight*i,d=(n.workingSupply+.4)/.4*s;return Math.round(1e4*t*o/d)}async rewardAprs(e){if(!this.liquidityGauges)return{total:0,breakdown:{}};const t=await this.liquidityGauges.findBy("poolId",e.id);if(!t||!t.rewardTokens||Object.keys(t.rewardTokens).length<1)return{total:0,breakdown:{}};const n=Object.keys(t.rewardTokens).map((async e=>{const n=t.rewardTokens[e];return this.rewardTokenApr(e,n)})),a=await this.bptPrice(e),s=t.totalSupply*a;if(0==s)return{total:0,breakdown:{}};const i={};let r=0;for await(const e of Object.values(n)){r+=e.value/s,i[e.address]=e.value}return{total:Math.round(1e4*r),breakdown:i}}async protocolApr(e){if("0x5c6ee304399dbdb9c8ef030ab642b10820db8f56000200000000000000000014"!=e.id||!this.feeDistributor)return 0;const t=new Gs(this.feeDistributor,this.tokenPrices),{lastWeekBalRevenue:n,lastWeekBBAUsdRevenue:a,veBalSupply:s}=await t.data(),i=await this.bptPrice(e);if(!i)throw"bptPrice for veBal pool missing";const r=(n+a)/7;return Math.round(365*r*1e4/(i*s))}async apr(e){const[t,n,a,s,i,r]=await Promise.all([this.swapFees(e),this.tokenAprs(e),this.stakingApr(e),this.stakingApr(e,2.5),this.rewardAprs(e),this.protocolApr(e)]);return{swapFees:t,tokenAprs:n,stakingApr:{min:a,max:s},rewardAprs:i,protocolApr:r,min:t+n.total+i.total+a,max:t+n.total+i.total+r+s}}async last24hFees(e){return new Ws(this.yesterdaysPools).last24h(e)}async totalLiquidity(e){const t=new Mt(this.pools,this.tokenPrices);return await t.getLiquidity(e)}async bptPrice(e){return parseFloat(await this.totalLiquidity(e))/parseFloat(e.totalShares)}async protocolSwapFeePercentage(){const e=await this.feeCollector.find("");return e||0}async protocolFeesPercentage(){return this.protocolFees?await this.protocolFees.getFees():{swapFee:0,yieldFee:0}}async rewardTokenApr(e,t){if(t.period_finish.toNumber()<Date.now()/1e3)return{address:e,value:0};{const n=t.rate.mul(86400).mul(365),a=await this.tokenPrices.find(e);if(a&&a.usd){const t=await this.tokenMeta.find(e),s=(null==t?void 0:t.decimals)||18;return{address:e,value:parseFloat(Us(n,s))*parseFloat(a.usd)}}throw`No USD price for ${e}`}}}class Hs{constructor(e){this.yesterdaysPools=e}async last24h(e){let t;return this.yesterdaysPools&&(t=await this.yesterdaysPools.find(e.id)),e.totalSwapVolume?t&&t.totalSwapVolume?parseFloat(e.totalSwapVolume)-parseFloat(t.totalSwapVolume):parseFloat(e.totalSwapVolume):0}}class Ks{constructor(e,t){this.networkConfig=e,this.repositories=t,this.aprService=new Vs(this.repositories.pools,this.repositories.tokenPrices,this.repositories.tokenMeta,this.repositories.tokenYields,this.repositories.feeCollector,this.repositories.yesterdaysPools,this.repositories.liquidityGauges,this.repositories.feeDistributor),this.liquidityService=new Mt(t.pools,t.tokenPrices),this.feesService=new Ws(t.yesterdaysPools),this.volumeService=new Hs(t.yesterdaysPools)}dataSource(){return this.repositories.pools}async apr(e){return this.aprService.apr(e)}async liquidity(e){return this.liquidityService.getLiquidity(e)}async fees(e){return this.feesService.last24h(e)}async volume(e){return this.volumeService.last24h(e)}static wrap(e,t){const n=Ct.from(e.poolType),a=t.addresses.tokens.wrappedNativeAsset.toLowerCase();return{...e,buildJoin:(t,s,i,r)=>n.join.buildJoin({joiner:t,pool:e,tokensIn:s,amountsIn:i,slippage:r,wrappedNativeAsset:a}),calcPriceImpact:async(t,a)=>n.priceImpactCalculator.calcPriceImpact(e,t,a),buildExitExactBPTIn:(t,s,i,r=!1,o)=>{if(n.exit.buildExitExactBPTIn)return n.exit.buildExitExactBPTIn({exiter:t,pool:e,bptIn:s,slippage:i,shouldUnwrapNativeAsset:r,wrappedNativeAsset:a,singleTokenMaxOut:o});throw"ExitExactBPTIn not supported"},buildExitExactTokensOut:(t,s,i,r)=>n.exit.buildExitExactTokensOut({exiter:t,pool:e,tokensOut:s,amountsOut:i,slippage:r,wrappedNativeAsset:a}),calcSpotPrice:(t,a)=>n.spotPriceCalculator.calcPoolSpotPrice(t,a,e)}}async find(e){const t=await this.dataSource().find(e);if(t)return Ks.wrap(t,this.networkConfig)}async findBy(e,t){if("id"==e)return this.find(t);if("address"==e){const e=await this.dataSource().findBy("address",t);if(!e)return;return Ks.wrap(e,this.networkConfig)}throw`search by ${e} not implemented`}async all(){const e=await this.dataSource().all();return e?e.map((e=>Ks.wrap(e,this.networkConfig))):[]}async where(e){const t=await this.dataSource().where(e);return t?t.map((e=>Ks.wrap(e,this.networkConfig))):[]}}const js=new t(["function gauge_relative_weight(address gauge, uint timestamp) view returns (uint)"]);class Xs{constructor(e,t,n){this.gaugeControllerAddress=t,this.multicall=Ea(e,n)}async getRelativeWeights(e,t){const n=e.map((e=>[this.gaugeControllerAddress,js.encodeFunctionData("gauge_relative_weight",[u(e),t||Math.floor(Date.now()/1e3)])])),[,a]=await this.multicall.aggregate(n);return e.reduce(((e,t,n)=>(e[t]||(e[t]=parseFloat(Us(a[n],18))),e)),{})}}const Zs=new t(["function totalSupply() view returns (uint)","function working_supply() view returns (uint)","function reward_count() view returns (uint)","function reward_tokens(uint rewardIndex) view returns (address)","function reward_data(address rewardToken) view returns (tuple(address token, address distributor, uint period_finish, uint rate, uint last_update, uint integral) data)"]);class Js{constructor(e,t,n){this.chainId=t,this.multicall=Ea(e,n)}async getTotalSupplies(e){const t=e.map((e=>[e,Zs.encodeFunctionData("totalSupply",[])])),[,n]=await this.multicall.aggregate(t),a=n.map((e=>"0x"==e?"0x0":e));return e.reduce(((e,t,n)=>(e[t]||(e[t]=parseFloat(Us(a[n],18))),e)),{})}async getWorkingSupplies(e){const t=e.map((e=>[e,Zs.encodeFunctionData("working_supply",[])])),[,n]=await this.multicall.aggregate(t),a=n.map((e=>"0x"==e?"0x0":e));return e.reduce(((e,t,n)=>(e[t]||(e[t]=parseFloat(Us(a[n],18))),e)),{})}async getRewardCounts(e){let t;if(1==this.chainId){const n=e.map((e=>[e,Zs.encodeFunctionData("reward_count",[])])),[,a]=await this.multicall.aggregate(n),s=a.map((e=>"0x"==e?"0x0":e));t=e.reduce(((e,t,n)=>(e[t]||(e[t]=parseInt(s[n])),e)),{})}else t=e.reduce(((e,t)=>(e[t]||(e[t]=1),e)),{});return t}async getRewardTokens(e,t){const n=t||await this.getRewardCounts(e),a=e.filter((e=>n[e]>0)),s=[0],i=a.map(((e,t)=>{const a=[];for(let t=0;t<n[e];t++)a.push([e,Zs.encodeFunctionData("reward_tokens",[t])]);return s[t+1]=s[t]+n[e],a})).flat(),[,r]=await this.multicall.aggregate(i);return a.reduce(((e,t,n)=>{const a=s[n],i=s[n+1],o=[];for(let e=a;e<i;e++)o.push(Zs.decodeFunctionResult("reward_tokens",r[e])[0]);return e[t]||(e[t]=o),e}),{})}async getRewardData(e,t){const n=t||await this.getRewardTokens(e),a=[0],s=Object.keys(n).map(((e,t)=>{const s=[];for(let t=0;t<n[e].length;t++)s.push([e,Zs.encodeFunctionData("reward_data",[n[e][t]])]);return a[t+1]=a[t]+n[e].length,s})).flat(),[,i]=await this.multicall.aggregate(s),r=i.map((e=>Zs.decodeFunctionResult("reward_data",e)[0]));return Object.keys(n).reduce(((e,t,s)=>{const i=a[s],o=n[t].reduce(((e,t,n)=>(e[t]||(e[t]=r[i+n]),e)),{});return e[t]||(e[t]=o),e}),{})}}class Ys{constructor(e){this.gauges=[],this.client=ga(e)}async fetch(){const e=(await this.client.Pools({where:{preferentialGauge_not:null}})).pools.map((e=>e.preferentialGauge));return this.gauges=e,this.gauges}async find(e){return 0==this.gauges.length&&await this.fetch(),this.gauges.find((t=>t.id==e))}async findBy(e,t){if(0==this.gauges.length&&await this.fetch(),"id"==e)return this.find(t);if("poolId"==e)return this.gauges.find((e=>e.poolId==t));if("poolAddress"==e)return this.gauges.find((e=>e.poolAddress==t));throw`search by ${e} not implemented`}}class zs{constructor(e,t,n,a,s){this.chainId=a,this.workingSupplies={},this.relativeWeights={},this.rewardData={},n&&(this.gaugeController=new Xs(t,n,s)),this.multicall=new Js(t,a,s),this.subgraph=new Ys(e)}async fetch(){const e=await this.subgraph.fetch(),t=e.map((e=>e.id));return 1==this.chainId&&(this.workingSupplies=await this.multicall.getWorkingSupplies(t)),this.gaugeController&&(this.relativeWeights=await this.gaugeController.getRelativeWeights(t)),this.rewardData=await this.multicall.getRewardData(t),e.map(this.compose.bind(this))}async find(e){return this.gauges||(this.gauges=this.fetch()),(await this.gauges).find((t=>t.id==e))}async findBy(e,t){let n;if(this.gauges||(this.gauges=this.fetch()),"id"==e)return this.find(t);if("address"==e)return this.find(t);if("poolId"==e)n=(await this.gauges).find((e=>e.poolId==t));else{if("poolAddress"!=e)throw`search by ${e} not implemented`;n=(await this.gauges).find((e=>e.poolAddress==t))}return n}compose(e){return{id:e.id,address:e.id,name:e.symbol,poolId:e.poolId,poolAddress:e.poolAddress,totalSupply:parseFloat(e.totalSupply),workingSupply:this.workingSupplies[e.id],relativeWeight:this.relativeWeights[e.id],rewardTokens:this.rewardData[e.id]}}}class Qs{constructor(e,t){this.url=e,this.apiKey=t}async get(e){try{const t=this.toPayload(e),{data:n}=await W.post(this.url,t,{headers:{"x-api-key":this.apiKey}});if(n.errors)throw new Error(n.errors.map((e=>e.message)).join(","));return n.data}catch(e){throw console.error(e),e}return[]}toPayload(e){return JSON.stringify({query:V({query:e})})}}class ei{constructor(e){var t,n;this.pools=[],this.skip=0,this.client=new Qs(e.url,e.apiKey);this.query={args:(null===(t=e.query)||void 0===t?void 0:t.args)||{chainId:1,orderBy:"totalLiquidity",orderDirection:"desc",where:{swapEnabled:{eq:!0},totalShares:{gt:.05}}},attrs:(null===(n=e.query)||void 0===n?void 0:n.attrs)||{id:!0,address:!0}}}fetchFromCache(e){const t=(null==e?void 0:e.first)||10,n=(null==e?void 0:e.skip)||0,a=this.pools.slice(n,t+n);return this.skip=n+t,a}async fetch(e){if(this.pools.length>((null==e?void 0:e.first)||10)+((null==e?void 0:e.skip)||0))return this.fetchFromCache(e);this.nextToken&&(this.query.args.nextToken=this.nextToken),(null==e?void 0:e.first)&&(this.query.args.first=2*e.first);const t=new xe(this.query.args).format(new Oe),n=this.query.attrs;n.nextToken=!0;const a={pools:{__args:t,...n}},s=(await this.client.get(a)).pools;return this.nextToken=s.nextToken,this.pools=this.pools.concat(s.pools.map(this.format)),this.skip=this.pools.length,this.fetchFromCache(e)}async find(e){return 0==this.pools.length&&await this.fetch(),this.findBy("id",e)}async findBy(e,t){0==this.pools.length&&await this.fetch();const n=this.pools.find((n=>n[e]==t));if(n)return this.format(n)}format(e){var t,n,a,s;if(null===(t=e.apr)||void 0===t?void 0:t.rewardAprs.breakdown){const t=JSON.parse(null===(n=e.apr)||void 0===n?void 0:n.rewardAprs.breakdown);e.apr.rewardAprs.breakdown=t}if(null===(a=e.apr)||void 0===a?void 0:a.tokenAprs.breakdown){const t=JSON.parse(null===(s=e.apr)||void 0===s?void 0:s.tokenAprs.breakdown);e.apr.tokenAprs.breakdown=t}return e}}class ti{constructor(e,t={}){this.providers=e,this.currentProviderIdx=0,this.timeout=t.timeout||1e4}async fetch(e){return this.fallbackQuery("fetch",[e])}get currentProvider(){if(this.providers.length&&!(this.currentProviderIdx>=this.providers.length))return this.providers[this.currentProviderIdx]}async find(e){return this.fallbackQuery("find",[e])}async findBy(e,t){return this.fallbackQuery("findBy",[e,t])}async fallbackQuery(e,t){if(this.currentProviderIdx>=this.providers.length)throw new Error("No working providers found");let n;try{const a=this.providers[this.currentProviderIdx];n=await Promise.race([a[e].apply(a,t),new Promise(((e,t)=>setTimeout((()=>t(new Error("timeout"))),this.timeout)))])}catch(a){const s=a.message;"timeout"===s?console.error("Provider "+this.currentProviderIdx+" timed out, falling back to next provider"):console.error("Provider "+this.currentProviderIdx+" failed with error: ",s,", falling back to next provider"),this.currentProviderIdx++,n=await this.fallbackQuery.call(this,e,t)}return n}}class ni{constructor(e){this.pools=e}async find(e){return this.pools.find((t=>t.id.toLowerCase()===e.toLowerCase()))}async findBy(e,t){return this.pools.find((n=>n[e]===t))}async all(){return this.pools}async where(e){return(await this.all()).filter(e)}}class ai{constructor(e){var t,n;this.skip=0,this.client=Ia(e.url),this.blockHeight=e.blockHeight,this.chainId=e.chainId;const a={orderBy:hn.TotalLiquidity,orderDirection:ln.Desc,where:{swapEnabled:{eq:!0},totalShares:{gt:0}}},s=(null===(t=e.query)||void 0===t?void 0:t.args)||a,i=(null===(n=e.query)||void 0===n?void 0:n.attrs)||{};this.query={args:s,attrs:i}}async fetchDefault(){const{pool0:e,pool1000:t,pool2000:n}=await this.client.AllPools({where:{swapEnabled:!0,totalShares_gt:"0"},orderBy:hn.TotalLiquidity,orderDirection:ln.Desc,block:this.blockHeight?{number:await this.blockHeight()}:void 0});return[...e,...t,...n].map(this.mapType.bind(this))}async fetch(e){(null==e?void 0:e.skip)&&(this.query.args.skip=e.skip),this.blockHeight&&(this.query.args.block={number:await this.blockHeight()}),this.query.args.first=(null==e?void 0:e.first)||1e3;const t=new xe(this.query.args).format(new Ae),{pools:n}=await this.client.Pools(t);return this.skip=((null==e?void 0:e.skip)||0)+n.length,n.map(this.mapType.bind(this))}async find(e){return await this.findBy("id",e)}async findBy(e,t){return this.pools||(this.pools=this.fetchDefault()),(await this.pools).find((n=>n[e]==t))}async all(){return this.pools||(this.pools=this.fetchDefault()),this.pools}async where(e){return this.pools||(this.pools=this.fetchDefault()),(await this.pools).filter(e)}mapType(e){var t,n,a,s,i;return{id:e.id,name:e.name||"",address:e.address,chainId:this.chainId,poolType:e.poolType,swapFee:e.swapFee,swapEnabled:e.swapEnabled,amp:null!==(t=e.amp)&&void 0!==t?t:void 0,owner:null!==(n=e.owner)&&void 0!==n?n:void 0,factory:null!==(a=e.factory)&&void 0!==a?a:void 0,tokens:(e.tokens||[]).map(this.mapToken),tokensList:e.tokensList,tokenAddresses:(e.tokens||[]).map((e=>e.address)),totalLiquidity:e.totalLiquidity,totalShares:e.totalShares,totalSwapFee:e.totalSwapFee,totalSwapVolume:e.totalSwapVolume,createTime:e.createTime,mainIndex:null!==(s=e.mainIndex)&&void 0!==s?s:void 0,wrappedIndex:null!==(i=e.wrappedIndex)&&void 0!==i?i:void 0,totalWeight:e.totalWeight||"1"}}mapToken(e){var t;let n=null;return(null===(t=e.token)||void 0===t?void 0:t.pool)&&(n={...e.token.pool,poolType:e.token.pool.poolType}),{...e,token:{pool:n}}}}class si{constructor(e){this.tokens=e}async find(e){return this.tokens.find((t=>t.address.toLowerCase()===e.toLowerCase()))}async findBy(e,t){return this.tokens.find((n=>n[e]===t))}}class ii{constructor(e){this.tokenPrices=e,this.calculateUSDPrices()}calculateUSDPrices(){let e=0,t=o.from(0);if(["0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48","0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48","0x6b175474e89094c44da98b954eedeac495271d0f","0x6B175474E89094C44Da98b954EedeAC495271d0F","0xdac17f958d2ee523a2206206994597c13d831ec7","0xdAC17F958D2ee523a2206206994597C13D831ec7"].forEach((n=>{const a=this.tokenPrices[n];if(null==a?void 0:a.eth){const n=He(null==a?void 0:a.eth,18);t=t.add(n),e++}})),0===e)return;const n=t.div(e);for(const e in this.tokenPrices){const t=this.tokenPrices[e];if(t.eth&&!t.usd){const e=He("1",18).mul(He(t.eth,18)).div(n).toString();t.usd=p(e,18)}}}async find(e){const t=this.tokenPrices[e];if(t)return t}async findBy(e,t){if("address"==e)return this.find(t)}}const ri={waUSDT:"0xf8fd466f12e236f4c96f7cce6c79eadb819abf58",waUSDC:"0xd093fa4fb80d09bb30817fdcd442d4d02ed3e5de",waDAI:"0x02d60b84491589974263d922d9cc7a3152618ef6"},oi={[ri.waUSDT]:{aToken:"0x3ed3b47dd13ec9a98b44e6204a523e766b225811",underlying:"0xdac17f958d2ee523a2206206994597c13d831ec7"},[ri.waUSDC]:{aToken:"0xbcca60bb61934080951369a648fb03df4f96263c",underlying:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48"},[ri.waDAI]:{aToken:"0x028171bca77440897b824ca71d1c56cac55b68a3",underlying:"0x6b175474e89094c44da98b954eedeac495271d0f"}},di=Object.values(oi).map((e=>e.aToken)),pi=Object.values(oi).map((e=>e.underlying)),ui=Object.fromEntries(Object.keys(oi).map((e=>[oi[e].underlying,e]))),li=async()=>{try{const e={operationName:"getReserves",query:"\n  query getReserves($aTokens: [String!], $underlyingAssets: [Bytes!]) {\n    reserves(\n      where: {\n        aToken_in: $aTokens\n        underlyingAsset_in: $underlyingAssets\n        isActive: true\n      }\n    ) {\n      underlyingAsset\n      liquidityRate\n    }\n  }\n",variables:{aTokens:di,underlyingAssets:pi}},t=await W.post("https://api.thegraph.com/subgraphs/name/aave/protocol-v2",e),{data:{reserves:n}}=t.data,a=n.map((e=>[ui[e.underlyingAsset],Math.round(1e4*parseFloat(Us(o.from(e.liquidityRate),27)))]));return Object.fromEntries(a)}catch(e){return Object.fromEntries(Object.keys(oi).map((e=>[e,0])))}};class ci{constructor(e,t=1){this.prices={},this.requestedAddresses=new Set,this.debounceWait=200,this.promisedCalls=[],this.promisedCount=0,this.debounceCancel=()=>{},this.baseTokenAddresses=e.map((e=>e.toLowerCase())).map((e=>yi(e))),this.urlBase=`https://api.coingecko.com/api/v3/simple/token_price/${this.platform(t)}?vs_currencies=usd,eth`}fetch(e,{signal:t}={}){return e.length,W.get(this.url(e),{signal:t}).then((({data:e})=>e)).finally((()=>{e.length}))}debouncedFetch(){this.promisedCalls[this.promisedCount]||(this.promisedCalls[this.promisedCount]=(()=>{let e=()=>{},t=()=>{};return{promise:new Promise(((n,a)=>{[e,t]=[n,a]})),reject:t,resolve:e}})());const{promise:e,resolve:t,reject:n}=this.promisedCalls[this.promisedCount];return this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.promisedCount++,this.fetch([...this.requestedAddresses]).then((e=>{t(e),this.debounceCancel=()=>{}})).catch((e=>{console.error(e)}))}),this.debounceWait),this.debounceCancel=()=>{this.timeout&&clearTimeout(this.timeout),n("Cancelled"),delete this.promisedCalls[this.promisedCount]},e}async find(e){const t=e.toLowerCase(),n=yi(t);if(!this.prices[n])try{let e=!1;0===Object.keys(this.prices).length&&(this.baseTokenAddresses.forEach(this.requestedAddresses.add.bind(this.requestedAddresses)),e=!0),this.requestedAddresses.add(n);const t=await this.debouncedFetch();this.prices[n]=t[n],this.requestedAddresses.delete(n),e&&this.baseTokenAddresses.forEach((e=>{this.prices[e]=t[e],this.requestedAddresses.delete(e)}))}catch(e){console.error(e)}return this.prices[n]}async findBy(e,t){if("address"==e)return this.find(t)}platform(e){switch(e){case 1:case 42:case 31337:return"ethereum";case 137:return"polygon-pos";case 42161:return"arbitrum-one"}return"2"}url(e){return`${this.urlBase}&contract_addresses=${e.join(",")}`}}const yi=e=>{const t=e.toLocaleLowerCase();return Object.keys(oi).includes(t)?oi[t].aToken:t},mi=new t(["function getTokensDistributedInWeek(address token, uint timestamp) view returns (uint)"]),bi=new t(["function totalSupply() view returns (uint)"]),hi=new t(["function getRate() view returns (uint)"]);class fi{constructor(e,t,n,a,s,i){this.feeDistributorAddress=t,this.balAddress=n,this.veBalAddress=a,this.bbAUsdAddress=s,this.multicall=Ea(e,i)}async fetch(e){const t=this.getPreviousWeek(e),n=[[this.feeDistributorAddress,mi.encodeFunctionData("getTokensDistributedInWeek",[u(this.balAddress),t])],[this.feeDistributorAddress,mi.encodeFunctionData("getTokensDistributedInWeek",[u(this.bbAUsdAddress),t])],[this.veBalAddress,bi.encodeFunctionData("totalSupply",[])],[this.bbAUsdAddress,hi.encodeFunctionData("getRate",[])]],[,a]=await this.multicall.aggregate(n);return{balAmount:parseFloat(Us(a[0],18)),bbAUsdAmount:parseFloat(Us(a[1],18)),veBalSupply:parseFloat(Us(a[2],18)),bbAUsdPrice:parseFloat(Us(a[3],18)),balAddress:this.balAddress}}async multicallData(e){return this.data||(this.data=await this.fetch(e)),this.data}getPreviousWeek(e){const t=new Date(e);t.setUTCHours(0),t.setUTCMinutes(0),t.setUTCSeconds(0),t.setUTCMilliseconds(0);let n=t.getUTCDay()-4;return n<0&&(n+=7),n+=7,Math.floor(t.getTime()/1e3)-86400*n}}const Ti=new t(["function getProtocolFeesCollector() view returns (address)"]),Ii=new t(["function getSwapFeePercentage() view returns (uint)"]);let gi;class wi{constructor(e,t){this.provider=t,this.vault=new b(e,Ti,this.provider)}async fetch(){const e=await this.vault.getProtocolFeesCollector(),t=new b(e,Ii,this.provider),n=await t.getSwapFeePercentage();return parseFloat(Us(n,18))}async find(){return gi||(gi=this.fetch()),this.swapFeePercentage=await gi,this.swapFeePercentage}async findBy(){return this.find()}}const Ei=new t(["function getSwapFeePercentage() view returns (uint)"]);let Si;class _i{constructor(e,t,n){this.protocolFeePercentagesProviderAddress=t,this.multicall=Ea(e,n)}async fetch(){const e=[[this.protocolFeePercentagesProviderAddress,Ei.encodeFunctionData("getFeeTypePercentage",[0])],[this.protocolFeePercentagesProviderAddress,Ei.encodeFunctionData("getFeeTypePercentage",[2])]],[,t]=await this.multicall.aggregate(e);return{swapFee:parseFloat(Us(t[0],18)),yieldFee:parseFloat(Us(t[2],18))}}async getFees(){return Si||(Si=this.fetch()),this.protocolFees=await Si,this.protocolFees}}const Oi={stETH:"0x7f39c581f595b53c5cb19bd0b3f8da6c935e2ca0"},Ai=async()=>{let e=0;try{const t=await W.get("https://stake.lido.fi/api/apr"),{data:n}=t.data;e=Math.round(100*parseFloat(n.steth))}catch(e){console.error("Failed to fetch stETH APR:",e)}return{[Oi.stETH]:e}},xi={usdcUSDplus:"0x1aafc31091d93c3ff003cff5d2d8f7ba2e728425",usdcUSDplus2:"0x6933ec1ca55c06a894107860c92acdfd2dd8512f"},Pi=async()=>{let e=0;try{const{data:t}=await W.get("https://app.overnight.fi/api/balancer/week/apr");e=Math.round(1e4*parseFloat(t)/100)}catch(e){console.error("Failed to fetch USD+ APR:",e)}return Object.fromEntries(Object.values(xi).map((t=>[t,e])))},Ni=Object.fromEntries([...Object.values(Oi).map((e=>[e,Ai])),...Object.values(ri).map((e=>[e,li])),...Object.values(xi).map((e=>[e,Pi]))]);class ki{constructor(e=Ni){this.sources=e,this.yields={}}async fetch(e){const t=await this.sources[e]();this.yields={...this.yields,...t}}async find(e){const t=e.toLocaleLowerCase();return Object.keys(this.sources).includes(t)&&!Object.keys(this.yields).includes(t)&&await this.fetch(e),this.yields[t]}async findBy(e,t){if("address"==e)return this.find(t)}}const vi=e=>`{\n  blocks(first: 1, orderBy: timestamp, orderDirection: asc, where: { timestamp_gt: ${e} }) {\n    number\n  }\n}`,Bi=async(e,t)=>{const n={query:vi(t)},a=await W.post(e,n),{data:{blocks:s}}=a.data;return parseInt(s[0].number)};class Ri{constructor(e){this.endpoint=e,this.blocks={}}async find(e){if("dayAgo"==e){const e=""+(Math.floor(Date.now()/1e3)-86400);return this.blocks[e]||(this.blocks={...this.blocks,[e]:Bi(this.endpoint,e)}),this.blocks[e]}}async findBy(e="",t=""){}}var Di=[{chainId:1,address:"0x8888801af4d980682e47f1a9036e589479e835c5",symbol:"mph"},{chainId:1,address:"0x27054b13b1b798b345b591a4d22e6562d47ea75a",symbol:"ast"},{chainId:1,address:"0x3301ee63fb29f863f2333bd4466acb46cd8323e6",symbol:"akita"},{chainId:1,address:"0x616e8bfa43f920657b3497dbf40d6b1a02d4608d",symbol:"aurabal"},{chainId:1,address:"0xc0c293ce456ff0ed870add98a0828dd4d2903dbf",symbol:"aura"},{chainId:1,address:"0x3472a5a71965499acd81997a54bba8d852c6e53d",symbol:"badger"},{chainId:1,address:"0xba100000625a3754423978a60c9317c58a424e3d",symbol:"bal"},{chainId:1,address:"0x804cdb9116a10bb78768d3252355a1b18067bf8f",symbol:"bb-a-dai"},{chainId:1,address:"0x9210f1204b5a24742eba12f710636d76240df3d0",symbol:"bb-a-usdc"},{chainId:1,address:"0x2bbf681cc4eb09218bee85ea2a5d3d13fa40fc0c",symbol:"bb-a-usdt"},{chainId:1,address:"0x7b50775383d3d6f0215a8f290f2c9e2eebbeceb2",symbol:"bb-a-usd"},{chainId:1,address:"0x2d94aa3e47d9d5024503ca8491fce9a2fb4da198",symbol:"bank"},{chainId:1,address:"0x0d8775f648430679a709e98d2b0cb6250d2887ef",symbol:"bat"},{chainId:1,address:"0xf17e65822b568b3903685a7c9f496cf7656cc6c2",symbol:"bico"},{chainId:1,address:"0x799ebfabe77a6e34311eeee9825190b9ece32824",symbol:"btrst"},{chainId:1,address:"0x514910771af9ca656af840dff83e8264ecf986ca",symbol:"link"},{chainId:1,address:"0x3506424f91fd33084466f402d5d97f05f8e3b4af",symbol:"chz"},{chainId:1,address:"0x41e5560054824ea6b0732e656e3ad64e20e94e45",symbol:"cvc"},{chainId:1,address:"0xc00e94cb662c3520282e6f5717214004a7f26888",symbol:"comp"},{chainId:1,address:"0xdef1ca1fb7fbcdc777520aa7f396b4e015f497ab",symbol:"cow"},{chainId:1,address:"0xd533a949740bb3306d119cc777fa900ba034cd52",symbol:"crv"},{chainId:1,address:"0x6b175474e89094c44da98b954eedeac495271d0f",symbol:"dai"},{chainId:1,address:"0xf2051511b9b121394fa75b8f7d4e7424337af687",symbol:"haus"},{chainId:1,address:"0x888888435fde8e7d4c54cab67f206e4199454c60",symbol:"dfx"},{chainId:1,address:"0x798d1be841a82a273720ce31c822c61a67a601c3",symbol:"digg"},{chainId:1,address:"0xf629cbd94d3791c9250152bd8dfbdf380e2a3b9c",symbol:"enj"},{chainId:1,address:"0xc18360217d8f7ab5e7c516566761ea12ce7f9d72",symbol:"ens"},{chainId:1,address:"0x4e15361fd6b4bb609fa63c81a2be19d873717870",symbol:"ftm"},{chainId:1,address:"0x956f47f50a910163d8bf957cf5846d573e7f87ca",symbol:"fei"},{chainId:1,address:"0xed1480d12be41d92f36f5f7bdd88212e381a3677",symbol:"fdt"},{chainId:1,address:"0x586aa273f262909eef8fa02d90ab65f5015e0516",symbol:"fiat"},{chainId:1,address:"0xde30da39c46104798bb5aa3fe8b9e0e1f348163f",symbol:"gtc"},{chainId:1,address:"0x900db999074d9277c5da2a43f252d74366230da0",symbol:"giv"},{chainId:1,address:"0x6810e776880c02933d47db1b9fc05908e5386b96",symbol:"gno"},{chainId:1,address:"0xba485b556399123261a5f9c95d413b4f93107407",symbol:"graviaura"},{chainId:1,address:"0x3ec8798b81485a254928b70cda1cf0a2bb0b74d7",symbol:"gro"},{chainId:1,address:"0xc011a73ee8576fb46f5e1c5751ca3b9fe0af2a6f",symbol:"snx"},{chainId:1,address:"0x5a98fcbea516cf06857215779fd812ca3bef1b32",symbol:"ldo"},{chainId:1,address:"0x6dea81c8171d0ba574754ef6f8b412f2ed88c54d",symbol:"lqty"},{chainId:1,address:"0x5f98805a4e8be255a32880fdec7f6728c6568ba0",symbol:"lusd"},{chainId:1,address:"0x965d79f1a1016b574a62986e13ca8ab04dfdd15c",symbol:"m2"},{chainId:1,address:"0x9f8f72aa9304c8b593d555f12ef6589cc3a579a2",symbol:"mkr"},{chainId:1,address:"0xd084944d3c05cd115c09d072b9f44ba3e0e45921",symbol:"fold"},{chainId:1,address:"0x7d1afa7b718fb893db30a3abc0cfc608aacfebb0",symbol:"matic"},{chainId:1,address:"0xa3bed4e1c75d00fa6f4e5e6922db7261b5e9acd2",symbol:"mta"},{chainId:1,address:"0x4b13006980acb09645131b91d259eaa111eaf5ba",symbol:"myc"},{chainId:1,address:"0x333a4823466879eef910a04d473505da62142069",symbol:"nation"},{chainId:1,address:"0xcfeaead4947f0705a14ec42ac3d44129e1ef3ed5",symbol:"note"},{chainId:1,address:"0x967da4048cd07ab37855c090aaf366e4ce1b9f48",symbol:"ocean"},{chainId:1,address:"0x64aa3364f17a4d01c6f1751fd97c2bd3d7e7f1d5",symbol:"ohm"},{chainId:1,address:"0xab846fb6c81370327e784ae7cbb6d6a6af6ff4bf",symbol:"pal"},{chainId:1,address:"0xcafe001067cdef266afb7eb5a286dcfd277f3de5",symbol:"psp"},{chainId:1,address:"0x68037790a0229e9ce6eaa8a99ea92964106c4703",symbol:"par"},{chainId:1,address:"0x45804880de22913dafe09f4980848ece6ecbaf78",symbol:"paxg"},{chainId:1,address:"0x89ab32156e46f46d02ade3fecbe5fc4243b9aaed",symbol:"pnt"},{chainId:1,address:"0x9992ec3cf6a55b00978cddf2b27bc6882d88d1ec",symbol:"poly"},{chainId:1,address:"0x43d4a3cd90ddd2f8f4f693170c9c8098163502ad",symbol:"d2d"},{chainId:1,address:"0xeb4c2781e4eba804ce9a9803c67d0893436bb27d",symbol:"renbtc"},{chainId:1,address:"0x408e41876cccdc0f92210600ef50372656052a38",symbol:"ren"},{chainId:1,address:"0xfb5453340c03db5ade474b27e68b6a9c6b2823eb",symbol:"robot"},{chainId:1,address:"0xd33526068d116ce69f19a9ee46f0bd304f21a51f",symbol:"rpl"},{chainId:1,address:"0xae78736cd615f374d3085123a210448e74fc6393",symbol:"reth"},{chainId:1,address:"0xfe18be6b3bd88a2d2a7f928d00292e7a9963cfc6",symbol:"sbtc"},{chainId:1,address:"0x476c5e26a75bd202a9683ffd34359c0cc15be0ff",symbol:"srm"},{chainId:1,address:"0x35e78b3982e87ecfd5b3f3265b601c046cdbe232",symbol:"xai"},{chainId:1,address:"0x3affcca64c2a6f4e3b6bd9c64cd2c969efd1ecbe",symbol:"dsla"},{chainId:1,address:"0xf24d8651578a55b0c119b9910759a351a3458895",symbol:"sdbal"},{chainId:1,address:"0x11c1a6b3ed6bb362954b29d3183cfa97a0c806aa",symbol:"str"},{chainId:1,address:"0x8f693ca8d21b157107184d29d398a8d082b38b76",symbol:"data"},{chainId:1,address:"0x470ebf5f030ed85fc1ed4c2d36b9dd02e77cf1b7",symbol:"temple"},{chainId:1,address:"0xa36fdbbae3c9d55a1d67ee5821d53b50b63a1ab9",symbol:"temp"},{chainId:1,address:"0xdac17f958d2ee523a2206206994597c13d831ec7",symbol:"usdt"},{chainId:1,address:"0x9c4a4204b79dd291d6b6571c5be8bbcd0622f050",symbol:"tcr"},{chainId:1,address:"0x226f7b842e0f0120b7e194d05432b3fd14773a9d",symbol:"unn"},{chainId:1,address:"0x1f9840a85d5af5bf1d1762f925bdaddc4201f984",symbol:"uni"},{chainId:1,address:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",symbol:"usdc"},{chainId:1,address:"0x81f8f0bb1cb2a06649e51913a151f0e7ef6fa321",symbol:"vita"},{chainId:1,address:"0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",symbol:"weth"},{chainId:1,address:"0xedb171c18ce90b633db442f2a6f72874093b49ef",symbol:"wampl"},{chainId:1,address:"0x2260fac5e5542a773aa44fbcfedf7c193bc2c599",symbol:"wbtc"},{chainId:1,address:"0xf203ca1769ca8e9e8fe1da9d147db68b6c919817",symbol:"wncg"},{chainId:1,address:"0x7f39c581f595b53c5cb19bd0b3f8da6c935e2ca0",symbol:"wsteth"},{chainId:1,address:"0x79c71d3436f39ce382d0f58f1b011d88100b9d91",symbol:"xns"},{chainId:1,address:"0x0bc529c00c6401aef6d220be8c6ea1667f6ad93e",symbol:"yfi"},{chainId:1,address:"0xbcca60bb61934080951369a648fb03df4f96263c",symbol:"ausdc"},{chainId:1,address:"0x028171bca77440897b824ca71d1c56cac55b68a3",symbol:"adai"},{chainId:1,address:"0x3ed3b47dd13ec9a98b44e6204a523e766b225811",symbol:"ausdt"},{chainId:137,address:"0x9c2c5fd7b07e95ee044ddeba0e97a665f142394f",symbol:"1inch"},{chainId:137,address:"0xd6df932a45c0f255f85145f286ea0b292b21c90b",symbol:"aave"},{chainId:137,address:"0xc3fdbadc7c795ef1d6ba111e06ff8f16a20ea539",symbol:"addy"},{chainId:137,address:"0xf84bd51eab957c2e7b7d646a3427c5a50848281d",symbol:"agar"},{chainId:137,address:"0x033d942a6b495c4071083f4cde1f17e986fe856c",symbol:"aga"},{chainId:137,address:"0x0e9b89007eee9c958c0eda24ef70723c2c93dd58",symbol:"amaticc"},{chainId:137,address:"0x034b2090b579228482520c589dbd397c53fc51cc",symbol:"vision"},{chainId:137,address:"0x2c89bbc92bd86f8075d1decc58c7f4e0107f286b",symbol:"avax"},{chainId:137,address:"0x49690541e3f6e933a9aa3cffee6010a7bb5b72d7",symbol:"axiav3"},{chainId:137,address:"0x9a71012b13ca4d3d0cdc72a177df3ef03b0e76a3",symbol:"bal"},{chainId:137,address:"0xdb7cb471dd0b49b29cab4a1c14d070f27216a0ab",symbol:"bank"},{chainId:137,address:"0xfbdd194376de19a88118e84e279b977f165d01b8",symbol:"bifi"},{chainId:137,address:"0xd6ca869a4ec9ed2c7e618062cdc45306d8dbbc14",symbol:"btc2x-fli-p"},{chainId:137,address:"0x53e0bca35ec356bd5dddfebbd1fc0fd03fabad39",symbol:"link"},{chainId:137,address:"0x172370d5cd63279efa6d502dab29171933a610af",symbol:"crv"},{chainId:137,address:"0x8f3cf7ad23cd3cadbd9735aff958023239c6a063",symbol:"dai"},{chainId:137,address:"0x1d607faa0a51518a7728580c238d912747e71f7a",symbol:"data"},{chainId:137,address:"0x85955046df4668e1dd369d2de9f3aeb98dd2a369",symbol:"dpi"},{chainId:137,address:"0xe7804d91dfcde7f776c90043e03eaa6df87e6395",symbol:"dfx"},{chainId:137,address:"0xf28164a485b0b2c90639e47b0f377b4a438a16b1",symbol:"dquick"},{chainId:137,address:"0x45c32fa6df82ead1e2ef74d17b76547eddfaff89",symbol:"frax"},{chainId:137,address:"0x50b728d8d964fd00c2d0aad81718b71311fef68a",symbol:"snx"},{chainId:137,address:"0x72928d5436ff65e57f72d5566dcd3baedc649a88",symbol:"hdao"},{chainId:137,address:"0x3ad707da309f3845cd602059901e39c4dcd66473",symbol:"eth2x-fli-p"},{chainId:137,address:"0x4f025829c4b13df652f38abd2ab901185ff1e609",symbol:"ieth-fli-p"},{chainId:137,address:"0x340f412860da7b7823df372a2b59ff78b7ae6abc",symbol:"imatic-fli-p"},{chainId:137,address:"0xf287d97b6345bad3d88856b26fb7c0ab3f2c7976",symbol:"matic2x-fli-p"},{chainId:137,address:"0x130ce4e4f76c2265f94a961d70618562de0bb8d2",symbol:"ibtc-fli-p"},{chainId:137,address:"0x596ebe76e2db4470966ea395b0d063ac6197a8c5",symbol:"jrt"},{chainId:137,address:"0x3a58a54c066fdc0f2d55fc9c89f0415c92ebf3c4",symbol:"stmatic"},{chainId:137,address:"0xf501dd45a1198c2e1b5aef5314a68b9006d842e0",symbol:"mta"},{chainId:137,address:"0xeaecc18198a475c921b24b8a6c1c1f0f5f3f7ea0",symbol:"seed"},{chainId:137,address:"0xfe712251173a2cd5f5be2b46bb528328ea3565e1",symbol:"mvi"},{chainId:137,address:"0xa3fa99a148fa48d14ed51d610c367c61876997f1",symbol:"mimatic"},{chainId:137,address:"0xa486c6bc102f409180ccb8a94ba045d39f8fc7cb",symbol:"nex"},{chainId:137,address:"0xe2aa7db6da1dae97c5f5c6914d285fbfcc32a128",symbol:"par"},{chainId:137,address:"0x580a84c73811e1839f75d86d75d88cca0c241ff4",symbol:"qi"},{chainId:137,address:"0x831753dd7087cac61ab5644b308642cc1c33dc13",symbol:"quick"},{chainId:137,address:"0xb5c064f955d8e7f38fe0460c556a72987494ee17",symbol:"quick"},{chainId:137,address:"0x00e5646f60ac6fb446f621d146b6e1886f002905",symbol:"rai"},{chainId:137,address:"0x431cd3c9ac9fc73644bf68bf5691f4b83f9e104f",symbol:"rbw"},{chainId:137,address:"0xdbf31df14b66535af65aac99c32e9ea844e14501",symbol:"renbtc"},{chainId:137,address:"0x501ace9c35e60f03a2af4d484f49f9b1efde9f40",symbol:"solace"},{chainId:137,address:"0xfa68fb4628dff1028cfec22b4162fccd0d45efb6",symbol:"maticx"},{chainId:137,address:"0x0b3f868e0be5597d5db7feb59e1cadbb0fdda50a",symbol:"sushi"},{chainId:137,address:"0xdf7837de1f2fa4631d716cf2502f8b230f1dcc32",symbol:"tel"},{chainId:137,address:"0xe6469ba6d2fd6130788e0ea9c0a0515900563b59",symbol:"ust"},{chainId:137,address:"0xc2132d05d31c914a87c6611c10748aeb04b58e8f",symbol:"usdt"},{chainId:137,address:"0x5fe2b58c013d7601147dcdd68c143a77499f5531",symbol:"grt"},{chainId:137,address:"0xbbba073c31bf03b8acf7c28ef0738decf3695683",symbol:"sand"},{chainId:137,address:"0x2934b36ca9a4b31e633c5be670c8c8b28b6aa015",symbol:"thx"},{chainId:137,address:"0x2f800db0fdb5223b3c3f354886d907a671414a7f",symbol:"bct"},{chainId:137,address:"0x2e1ad108ff1d8c782fcbbb89aad783ac49586756",symbol:"tusd"},{chainId:137,address:"0x3809dcdd5dde24b37abe64a5a339784c3323c44f",symbol:"swap"},{chainId:137,address:"0x7fbc10850cae055b27039af31bd258430e714c62",symbol:"ubt"},{chainId:137,address:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",symbol:"usdc"},{chainId:137,address:"0x7ceb23fd6bc0add59e62ac25578270cff1b9f619",symbol:"weth"},{chainId:137,address:"0x0d500b1d8e8ef31e21c99d1db9a6444d3adf1270",symbol:"wmatic"},{chainId:137,address:"0x1bfd67037b42cf73acf2047067bd4f2c47d9bfd6",symbol:"wbtc"},{chainId:137,address:"0x24834bbec7e39ef42f4a75eaf8e5b6486d3f0e57",symbol:"lunc"},{chainId:137,address:"0xf153eff70dc0bf3b085134928daeea248d9b30d0",symbol:"xmark"},{chainId:42161,address:"0x9f20de1fc9b161b34089cbeae888168b44b03461",symbol:"arbis"},{chainId:42161,address:"0x040d1edc9569d4bab2d15287dc5a4f10f56a56b8",symbol:"bal"},{chainId:42161,address:"0x031d35296154279dc1984dcd93e392b1f946737b",symbol:"cap"},{chainId:42161,address:"0xf97f4df75117a78c1a5a0dbb814af92458539fb4",symbol:"link"},{chainId:42161,address:"0x354a6da3fcde098f8389cad84b0182725c6c91de",symbol:"comp"},{chainId:42161,address:"0xf4d48ce3ee1ac3651998971541badbb9a14d7234",symbol:"cream"},{chainId:42161,address:"0x11cdb42b0eb46d95f990bedd4695a6e3fa034978",symbol:"crv"},{chainId:42161,address:"0xda10009cbd5d07dd0cecc66161fc93d7c9000da1",symbol:"dai"},{chainId:42161,address:"0x8038f3c971414fd1fc220ba727f2d4a0fc98cb65",symbol:"dht"},{chainId:42161,address:"0xf0b5ceefc89684889e5f7e0a7775bd100fcd3709",symbol:"dusd"},{chainId:42161,address:"0x6c2c06790b3e3e3c38e12ee22f8183b37a13ee55",symbol:"dpx"},{chainId:42161,address:"0x32eb7902d4134bf98a28b963d26de779af92a212",symbol:"rdpx"},{chainId:42161,address:"0xc3ae0333f0f34aa734d5493276223d95b8f9cb37",symbol:"dxd"},{chainId:42161,address:"0xfc5a1a6eb076a2c7ad06ed22c90d7e710e35ad0a",symbol:"gmx"},{chainId:42161,address:"0xa0b862f60edef4452f25b4160f177db44deb6cf1",symbol:"gno"},{chainId:42161,address:"0xb965029343d55189c25a7f3e0c9394dc0f5d41b1",symbol:"ndx"},{chainId:42161,address:"0x539bde0d7dbd336b79148aa742883198bbf60342",symbol:"magic"},{chainId:42161,address:"0x4e352cf164e64adcbad318c3a1e222e9eba4ce42",symbol:"mcb"},{chainId:42161,address:"0x3f56e0c36d275367b8c502090edf38289b3dea0d",symbol:"mimatic"},{chainId:42161,address:"0x965772e0e9c84b6f359c8597c891108dcf1c5b1a",symbol:"pickle"},{chainId:42161,address:"0x6694340fc020c5e6b96567843da2df01b2ce1eb6",symbol:"stg"},{chainId:42161,address:"0xd4d42f0b6def4ce0383636770ef773390d85c61a",symbol:"sushi"},{chainId:42161,address:"0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9",symbol:"usdt"},{chainId:42161,address:"0x23a941036ae778ac51ab04cea08ed6e2fe103614",symbol:"grt"},{chainId:42161,address:"0xa72159fc390f0e3c6d415e658264c7c4051e9b87",symbol:"tcr"},{chainId:42161,address:"0x4d15a3a2286d883af0aa1b3f21367843fac63e07",symbol:"tusd"},{chainId:42161,address:"0xfa7f8980b0f1e64a2062791cc3b0871572f1f7f0",symbol:"uni"},{chainId:42161,address:"0xff970a61a04b1ca14834a43f5de4533ebddb5cc8",symbol:"usdc"},{chainId:42161,address:"0xa684cd057951541187f288294a1e1c2646aa2d24",symbol:"vsta"},{chainId:42161,address:"0x64343594ab9b56e99087bfa6f2335db24c2d1f17",symbol:"vst"},{chainId:42161,address:"0x82af49447d8a07e3bd95bd0d56f35241523fbab1",symbol:"weth"},{chainId:42161,address:"0x2f2a2543b76a4166549f7aab2e75bef0aefc5b0f",symbol:"wbtc"},{chainId:42161,address:"0x82e3a8f066a6989666b031d916c43672085b1582",symbol:"yfi"}];class Ci{constructor(e,t){if(this.pools=new ai({url:e.urls.subgraph,chainId:e.chainId}),e.urls.blockNumberSubgraph){this.blockNumbers=new Ri(e.urls.blockNumberSubgraph);const t=async()=>{if(this.blockNumbers)return await this.blockNumbers.find("dayAgo")};this.yesterdaysPools=new ai({url:e.urls.subgraph,chainId:e.chainId,blockHeight:t})}const n=Di.filter((t=>t.chainId==e.chainId)).map((e=>e.address));this.tokenPrices=new ci(n,e.chainId),this.tokenMeta=new si([]),e.urls.gaugesSubgraph&&(this.liquidityGauges=new zs(e.urls.gaugesSubgraph,e.addresses.contracts.multicall,e.addresses.contracts.gaugeController||"",e.chainId,t)),e.addresses.contracts.feeDistributor&&e.addresses.tokens.bal&&e.addresses.tokens.veBal&&e.addresses.tokens.bbaUsd&&(this.feeDistributor=new fi(e.addresses.contracts.multicall,e.addresses.contracts.feeDistributor,e.addresses.tokens.bal,e.addresses.tokens.veBal,e.addresses.tokens.bbaUsd,t)),this.feeCollector=new wi(e.addresses.contracts.vault,t),e.addresses.contracts.protocolFeePercentagesProvider&&(this.protocolFees=new _i(e.addresses.contracts.multicall,e.addresses.contracts.protocolFeePercentagesProvider,t)),this.tokenYields=new ki}}class Mi{constructor(e,t=new Da(e),n=new Qa(e)){this.config=e,this.sor=t,this.subgraph=n,this.networkConfig=Ra(e),this.data=new Ci(this.networkConfig,t.provider),this.swaps=new Za(this.config),this.relayer=new za(this.swaps),this.pricing=new es(e,this.swaps),this.pools=new Ks(this.networkConfig,this.data),this.balancerContracts=new ns(this.networkConfig.addresses.contracts,t.provider),this.zaps=new As(this.networkConfig.chainId)}get rpcProvider(){return this.sor.provider}get contracts(){return this.balancerContracts.contracts}}export{we as AaveHelpers,Ie as AssetHelpers,Oe as BalancerAPIArgsFormatter,Ge as BalancerError,$e as BalancerErrorCode,ce as BalancerErrors,he as BalancerMinterAuthorization,Mi as BalancerSDK,Ri as BlockNumberRepository,ci as CoingeckoPriceRepository,ae as ComposableStablePoolEncoder,ne as ComposableStablePoolExitKind,te as ComposableStablePoolJoinKind,Ci as Data,wi as FeeCollectorRepository,fi as FeeDistributorRepository,Xs as GaugeControllerMulticallRepository,xe as GraphQLArgsBuilder,Mt as Liquidity,zs as LiquidityGaugeSubgraphRPCProvider,Js as LiquidityGaugesMulticallRepository,Ys as LiquidityGaugesSubgraphRepository,z as ManagedPoolEncoder,Pe as Network,ve as PoolBalanceOpKind,Ne as PoolSpecialization,Be as PoolType,Ks as Pools,ei as PoolsBalancerAPIRepository,ti as PoolsFallbackRepository,ni as PoolsStaticRepository,ai as PoolsSubgraphRepository,_i as ProtocolFeesProvider,za as Relayer,me as RelayerAction,be as RelayerAuthorization,Da as Sor,K as StablePhantomPoolJoinKind,J as StablePoolEncoder,j as StablePoolExitKind,H as StablePoolJoinKind,ii as StaticTokenPriceProvider,si as StaticTokenProvider,Qa as Subgraph,Ae as SubgraphArgsFormatter,Re as SwapType,Za as Swaps,ki as TokenYieldsRepository,ke as UserBalanceOpKind,Y as WeightedPoolEncoder,Z as WeightedPoolExitKind,X as WeightedPoolJoinKind,ye as accountToAddress,$s as balEmissions,De as getLimitsForSlippage,de as getPoolAddress,ue as getPoolNonce,pe as getPoolSpecialization,ee as isNormalizedWeights,_e as isSameAddress,Ee as parsePoolInfo,fe as signPermit,oe as splitPoolId,Q as toNormalizedWeights,Se as tokensToTokenPrices};
//# sourceMappingURL=index.esm.js.map
